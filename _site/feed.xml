<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="3.8.7">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="en" /><updated>2020-08-07T20:50:02+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">harryâ€™s blog</title><subtitle>harry's technology blog 
</subtitle><author><name>harry</name><email>harry_c2016@163.com</email></author><entry><title type="html">scylladbå…³æ³¨ç‚¹</title><link href="http://localhost:4000/2020/07/27/00_scylladb.html" rel="alternate" type="text/html" title="scylladbå…³æ³¨ç‚¹" /><published>2020-07-27T00:00:00+08:00</published><updated>2020-07-27T00:00:00+08:00</updated><id>http://localhost:4000/2020/07/27/00_scylladb</id><content type="html" xml:base="http://localhost:4000/2020/07/27/00_scylladb.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çœ‹åˆ°scylladbçš„ä¸å…¶ä»–dbçš„æ¯”è¾ƒæ–‡æ¡£æ¯”è¾ƒå…¨é¢, å…¶ä¸­ä¸cassandraå¯¹æ¯”æ›´æ˜¯è¶…å‡ºä¸€æˆª, æ‰€ä»¥è¿‡æ¥çœ‹çœ‹,&lt;/p&gt;

&lt;p&gt;å…¶æ˜¯åŸºäºC++ seastar&lt;sup&gt;9,10&lt;/sup&gt;é‡å†™çš„column-base nosql, å®ç°äº†CAPä¸­çš„AP,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;masterless, hash ringæ˜¯P&lt;/li&gt;
  &lt;li&gt;replication_factorå’ŒWAL commit logæ˜¯A, å› æ­¤at least one, æ‰€ä»¥ä¸èƒ½åšåˆ°C&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88890629-79386600-d274-11ea-8143-0daf1c770a49.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;CAP theorem&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;version&quot;&gt;Version&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;scylladb, 4.1.2&lt;/li&gt;
  &lt;li&gt;scylla-monitoring, 3.4.2&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;architect&quot;&gt;Architect&lt;/h1&gt;
&lt;h2 id=&quot;read-and-write-flow&quot;&gt;read and write flow&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88525458-32a4fa80-d02d-11ea-966f-dce5263bcb5c.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;read and write flow, credit: intel&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è™šçº¿è¡¨ç¤ºread opåœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;key cache&lt;/code&gt;æ²¡æœ‰å‘½ä¸­, æ­¤æ—¶ä¼šæœç´¢partition summaryæ¥ç¡®å®špartition index, indexé€šè¿‡compression offset mapå®šä½dataåœ¨sstableçš„ä½ç½®&lt;sup&gt;15&lt;/sup&gt;&lt;/p&gt;

&lt;h2 id=&quot;partitioning&quot;&gt;partitioning&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88526954-2de14600-d02f-11ea-92a1-e0d2ef2d096b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;a hash ring to find necessary nodes&lt;sup&gt;5&lt;/sup&gt;
å½“æ‰©ç¼©å®¹nodeæ—¶, æ•´ä¸ªæ‹“æ‰‘ç»“æ„ä¼šå‘ç”Ÿå˜åŒ–, æ­¤æ—¶ä¼šè§¦å‘è‡ªåŠ¨rebalance&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ•°æ®çš„å€¾æ–œä¸å¦, å–å†³äºhash(key)çš„å‡åŒ€åº¦&lt;/p&gt;

&lt;p&gt;PRIMARY KEYæœ‰2ä¸ªä½œç”¨,&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;partition keys of the table lets you group rows on the same replica set, determines where data is stored on a given node in the cluster, æŒ‡å®šèŠ‚ç‚¹&lt;/li&gt;
  &lt;li&gt;clustering columns control how those &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rows&lt;/code&gt; are stored on the replica/node, åœ¨step1çš„æŒ‡å®šèŠ‚ç‚¹ä¸Šçš„æ•°æ®å­˜å‚¨&lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;PRIMARY KEY ((a, b), c, d) : a and b compose the partition key, and c is the clustering column.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;mapping&quot;&gt;mapping&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;scylladb&lt;/th&gt;
      &lt;th&gt;mysql&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;cluster&lt;/td&gt;
      &lt;td&gt;instance&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;keyspace&lt;/td&gt;
      &lt;td&gt;database&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;table&lt;/td&gt;
      &lt;td&gt;table&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;type&lt;/td&gt;
      &lt;td&gt;è‡ªå®šä¹‰æ•°æ®ç±»å‹&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;addon&quot;&gt;AddOn&lt;/h2&gt;
&lt;p&gt;Scylla Manager &amp;amp; Scylla Monitoring Stack
ç›‘æ§å„ä¸ªèŠ‚ç‚¹, æŸ¥çœ‹é›†ç¾¤&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88510862-73454980-d016-11ea-92e7-2dccb912ff29.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;overview, credit: scylladb&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88789201-07efa900-d1c9-11ea-9560-ef3ab4d40d69.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;overview2, port usage, credit: scylladb&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88511383-480f2a00-d017-11ea-82ff-09f58eddb44f.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ingest from batch and streaming&lt;sup&gt;2&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;install&quot;&gt;Install&lt;/h1&gt;
&lt;h2 id=&quot;scylladb&quot;&gt;scylladb&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢æ ¹æ®ç›¸å…³æ­¥éª¤, æ¥setupä¸€ä¸ªç®€å•çš„cluster,&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å‡†å¤‡, create &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; with following content,
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; version: &lt;span class=&quot;s1&quot;&gt;'3'&lt;/span&gt;
    
 services:
   some-scylla:
     image: scylladb/scylla
     container_name: some-scylla
    
   some-scylla2:
     image: scylladb/scylla
     container_name: some-scylla2
     &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;--seeds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;some-scylla
    
   some-scylla3:
     image: scylladb/scylla
     container_name: some-scylla3
     &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;--seeds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;some-scylla
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;å•Š, ğŸ˜¤, å¦‚æœç”¨composeçš„è¯, scyllaåœ¨prometheusæ˜¯upä¸èµ·æ¥çš„, æ‰€ä»¥è¿˜æ˜¯è€è€å®å®å›å½’best practiceçš„æ­¥éª¤&lt;sup&gt;5&lt;/sup&gt;
 &lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88785802-3d45c800-d1c4-11ea-97d7-f12efc42f95a.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
    &lt;blockquote&gt;
      &lt;p&gt;failed with cmopose&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;å³,&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; some-scylla scylladb/scylla
 docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; some-scylla2 scylladb/scylla &lt;span class=&quot;nt&quot;&gt;--seeds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;docker inspect &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; some-scylla&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
 docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; some-scylla3 scylladb/scylla &lt;span class=&quot;nt&quot;&gt;--seeds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;docker inspect &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; some-scylla&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88787205-18525480-d1c6-11ea-86bd-7bf5f87e072c.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
    &lt;blockquote&gt;
      &lt;p&gt;passed with single-command&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;å¯åŠ¨
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose up -d&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ£€æŸ¥
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla scylla --version&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker logs some-scylla | tail&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;nodetool
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla nodetool status&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla nodetool describecluster&lt;/code&gt;, æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla nodetool help&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;cqlsh
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla cqlsh&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;describe tables;&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select * from system_schema.scylla_tables limit 13;&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;æŸ¥çœ‹/ä¿®æ”¹é›†ç¾¤é…ç½®&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla grep --color 'cluster' /etc/scylla/scylla.yaml&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla /bin/bash&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla cqlsh UPDATE system.local SET cluster_name = 'my_cluster' where key='local';&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;monitoring&quot;&gt;monitoring&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;download
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; wget https://github.com/scylladb/scylla-monitoring/archive/scylla-monitoring-3.4.2.tar.gz
 &lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xvf&lt;/span&gt; scylla-monitoring-3.4.2.tar.gz
 &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;scylla-monitoring-scylla-monitoring-3.4.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;å‡†å¤‡, create &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scylla-monitoring-scylla-monitoring-3.4.2/prometheus/scylla_servers.yml&lt;/code&gt;
 ```shell
    &lt;ul&gt;
      &lt;li&gt;targets:
      - 172.17.0.2:9180
      - 172.17.0.3:9180
      - 172.17.0.4:9180
labels:
     cluster: â€˜Test Clusterâ€™
     dc: datacenter1
 ```
 é…ç½®valueè¦å¯¹å·å…¥åº§, Use the nodetool to validate them&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å¯åŠ¨
    &lt;ul&gt;
      &lt;li&gt;å½“åœ¨&lt;a href=&quot;https://github.com/scylladb/scylla-monitoring/issues/313#issuecomment-380192083&quot;&gt;mac&lt;/a&gt;å¯åŠ¨æ—¶, ä¼šæ‰¾ä¸åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readlink&lt;/code&gt;, æ‰€ä»¥å°†ä¸‹é¢çš„commandåŠ åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;start-all.sh&lt;/code&gt;çš„å¤´
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alias readlink=greadlink&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh start-all.sh&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ£€æŸ¥
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost:3000/&lt;/code&gt;
 &lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88889353-8c4a3680-d272-11ea-9501-9a66b09a9f57.png&quot; alt=&quot;image&quot; /&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ•°æ®è®¿é—®
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; some-scylla cqlsh
 CREATE KEYSPACE my_keyspace WITH replication &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'class'&lt;/span&gt;:&lt;span class=&quot;s1&quot;&gt;'SimpleStrategy'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'replication_factor'&lt;/span&gt; : 3&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 USE my_keyspace&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 CREATE TABLE students &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id &lt;/span&gt;int PRIMARY KEY, name text, courses map&amp;lt;text, double&amp;gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
 DESCRIBE KEYSPACE my_keyspace&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 DESCRIBE TABLE students&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
 INSERT INTO students &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;, name, courses&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; VALUES &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1, &lt;span class=&quot;s1&quot;&gt;'å¼ ä¸‰'&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'è¯­æ–‡'&lt;/span&gt;: 71.1, &lt;span class=&quot;s1&quot;&gt;'æ•°å­¦'&lt;/span&gt;: 82, &lt;span class=&quot;s1&quot;&gt;'è‹±è¯­'&lt;/span&gt;: 93.3&lt;span class=&quot;o&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 INSERT INTO students &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;, name, courses&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; VALUES &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2, &lt;span class=&quot;s1&quot;&gt;'æå››'&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'è¯­æ–‡'&lt;/span&gt;: 91.1, &lt;span class=&quot;s1&quot;&gt;'æ•°å­¦'&lt;/span&gt;: 82, &lt;span class=&quot;s1&quot;&gt;'è‹±è¯­'&lt;/span&gt;: 73.3&lt;span class=&quot;o&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from students&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88889119-2fe71700-d272-11ea-93a5-064e0a626e4a.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;manager&quot;&gt;manager&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;å®‰è£…
    &lt;ul&gt;
      &lt;li&gt;å¯ä»¥é€šè¿‡dockeræ¥&lt;a href=&quot;https://hub.docker.com/r/scylladb/scylla-manager&quot;&gt;å®‰è£…&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;åŠŸèƒ½
    &lt;ul&gt;
      &lt;li&gt;ä¸€ä¸ªé›†ç¾¤ç®¡ç†ç³»ç»Ÿ, é€šè¿‡å¥¹å¯ä»¥ä½¿ç”¨CLIæ¥handleä¸€ç³»åˆ—task&lt;sup&gt;8&lt;/sup&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;benchmark&quot;&gt;benchmark&lt;/h2&gt;
&lt;h3 id=&quot;cassandra-stress13&quot;&gt;cassandra-stress&lt;sup&gt;13&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨å‰é¢setupäº†ä¸€ä¸ª3èŠ‚ç‚¹çš„cluster, ä¸ºäº†ä½¿ç”¨è¿™ä¸ªbm tool, å¦èµ·ä¸€ä¸ªæ–°çš„clusterä¸ºäº†ä¸ä¹‹éš”ç¦»,&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;new bm cluster
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker run --name some-scylla-bm-only -d scylladb/scylla&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;enter bm cluster
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec -it some-scylla-bm-only /bin/bash&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;run bm cmd
    &lt;ul&gt;
      &lt;li&gt;å†™
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress write n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-write&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress write no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_write&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;è¯»
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress read n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-read&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress read no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_read&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;æ··åˆ
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress mixed ratio\(write=1,read=1\) n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-mixed&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cassandra-stress mixed ratio\(write=1,read=1\) no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_mixed&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88947113-a90e5a80-d2c2-11ea-9b60-a35017c25533.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;write&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88947164-bcb9c100-d2c2-11ea-9a9e-d0f20fbb2594.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;read&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88947193-c7745600-d2c2-11ea-999d-c28b6ec87d70.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;mixed&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;scylla-bench14&quot;&gt;scylla-bench&lt;sup&gt;14&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;go clientçº§åˆ«çš„benchmarkå·¥å…·,&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;install
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;go get github.com/scylladb/scylla-bench&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;run bm cmd
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scylla-bench -workload sequential -mode write -nodes 127.0.0.1:9042&lt;/code&gt;
        &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  mode write
  Results
  Time &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;avg&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:	 4m33.860611808s
  Total ops:	 1000000
  Total rows:	 1000000
  Operations/s:	 3746.9349633592005
  Rows/s:		 3746.9349633592005
  Latency:
    max:		 1.160773631s
    99.9th:	 21.037055ms
    99th:		 10.813439ms
    95th:		 6.750207ms
    90th:		 5.439487ms
    median:	 2.949119ms
    mean:		 3.464229ms        
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scylla-bench -workload sequential -mode read -nodes 127.0.0.1:9042&lt;/code&gt;
        &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  mode &lt;span class=&quot;nb&quot;&gt;read
  &lt;/span&gt;Results
  Time &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;avg&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:	 4m11.740969357s
  Total ops:	 1000000
  Total rows:	 1000000
  Operations/s:	 3972.3625839390193
  Rows/s:		 3972.3625839390193
  Latency:
    max:		 1.015545855s
    99.9th:	 21.626879ms
    99th:		 12.124159ms
    95th:		 7.766015ms
    90th:		 6.324223ms
    median:	 3.473407ms
    mean:		 4.024346ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;å› ä¸ºè¿™ä¸ªbm cmdæˆ‘æ˜¯è¿è¡Œåœ¨host, æ‰€ä»¥docker run some-scyllaæ—¶, æˆ‘åŠ ä¸Šäº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p 9042:9042&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;connector&quot;&gt;connector&lt;/h2&gt;
&lt;h3 id=&quot;spark-batch-writerreader16&quot;&gt;spark batch writer/reader&lt;sup&gt;16&lt;/sup&gt;&lt;/h3&gt;
&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.apache.spark&quot;&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;spark-sql&quot;&lt;/span&gt;                 &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;3.0.0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;com.datastax.spark&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;spark-cassandra-connector&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;2.5.1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;joda-time&quot;&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;joda-time&quot;&lt;/span&gt;                  &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;2.10.6&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io.github.chenfh5.scylladb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.datastax.spark.connector._&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.spark.SparkConf&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.spark.sql.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;SaveMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SparkExample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;keyspaceName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;my_keyspace&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;tableName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;students&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scylladbHostIP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ss&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;conf&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SparkConf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;spark.app.name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;scylladb_writer_test&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;spark.master&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;local[1]&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;spark.cassandra.connection.host&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scylladbHostIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ss.implicits._&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;rdd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sparkContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;cassandraTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;rdd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sparkContext&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;parallelize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æˆ‘çš„åå­—æ˜¯%d&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;è¯­æ–‡&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ•°å­¦&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;spark&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))))&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toDF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;courses&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;write&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.apache.spark.sql.cassandra&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;keyspace&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;table&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SaveMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;Append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;read&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.apache.spark.sql.cassandra&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;keyspace&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;table&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;load&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id &amp;gt; 2&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;courses&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;truncate&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;begin&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;scan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;end&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;flink-streaming-writer17&quot;&gt;flink streaming writer&lt;sup&gt;17&lt;/sup&gt;&lt;/h3&gt;
&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;flink-streaming-scala&quot;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1.11.1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;flink-clients&quot;&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1.11.1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;flink-connector-cassandra&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1.11.1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io.github.chenfh5.scylladb&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.flink.streaming.api.TimeCharacteristic&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.flink.streaming.api.scala.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;StreamExecutionEnvironment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.flink.streaming.connectors.cassandra.CassandraSink&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.collection.JavaConverters._&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FlinkExample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;keyspaceName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;my_keyspace&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;tableName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;students&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scylladbHostIP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;StreamExecutionEnvironment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getExecutionEnvironment&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setStreamTimeCharacteristic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TimeCharacteristic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;EventTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setParallelism&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;fromCollection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æˆ‘çš„åå­—æ˜¯%d&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;è¯­æ–‡&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ•°å­¦&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;flink&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;asJava&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// need convert scala to java pojo&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;keyBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;_1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;CassandraSink&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;addSink&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSERT INTO %s.%s(id, name, courses) values (?, ?, ?);&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setHost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scylladbHostIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setParallelism&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;begin&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;end&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;golang-reader18&quot;&gt;golang reader&lt;sup&gt;18&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;ç±»ä¼¼äºscylla-bench&lt;sup&gt;14&lt;/sup&gt;çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DoReadsFromTable()&lt;/code&gt;æˆ–è€…&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DoScanTable()&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-golang highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;fmt&quot;&lt;/span&gt;

    &lt;span class=&quot;s&quot;&gt;&quot;github.com/gocql/gocql&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;my_keyspace&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;students&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;scylladbHostIP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;// connect to the cluster&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gocql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NewCluster&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scylladbHostIP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Keyspace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyspaceName&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;defer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;// define schema&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;courses&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float64&lt;/span&gt;
    
    &lt;span class=&quot;c&quot;&gt;// list records&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT id, name, courses FROM %s where token(id) &amp;lt;= ? LIMIT 10&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tableName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;12&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Scan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;courses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;student:&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;courses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;reference&quot;&gt;Reference&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.scylladb.com/&quot;&gt;scylladb&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.dynamicyield.com/article/turning-messy-data-into-a-gold-mine/&quot;&gt;Turning messy data into a gold mine using Spark, Flink, and ScyllaDB&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://software.intel.com/content/www/us/en/develop/articles/making-nosql-databases-persistent-memory-aware-the-apache-cassandra-example.html&quot;&gt;Making NoSQL Databases Persistent-Memory-Aware: The Apache Cassandra* Example&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.scylladb.com/download/?platform=docker&quot;&gt;Scylla Download Center&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.scylladb.com/operating-scylla/procedures/tips/best_practices_scylla_on_docker/#id15&quot;&gt;Best Practices for Running Scylla on Docker&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hub.docker.com/r/scylladb/scylla&quot;&gt;docker hub scylladb doc&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.scylladb.com/operating-scylla/monitoring/3.4/monitoring_stack/#install-scylla-monitoring&quot;&gt;install monitoring&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.scylladb.com/operating-scylla/manager/2.1/sctool/#cluster-add&quot;&gt;manager CLI&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/30738569&quot;&gt;å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶Seastarä»‹ç»&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/news/270650#:~:text=Seastar%E6%98%AF%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E5%88%86,%E5%92%8C%E4%BD%8E%E5%BB%B6%E8%BF%9F%E7%9A%84%E7%9B%AE%E6%A0%87%E3%80%82&quot;&gt;ç°ä»£ç¡¬ä»¶ä¸Šçš„é«˜æ€§èƒ½Cï¼‹å¼‚æ­¥æ¡†æ¶-SeaStar&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/mytobaby00/article/details/80375196&quot;&gt;ScyllaDBè°ƒç ”åˆ†æ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.infoq.cn/article/8rleTIWSBo2Y7MpfsMlW&quot;&gt;é€šç”¨é«˜æ•ˆçš„æ•°æ®ä¿®å¤æ–¹æ³•ï¼šRow level repair&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.datastax.com/en/dse/6.0/dse-admin/datastax_enterprise/tools/toolsCStress.html&quot;&gt;cassandra-stress&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/scylladb/scylla-bench&quot;&gt;scylla-bench&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/dml/dmlAboutReads.html&quot;&gt;How Cassandra reads and writes data&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/datastax/spark-cassandra-connector#documentation&quot;&gt;spark-cassandra-connector&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.11/dev/connectors/cassandra.html&quot;&gt;Flink Cassandra Connector&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/scylladb/gocql&quot;&gt;Scylla Go Driver&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="scylladb" /><summary type="html">Overview æœ€è¿‘çœ‹åˆ°scylladbçš„ä¸å…¶ä»–dbçš„æ¯”è¾ƒæ–‡æ¡£æ¯”è¾ƒå…¨é¢, å…¶ä¸­ä¸cassandraå¯¹æ¯”æ›´æ˜¯è¶…å‡ºä¸€æˆª, æ‰€ä»¥è¿‡æ¥çœ‹çœ‹, å…¶æ˜¯åŸºäºC++ seastar9,10é‡å†™çš„column-base nosql, å®ç°äº†CAPä¸­çš„AP, masterless, hash ringæ˜¯P replication_factorå’ŒWAL commit logæ˜¯A, å› æ­¤at least one, æ‰€ä»¥ä¸èƒ½åšåˆ°C CAP theorem Version scylladb, 4.1.2 scylla-monitoring, 3.4.2 Architect read and write flow read and write flow, credit: intel è™šçº¿è¡¨ç¤ºread opåœ¨key cacheæ²¡æœ‰å‘½ä¸­, æ­¤æ—¶ä¼šæœç´¢partition summaryæ¥ç¡®å®špartition index, indexé€šè¿‡compression offset mapå®šä½dataåœ¨sstableçš„ä½ç½®15 partitioning a hash ring to find necessary nodes5 å½“æ‰©ç¼©å®¹nodeæ—¶, æ•´ä¸ªæ‹“æ‰‘ç»“æ„ä¼šå‘ç”Ÿå˜åŒ–, æ­¤æ—¶ä¼šè§¦å‘è‡ªåŠ¨rebalance æ•°æ®çš„å€¾æ–œä¸å¦, å–å†³äºhash(key)çš„å‡åŒ€åº¦ PRIMARY KEYæœ‰2ä¸ªä½œç”¨, partition keys of the table lets you group rows on the same replica set, determines where data is stored on a given node in the cluster, æŒ‡å®šèŠ‚ç‚¹ clustering columns control how those rows are stored on the replica/node, åœ¨step1çš„æŒ‡å®šèŠ‚ç‚¹ä¸Šçš„æ•°æ®å­˜å‚¨ PRIMARY KEY ((a, b), c, d) : a and b compose the partition key, and c is the clustering column. mapping scylladb mysql cluster instance keyspace database table table type è‡ªå®šä¹‰æ•°æ®ç±»å‹ AddOn Scylla Manager &amp;amp; Scylla Monitoring Stack ç›‘æ§å„ä¸ªèŠ‚ç‚¹, æŸ¥çœ‹é›†ç¾¤ overview, credit: scylladb overview2, port usage, credit: scylladb ingest from batch and streaming2 Install scylladb ä¸‹é¢æ ¹æ®ç›¸å…³æ­¥éª¤, æ¥setupä¸€ä¸ªç®€å•çš„cluster, å‡†å¤‡, create docker-compose.yml with following content, version: '3' services: some-scylla: image: scylladb/scylla container_name: some-scylla some-scylla2: image: scylladb/scylla container_name: some-scylla2 command: --seeds=some-scylla some-scylla3: image: scylladb/scylla container_name: some-scylla3 command: --seeds=some-scylla å•Š, ğŸ˜¤, å¦‚æœç”¨composeçš„è¯, scyllaåœ¨prometheusæ˜¯upä¸èµ·æ¥çš„, æ‰€ä»¥è¿˜æ˜¯è€è€å®å®å›å½’best practiceçš„æ­¥éª¤5 failed with cmopose å³, docker run --name some-scylla scylladb/scylla docker run --name some-scylla2 scylladb/scylla --seeds=&quot;$(docker inspect --format='' some-scylla)&quot; docker run --name some-scylla3 scylladb/scylla --seeds=&quot;$(docker inspect --format='' some-scylla)&quot; passed with single-command å¯åŠ¨ docker-compose up -d æ£€æŸ¥ docker exec -it some-scylla scylla --version docker logs some-scylla | tail nodetool docker exec -it some-scylla nodetool status docker exec -it some-scylla nodetool describecluster, æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ docker exec -it some-scylla nodetool help cqlsh docker exec -it some-scylla cqlsh describe tables; select * from system_schema.scylla_tables limit 13; æŸ¥çœ‹/ä¿®æ”¹é›†ç¾¤é…ç½® docker exec -it some-scylla grep --color 'cluster' /etc/scylla/scylla.yaml docker exec -it some-scylla /bin/bash docker exec -it some-scylla cqlsh UPDATE system.local SET cluster_name = 'my_cluster' where key='local'; monitoring download wget https://github.com/scylladb/scylla-monitoring/archive/scylla-monitoring-3.4.2.tar.gz tar -xvf scylla-monitoring-3.4.2.tar.gz cd scylla-monitoring-scylla-monitoring-3.4.2 å‡†å¤‡, create scylla-monitoring-scylla-monitoring-3.4.2/prometheus/scylla_servers.yml ```shell targets: - 172.17.0.2:9180 - 172.17.0.3:9180 - 172.17.0.4:9180 labels: cluster: â€˜Test Clusterâ€™ dc: datacenter1 ``` é…ç½®valueè¦å¯¹å·å…¥åº§, Use the nodetool to validate them å¯åŠ¨ å½“åœ¨macå¯åŠ¨æ—¶, ä¼šæ‰¾ä¸åˆ°readlink, æ‰€ä»¥å°†ä¸‹é¢çš„commandåŠ åˆ°start-all.shçš„å¤´ alias readlink=greadlink sh start-all.sh æ£€æŸ¥ http://localhost:3000/ æ•°æ®è®¿é—® docker exec -it some-scylla cqlsh CREATE KEYSPACE my_keyspace WITH replication = {'class':'SimpleStrategy', 'replication_factor' : 3}; USE my_keyspace; CREATE TABLE students (id int PRIMARY KEY, name text, courses map&amp;lt;text, double&amp;gt;); DESCRIBE KEYSPACE my_keyspace; DESCRIBE TABLE students; INSERT INTO students (id, name, courses) VALUES (1, 'å¼ ä¸‰', {'è¯­æ–‡': 71.1, 'æ•°å­¦': 82, 'è‹±è¯­': 93.3}); INSERT INTO students (id, name, courses) VALUES (2, 'æå››', {'è¯­æ–‡': 91.1, 'æ•°å­¦': 82, 'è‹±è¯­': 73.3}); select * from students; manager å®‰è£… å¯ä»¥é€šè¿‡dockeræ¥å®‰è£… åŠŸèƒ½ ä¸€ä¸ªé›†ç¾¤ç®¡ç†ç³»ç»Ÿ, é€šè¿‡å¥¹å¯ä»¥ä½¿ç”¨CLIæ¥handleä¸€ç³»åˆ—task8 benchmark cassandra-stress13 åœ¨å‰é¢setupäº†ä¸€ä¸ª3èŠ‚ç‚¹çš„cluster, ä¸ºäº†ä½¿ç”¨è¿™ä¸ªbm tool, å¦èµ·ä¸€ä¸ªæ–°çš„clusterä¸ºäº†ä¸ä¹‹éš”ç¦», new bm cluster docker run --name some-scylla-bm-only -d scylladb/scylla enter bm cluster docker exec -it some-scylla-bm-only /bin/bash run bm cmd å†™ cassandra-stress write n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-write cassandra-stress write no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_write è¯» cassandra-stress read n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-read cassandra-stress read no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_read æ··åˆ cassandra-stress mixed ratio\(write=1,read=1\) n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-mixed cassandra-stress mixed ratio\(write=1,read=1\) no-warmup n=1000000 -rate threads=64 -node 172.17.0.2 -graph file=graph.html title=awesome revision=bm-no_warmup_mixed write read mixed scylla-bench14 go clientçº§åˆ«çš„benchmarkå·¥å…·, install go get github.com/scylladb/scylla-bench run bm cmd scylla-bench -workload sequential -mode write -nodes 127.0.0.1:9042 mode write Results Time (avg): 4m33.860611808s Total ops: 1000000 Total rows: 1000000 Operations/s: 3746.9349633592005 Rows/s: 3746.9349633592005 Latency: max: 1.160773631s 99.9th: 21.037055ms 99th: 10.813439ms 95th: 6.750207ms 90th: 5.439487ms median: 2.949119ms mean: 3.464229ms scylla-bench -workload sequential -mode read -nodes 127.0.0.1:9042 mode read Results Time (avg): 4m11.740969357s Total ops: 1000000 Total rows: 1000000 Operations/s: 3972.3625839390193 Rows/s: 3972.3625839390193 Latency: max: 1.015545855s 99.9th: 21.626879ms 99th: 12.124159ms 95th: 7.766015ms 90th: 6.324223ms median: 3.473407ms mean: 4.024346ms å› ä¸ºè¿™ä¸ªbm cmdæˆ‘æ˜¯è¿è¡Œåœ¨host, æ‰€ä»¥docker run some-scyllaæ—¶, æˆ‘åŠ ä¸Šäº† -p 9042:9042 connector spark batch writer/reader16 &quot;org.apache.spark&quot; %% &quot;spark-sql&quot; % &quot;3.0.0&quot;, &quot;com.datastax.spark&quot; %% &quot;spark-cassandra-connector&quot; % &quot;2.5.1&quot;, &quot;joda-time&quot; % &quot;joda-time&quot; % &quot;2.10.6&quot;, package io.github.chenfh5.scylladb import com.datastax.spark.connector._ import org.apache.spark.SparkConf import org.apache.spark.sql.{SaveMode, SparkSession} object SparkExample { private val keyspaceName = &quot;my_keyspace&quot; private val tableName = &quot;students&quot; private val scylladbHostIP = &quot;127.0.0.1&quot; private val ss = { val conf = new SparkConf() conf.set(&quot;spark.app.name&quot;, &quot;scylladb_writer_test&quot;) conf.set(&quot;spark.master&quot;, &quot;local[1]&quot;) conf.set(&quot;spark.cassandra.connection.host&quot;, scylladbHostIP) SparkSession.builder().config(conf).getOrCreate() } import ss.implicits._ def scan(): Unit = { val rdd = ss.sparkContext.cassandraTable(keyspaceName, tableName) rdd.take(11).foreach(println) } def writer(): Unit = { val df = ss.sparkContext .parallelize((10 to 13).map(i =&amp;gt; (i, &quot;æˆ‘çš„åå­—æ˜¯%d&quot;.format(i), Map(&quot;è¯­æ–‡&quot; -&amp;gt; (i + 0.1), &quot;æ•°å­¦&quot; -&amp;gt; (i + 0.2), &quot;spark&quot; -&amp;gt; (i + 0.3))))) .toDF(&quot;id&quot;, &quot;name&quot;, &quot;courses&quot;) df.show() df.write .format(&quot;org.apache.spark.sql.cassandra&quot;) .option(&quot;keyspace&quot;, keyspaceName) .option(&quot;table&quot;, tableName) .mode(SaveMode.Append) .save() } def read(): Unit = { val df = ss.read .format(&quot;org.apache.spark.sql.cassandra&quot;) .option(&quot;keyspace&quot;, keyspaceName) .option(&quot;table&quot;, tableName) .load .filter(&quot;id &amp;gt; 2&quot;) .select(&quot;id&quot;, &quot;name&quot;, &quot;courses&quot;) df.show(11, truncate = false) } def main(args: Array[String]): Unit = { println(&quot;begin&quot;) scan() writer() read() println(&quot;end&quot;) } } flink streaming writer17 &quot;org.apache.flink&quot; %% &quot;flink-streaming-scala&quot; % &quot;1.11.1&quot;, &quot;org.apache.flink&quot; %% &quot;flink-clients&quot; % &quot;1.11.1&quot;, &quot;org.apache.flink&quot; %% &quot;flink-connector-cassandra&quot; % &quot;1.11.1&quot;, package io.github.chenfh5.scylladb import org.apache.flink.streaming.api.TimeCharacteristic import org.apache.flink.streaming.api.scala.{StreamExecutionEnvironment, _} import org.apache.flink.streaming.connectors.cassandra.CassandraSink import scala.collection.JavaConverters._ object FlinkExample { private val keyspaceName = &quot;my_keyspace&quot; private val tableName = &quot;students&quot; private val scylladbHostIP = &quot;127.0.0.1&quot; def writer(): Unit = { val env = StreamExecutionEnvironment.getExecutionEnvironment env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime) env.setParallelism(1) val source = env.fromCollection((20 to 25).map(i =&amp;gt; (i, &quot;æˆ‘çš„åå­—æ˜¯%d&quot;.format(i), Map(&quot;è¯­æ–‡&quot; -&amp;gt; (i + 0.1), &quot;æ•°å­¦&quot; -&amp;gt; (i + 0.2), &quot;flink&quot; -&amp;gt; (i + 0.3)).asJava))) // need convert scala to java pojo val result = source.filter(e =&amp;gt; e._1 &amp;lt; 24).keyBy(_._1) CassandraSink .addSink(result) .setQuery(&quot;INSERT INTO %s.%s(id, name, courses) values (?, ?, ?);&quot;.format(keyspaceName, tableName)) .setHost(scylladbHostIP) .build() result.print().setParallelism(1) env.execute() } def main(args: Array[String]): Unit = { println(&quot;begin&quot;) writer() println(&quot;end&quot;) } } golang reader18 ç±»ä¼¼äºscylla-bench14çš„DoReadsFromTable()æˆ–è€…DoScanTable() package main import ( &quot;fmt&quot; &quot;github.com/gocql/gocql&quot; ) const ( keyspaceName = &quot;my_keyspace&quot; tableName = &quot;students&quot; scylladbHostIP = &quot;127.0.0.1&quot; ) func main() { // connect to the cluster cluster := gocql.NewCluster(scylladbHostIP) cluster.Keyspace = keyspaceName session, _ := cluster.CreateSession() defer session.Close() // define schema var id int var name string var courses map[string]float64 // list records iter := session.Query(fmt.Sprintf(&quot;SELECT id, name, courses FROM %s where token(id) &amp;lt;= ? LIMIT 10&quot;, tableName), &quot;12&quot;).Iter() for iter.Scan(&amp;amp;id, &amp;amp;name, &amp;amp;courses) { fmt.Println(&quot;student:&quot;, id, name, courses) } if err := iter.Close(); err != nil { fmt.Println(err) } } Reference scylladb Turning messy data into a gold mine using Spark, Flink, and ScyllaDB Making NoSQL Databases Persistent-Memory-Aware: The Apache Cassandra* Example Scylla Download Center Best Practices for Running Scylla on Docker docker hub scylladb doc install monitoring manager CLI å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶Seastarä»‹ç» ç°ä»£ç¡¬ä»¶ä¸Šçš„é«˜æ€§èƒ½Cï¼‹å¼‚æ­¥æ¡†æ¶-SeaStar ScyllaDBè°ƒç ”åˆ†æ é€šç”¨é«˜æ•ˆçš„æ•°æ®ä¿®å¤æ–¹æ³•ï¼šRow level repair cassandra-stress scylla-bench How Cassandra reads and writes data spark-cassandra-connector Flink Cassandra Connector Scylla Go Driver</summary></entry><entry><title type="html">stock buy and sell point</title><link href="http://localhost:4000/2020/07/20/00_stock_buy_sell_point.html" rel="alternate" type="text/html" title="stock buy and sell point" /><published>2020-07-20T00:00:00+08:00</published><updated>2020-07-20T00:00:00+08:00</updated><id>http://localhost:4000/2020/07/20/00_stock_buy_sell_point</id><content type="html" xml:base="http://localhost:4000/2020/07/20/00_stock_buy_sell_point.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;å°†cmoney&lt;sup&gt;1&lt;/sup&gt;é‡Œé¢çš„æŠ€æœ¯æŒ‡æ ‡å†…å®¹æ•´ç†ä¸€ä¸‹, ä½¿ä¹‹é€‚åˆè‡ªå·±è§‚çœ‹ä¹ æƒ¯,&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;çŸ­çº¿ç”¨å°æ—¶çº¿ç²’åº¦, é•¿çº¿ç”¨æ—¥çº¿ç²’åº¦&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;çº¿&quot;&gt;çº¿&lt;/h1&gt;
&lt;p&gt;æ³¨æ„ç”¨çº¿æ˜¯å°æ—¶çº¿è¿˜æ˜¯æ—¥çº¿,&lt;/p&gt;

&lt;h2 id=&quot;ma&quot;&gt;MA&lt;/h2&gt;
&lt;p&gt;çŸ­çº¿æŠ•èµ„äººå¯ç”¨5MA + 20MA çœ‹å¤šç©ºèµ°åŠ¿,&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ”¶ç›˜ä»· &amp;gt; 5MA &amp;gt; 20MA: å¤šå¤´å¸‚åœº
    &lt;ul&gt;
      &lt;li&gt;é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°ä¸Šæ¶¨è¶‹åŠ¿çš„å¤šå¤´å¸‚åœº&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ”¶ç›˜ä»· &amp;lt; 5MA &amp;lt; 20MA: ç©ºå¤´å¸‚åœº
    &lt;ul&gt;
      &lt;li&gt;é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°ä¸‹è·Œè¶‹åŠ¿çš„ç©ºå¤´å¸‚åœº&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;5MA &amp;lt; æ”¶ç›˜ä»· &amp;lt; 20MA: ç›˜æ•´å¸‚åœº
    &lt;ul&gt;
      &lt;li&gt;é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°æ¨ªå‘è¶‹åŠ¿çš„ç›˜æ•´å¸‚åœº&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç”¨5MA, 20MA æ“ä½œçš„ç»éªŒæ³•åˆ™,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;å½“è‚¡ä»·&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;è·Œç ´5MA&lt;/code&gt;è¡¨ç¤ºçŸ­çº¿è½¬å¼±å¯ä»¥å‡ç å–å‡º&lt;/li&gt;
  &lt;li&gt;ä¸€æ—¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;è·Œç ´20MA&lt;/code&gt;è¦å…¨éƒ¨å–å‡º, é€€å‡ºåœºå¤–è§‚æœ›&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç”¨å‡çº¿çœ‹å¤šç©ºèµ°åŠ¿&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;çŸ­å¤©æœŸå‡çº¿åœ¨é•¿å¤©æœŸå‡çº¿ä¹‹ä¸Š, æ˜¯å¤šå¤´èµ°åŠ¿&lt;/li&gt;
  &lt;li&gt;é•¿å¤©æœŸå‡çº¿åœ¨çŸ­å¤©æœŸå‡çº¿ä¹‹ä¸Š, æ˜¯ç©ºå¤´èµ°åŠ¿&lt;/li&gt;
  &lt;li&gt;å½“è‚¡ä»·ç«™ä¸Šæ‰€æœ‰å‡çº¿, æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å‡çº¿å¤šå¤´&lt;/code&gt;æ’åˆ—&lt;/li&gt;
  &lt;li&gt;å½“è‚¡ä»·è·Œç ´æ‰€æœ‰å‡çº¿, æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å‡çº¿ç©ºå¤´&lt;/code&gt;æ’åˆ—&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;kdj&quot;&gt;KDJ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;å½“KDæŒ‡æ ‡çš„K(å¿«çº¿)å€¼ç”±ä¸‹å¾€ä¸Šçªç ´Då€¼(é‡‘å‰), å»ºè®®ä¹°è¿›åšå¤š&lt;/li&gt;
  &lt;li&gt;å½“KDæŒ‡æ ‡çš„Kå€¼ç”±ä¸Šå¾€ä¸‹è·Œç ´Då€¼æ—¶, å»ºè®®å–å‡ºåšç©º&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;KDå¤§äº80æ—¶, ä¸ºé«˜æ¡£è¶…ä¹°è®¯å·, å¸‚åœºè¿‡çƒ­, è‚¡ä»·è¦å¼€å§‹è·Œäº†&lt;/li&gt;
  &lt;li&gt;KDå°äº20æ—¶, ä¸ºä½æ¡£è¶…å–è®¯å·, å¸‚åœºè¿‡å†·, è‚¡ä»·è¦å¼€å§‹æ¶¨äº†&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;é«˜æ¡£&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;é’åŒ–&lt;/code&gt;: KDçš„Kå€¼åœ¨80ä»¥ä¸Šè¿ç»­3å¤©, æœªæ¥å†æ¶¨çš„æœºç‡é«˜&lt;/li&gt;
  &lt;li&gt;ä½æ¡£é’åŒ–: KDçš„Kå€¼åœ¨20ä»¥ä¸‹è¿ç»­3å¤©, æœªæ¥ç»§ç»­è·Œçš„æœºç‡é«˜&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;macd&quot;&gt;MACD&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;DIF(å¿«çº¿)å¼€å§‹å‘ä¸‹å¼¯, å¼€å§‹ä¸‹è·Œ&lt;/li&gt;
  &lt;li&gt;DIF(å¿«çº¿)å¼€å§‹å‘ä¸Šæ°, å¼€å§‹ä¸Šå‡&lt;/li&gt;
  &lt;li&gt;å½“ç„¶ä¹Ÿæœ‰é’åŒ–ç°è±¡&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;boll&quot;&gt;BOLL&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;åšå¤šæ—¶, è‚¡ä»·ç¢°åˆ°ä¸Šè½¨é“, å‡ºåœºè®¯å·
    &lt;blockquote&gt;

      &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  å½“ä½ ä¹°è¿›è‚¡ç¥¨æˆ–åšå¤š
  è‚¡ä»·ç¢°åˆ°ä¸Šè½¨é“, è¦å†æ¶¨çš„æœºä¼šå°±å¾ˆå°
  è¿™æ ·æˆ‘ä»¬å¯ä»¥é€‰æ‹©å‡ºåœº
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;åšç©ºæ—¶, è‚¡ä»·ç¢°åˆ°ä¸‹è½¨é“, è¿›åœºè®¯å·
    &lt;blockquote&gt;

      &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  å½“è‚¡ä»·ç¢°åˆ°ä¸‹è½¨é“
  è¦å†è·Œçš„æœºä¼šå°±ä¸æ˜¯é‚£ä¹ˆå¤§
  é‚£å°±ç»™æˆ‘ä»¬è¿›åœºçš„ç†ç”±
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¤šå¤´è®¯å·æœ‰ä¸‰ä¸ª:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ä»·æ ¼ç”±ä¸‹å‘ä¸Š, ç©¿è¶Š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä¸‹è½¨çº¿&lt;/code&gt;æ—¶æ˜¯ä¹°è¿›è®¯å·&lt;/li&gt;
  &lt;li&gt;ä»·æ ¼ç”±ä¸‹å‘ä¸Š, ç©¿è¶Š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä¸­é—´çº¿&lt;/code&gt;æ—¶, è‚¡ä»·å¯èƒ½åŠ é€Ÿå‘ä¸Š, æ˜¯åŠ ç ä¹°è¿›è®¯å·&lt;/li&gt;
  &lt;li&gt;ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä¸Šè½¨çº¿&lt;/code&gt;ä¹‹é—´, æ³¢åŠ¨ä¸ºå¤šå¤´å¸‚åœº, å¯åšå¤š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç©ºå¤´è®¯å·æœ‰ä¸¤ä¸ª:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸ä¸Šè½¨çº¿é—´, ç”±ä¸Šå¾€ä¸‹è·Œç ´ä¸­é—´çº¿, ä¸ºå–å‡ºè®¯å·&lt;/li&gt;
  &lt;li&gt;ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸ä¸‹è½¨çº¿ä¹‹é—´, å‘ä¸‹æ³¢åŠ¨æ—¶ä¸ºç©ºå¤´å¸‚åœº, å¯åšç©º&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;å½¢æ€å­¦&quot;&gt;å½¢æ€å­¦&lt;/h1&gt;
&lt;p&gt;æ³¨æ„ç”¨çº¿æ˜¯å°æ—¶çº¿è¿˜æ˜¯æ—¥çº¿,&lt;/p&gt;

&lt;h2 id=&quot;mwå½¢&quot;&gt;M/Wå½¢&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87465394-22f9df00-c647-11ea-8f6f-0c693232f858.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šè·Œ, Må¤´, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87465409-2a20ed00-c647-11ea-954d-82da25276d3b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šå‡, Wåº•, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;å¤´è‚©&quot;&gt;å¤´è‚©&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87464020-00ff5d00-c645-11ea-8596-467ac143988f.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87464043-09f02e80-c645-11ea-96a0-866addea691c.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;å¤´è‚©é¡¶, ä¼šè·Œ, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87464098-212f1c00-c645-11ea-8aa3-4ef29570f924.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87464104-24c2a300-c645-11ea-891c-bb5a70f5cc68.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;å¤´è‚©åº•(å€’), ä¼šå‡, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ç¼ºå£&quot;&gt;ç¼ºå£&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87468932-095b9600-c64d-11ea-895d-d4dc758e5b4e.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šè·Œ, å¤´éƒ¨çš„å²›çŠ¶åè½¬, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87468956-15dfee80-c64d-11ea-94da-7829e9e5200b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šå‡, åº•éƒ¨çš„å²›çŠ¶åè½¬, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ä¸‰è§’æ——æ——å½¢&quot;&gt;ä¸‰è§’æ——/æ——å½¢&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87469416-d5cd3b80-c64d-11ea-9b8a-c94bf2703277.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;æ——å€¾æ–œæ–¹å‘ä¸ä»·æ ¼è¶‹åŠ¿ç›¸å, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;æ”¯æ’‘å’Œå‹åŠ›&quot;&gt;æ”¯æ’‘å’Œå‹åŠ›&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87467796-17a8b280-c64b-11ea-8565-4231c6f5a6cb.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šè·Œ, è¿æ¥è‡³å°‘2ä¸ªæœ€ä½ç‚¹, çœŸçªç ´æ”¯æ’‘å°±ä¼šå½¢æˆè·ŒåŠ¿, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87467821-1d05fd00-c64b-11ea-8614-b383ffd4b5c3.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šå‡, è¿æ¥è‡³å°‘2ä¸ªæœ€é«˜ç‚¹, çœŸçªç ´å‹åŠ›å°±ä¼šå½¢æˆå‡åŠ¿, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87467672-ea5c0480-c64a-11ea-80d9-e9d243574fa1.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;çœŸçªç ´: &amp;gt;3%ä»·, &amp;gt;30%é‡, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;å…¶ä»–&quot;&gt;å…¶ä»–&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87570540-631a9980-c6fb-11ea-8124-208fa7d3a2f7.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¼šè·Œ, ä¸‰åªä¹Œé¸¦(åœ¨ä¸Šå‡è¶‹åŠ¿ä¸­å‡ºç°ä¸€æ ¹å¤§é˜³çº¿, æ¥ä¸‹æ¥è¿ç»­å‡ºç°ä¸‰æ ¹é˜´Kçº¿, æ—¥çº¿çº§åˆ«), credit: zhihuæ™“æ™“&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87869957-892f8a80-c9d6-11ea-96c8-f531440b06ed.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç®±å‹æ•´ç†, credit: moneynet&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88033494-06433700-cb72-11ea-9eed-c6ff6e739a11.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¸Šå‡æ¥”å½¢, support/ä¸‹çº¿å¡åº¦æ›´å¤§&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/88033520-0fcc9f00-cb72-11ea-8adb-2657d530fb3b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä¸‹é™æ¥”å½¢, resistance/ä¸Šçº¿å¡åº¦æ›´å¤§&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ•´ç†å½¢æ€: æœºæ„é€šè¿‡æ´—ç›˜&lt;sup&gt;5&lt;/sup&gt;,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ä¸€è¾¹æ’µèµ°äº†æ„å¿—ä¸åšå®šçš„æŠ•èµ„äºº, é‡æ–°åœ¨é«˜ä½å¼•è¿›äº†å¦ä¸€æ‰¹çœ‹å¥½åå¸‚çš„æŠ•èµ„äºº(æ¸…ç†å‡ºè·åˆ©ç­¹ç , å¼•è¿›é«˜æˆæœ¬éŸ­èœ)&lt;/li&gt;
  &lt;li&gt;ä¸€è¾¹æ•™è‚²äº†ç»§ç»­æŒè‚¡çš„æŠ•èµ„äºº, ä¸è¦è½»æ˜“ä¹°å–è‚¡ç¥¨, é•¿æŠ±ä¸æ‡ˆæ‰èƒ½æŒ£å¤§é’±&lt;/li&gt;
  &lt;li&gt;ä¸€è¾¹æ‘Šä½äº†è‡ªå·±çš„æŒä»“æˆæœ¬(é«˜å–ä½å¸)&lt;/li&gt;
  &lt;li&gt;ä¸€çŸ³ä¸‰é¸Ÿ. è¿™æ ·æœºæ„æ‰èƒ½å¤Ÿåœ¨é«˜ä½ä»å®¹å‡ºé€ƒ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æ³¨æ„&quot;&gt;æ³¨æ„&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;æŠ€æœ¯åˆ†æèƒ½åˆ¤æ–­è‚¡ä»·æ–¹å‘, ä¸èƒ½åæ˜ çœŸå®ä»·å€¼&lt;/li&gt;
  &lt;li&gt;æŠ€æœ¯åˆ†æèƒ½æé«˜èƒœç‡, ä½†ä¸æ˜¯100%ä¼šæˆåŠŸ&lt;/li&gt;
  &lt;li&gt;å¸‚åœºææ…Œæ—¶, æŠ€æœ¯åˆ†æä¼šå¤±å»åˆ¤æ–­æ–¹å‘çš„èƒ½åŠ›&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;æˆäº¤é‡&quot;&gt;æˆäº¤é‡&lt;/h1&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªäº¤æ˜“æ—¥å½“ä¸­, è‹¥ä¸€åªä¸ªè‚¡çš„æˆäº¤é‡ä¸º150000è‚¡, åˆ™è¡¨ç¤ºä¹°æ–¹åœ¨å½“æ—¥å…±ä¹°è¿›äº†150000è‚¡, åŒæ—¶å–æ–¹ä¹Ÿå–å‡ºäº†150000è‚¡&lt;sup&gt;3&lt;/sup&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æˆäº¤é‡æ˜¯å¤šç©ºåŒæ–¹äº¤é”‹åŠ›åº¦çš„ä½“ç°. æˆäº¤é‡å¤§, è¯´æ˜å¤šç©ºåŒæ–¹äº¤é”‹è¾ƒä¸ºæ¿€çƒˆ, è¿™ä¸»è¦å‘ç”Ÿåœ¨ä»·æ ¼èµ°åŠ¿è¾ƒä¸ºæ¿€è¿›çš„æ—¶å€™, ä¾‹å¦‚å¿«é€Ÿçš„ä¸Šæ¶¨ã€å¿«é€Ÿçš„ä¸‹è·Œç­‰&lt;/li&gt;
  &lt;li&gt;æˆäº¤é‡å°, è¯´æ˜å¤šç©ºåŒæ–¹äº¤é”‹ç¼“å’Œ, è¿™ä¸»è¦å‘ç”Ÿåœ¨ä»·æ ¼èµ°åŠ¿è¾ƒä¸ºå¹³ç¼“ã€å¤šç©ºåŒæ–¹åˆ†æ­§ä¸å¤§çš„æ—¶å€™, ä¾‹å¦‚æ¨ªç›˜çš„çª„å¹…éœ‡è¡èµ°åŠ¿&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆäº¤é‡å¯ä»¥æœ‰æ•ˆåœ°æ­ç¤ºä¸»åŠ›çš„å¸‚åœºè¡Œä¸ºå¹¶é¢„ç¤ºä»·æ ¼èµ°åŠ¿, è¿™å°±æ˜¯æ‰€è°“çš„é‡åœ¨ä»·å…ˆ. é‡åœ¨ä»·å…ˆæ˜¯æŒ‡ï¼šåœ¨ä»·æ ¼èµ°åŠ¿æœªè§æ˜æ˜¾å˜åŒ–çš„æƒ…å†µä¸‹, æˆäº¤é‡å¾€å¾€ä¼šæå‰å˜åŒ–, å¦‚æœæˆ‘ä»¬å¯ä»¥ç†è§£é‡èƒ½è¿™ç§å˜åŒ–çš„å¸‚åœºå«ä¹‰, å°±å¯ä»¥èµ°åœ¨å¸‚åœºçš„å‰é¢, ä»è€ŒæˆåŠŸåœ°å±•å¼€ä½ä¹°é«˜å–çš„æ“ä½œ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87882361-1f44ce80-ca32-11ea-81e6-85b3e28592a3.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;é‡ä»·å…³ç³», credit: ç†Šå¸‚çŒæ‰‹&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ€»ä¹‹, ä¸Šå‡è¦é‡, ä¸‹è·Œæœªå¿…è¦é‡&lt;/p&gt;

&lt;h1 id=&quot;æ³¢æµªç†è®º&quot;&gt;æ³¢æµªç†è®º&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/87866160-ced95c80-c9b0-11ea-8350-736c254e4664.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;è‚¡ä»·æœ‰ä¸€ä¸ªã€äº”æ³¢ä¸Šå‡ã€ä¸‰æ³¢ä¸‹é™ã€çš„åŸºæœ¬è§„å¾‹, credit: cmoney&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;1,3,5å‡&lt;/li&gt;
  &lt;li&gt;2,4,bå›è°ƒ&lt;/li&gt;
  &lt;li&gt;a,cè·Œ&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;reference&quot;&gt;Reference&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cmoney.tw/learn/course/technicals/topic/486&quot;&gt;è‚¡ç¥¨æŠ€æœ¯é¢åˆ†æ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.moneynet.com.tw/article/4875&quot;&gt;ä¸­ç¹¼å‹æ…‹åœ–å½¢1ç®±å‹æ•´ç†&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/29473752&quot;&gt;æˆäº¤é‡ä¿¡å·&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/1WY7zr7c3xSEbOJuTcg01g&quot;&gt;æˆäº¤é‡ä¿¡å·2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://wiki.mbalib.com/wiki/%E6%95%B4%E7%90%86%E5%BD%A2%E6%80%81&quot;&gt;æ•´ç†å½¢æ€&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="stock" /><summary type="html">Overview å°†cmoney1é‡Œé¢çš„æŠ€æœ¯æŒ‡æ ‡å†…å®¹æ•´ç†ä¸€ä¸‹, ä½¿ä¹‹é€‚åˆè‡ªå·±è§‚çœ‹ä¹ æƒ¯, çŸ­çº¿ç”¨å°æ—¶çº¿ç²’åº¦, é•¿çº¿ç”¨æ—¥çº¿ç²’åº¦ çº¿ æ³¨æ„ç”¨çº¿æ˜¯å°æ—¶çº¿è¿˜æ˜¯æ—¥çº¿, MA çŸ­çº¿æŠ•èµ„äººå¯ç”¨5MA + 20MA çœ‹å¤šç©ºèµ°åŠ¿, æ”¶ç›˜ä»· &amp;gt; 5MA &amp;gt; 20MA: å¤šå¤´å¸‚åœº é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°ä¸Šæ¶¨è¶‹åŠ¿çš„å¤šå¤´å¸‚åœº æ”¶ç›˜ä»· &amp;lt; 5MA &amp;lt; 20MA: ç©ºå¤´å¸‚åœº é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°ä¸‹è·Œè¶‹åŠ¿çš„ç©ºå¤´å¸‚åœº 5MA &amp;lt; æ”¶ç›˜ä»· &amp;lt; 20MA: ç›˜æ•´å¸‚åœº é€šå¸¸è¡¨ç¤ºçŸ­çº¿å‘ˆç°æ¨ªå‘è¶‹åŠ¿çš„ç›˜æ•´å¸‚åœº ç”¨5MA, 20MA æ“ä½œçš„ç»éªŒæ³•åˆ™, å½“è‚¡ä»·è·Œç ´5MAè¡¨ç¤ºçŸ­çº¿è½¬å¼±å¯ä»¥å‡ç å–å‡º ä¸€æ—¦è·Œç ´20MAè¦å…¨éƒ¨å–å‡º, é€€å‡ºåœºå¤–è§‚æœ› ç”¨å‡çº¿çœ‹å¤šç©ºèµ°åŠ¿ çŸ­å¤©æœŸå‡çº¿åœ¨é•¿å¤©æœŸå‡çº¿ä¹‹ä¸Š, æ˜¯å¤šå¤´èµ°åŠ¿ é•¿å¤©æœŸå‡çº¿åœ¨çŸ­å¤©æœŸå‡çº¿ä¹‹ä¸Š, æ˜¯ç©ºå¤´èµ°åŠ¿ å½“è‚¡ä»·ç«™ä¸Šæ‰€æœ‰å‡çº¿, æ˜¯å‡çº¿å¤šå¤´æ’åˆ— å½“è‚¡ä»·è·Œç ´æ‰€æœ‰å‡çº¿, æ˜¯å‡çº¿ç©ºå¤´æ’åˆ— KDJ å½“KDæŒ‡æ ‡çš„K(å¿«çº¿)å€¼ç”±ä¸‹å¾€ä¸Šçªç ´Då€¼(é‡‘å‰), å»ºè®®ä¹°è¿›åšå¤š å½“KDæŒ‡æ ‡çš„Kå€¼ç”±ä¸Šå¾€ä¸‹è·Œç ´Då€¼æ—¶, å»ºè®®å–å‡ºåšç©º KDå¤§äº80æ—¶, ä¸ºé«˜æ¡£è¶…ä¹°è®¯å·, å¸‚åœºè¿‡çƒ­, è‚¡ä»·è¦å¼€å§‹è·Œäº† KDå°äº20æ—¶, ä¸ºä½æ¡£è¶…å–è®¯å·, å¸‚åœºè¿‡å†·, è‚¡ä»·è¦å¼€å§‹æ¶¨äº† é«˜æ¡£é’åŒ–: KDçš„Kå€¼åœ¨80ä»¥ä¸Šè¿ç»­3å¤©, æœªæ¥å†æ¶¨çš„æœºç‡é«˜ ä½æ¡£é’åŒ–: KDçš„Kå€¼åœ¨20ä»¥ä¸‹è¿ç»­3å¤©, æœªæ¥ç»§ç»­è·Œçš„æœºç‡é«˜ MACD DIF(å¿«çº¿)å¼€å§‹å‘ä¸‹å¼¯, å¼€å§‹ä¸‹è·Œ DIF(å¿«çº¿)å¼€å§‹å‘ä¸Šæ°, å¼€å§‹ä¸Šå‡ å½“ç„¶ä¹Ÿæœ‰é’åŒ–ç°è±¡ BOLL åšå¤šæ—¶, è‚¡ä»·ç¢°åˆ°ä¸Šè½¨é“, å‡ºåœºè®¯å· å½“ä½ ä¹°è¿›è‚¡ç¥¨æˆ–åšå¤š è‚¡ä»·ç¢°åˆ°ä¸Šè½¨é“, è¦å†æ¶¨çš„æœºä¼šå°±å¾ˆå° è¿™æ ·æˆ‘ä»¬å¯ä»¥é€‰æ‹©å‡ºåœº åšç©ºæ—¶, è‚¡ä»·ç¢°åˆ°ä¸‹è½¨é“, è¿›åœºè®¯å· å½“è‚¡ä»·ç¢°åˆ°ä¸‹è½¨é“ è¦å†è·Œçš„æœºä¼šå°±ä¸æ˜¯é‚£ä¹ˆå¤§ é‚£å°±ç»™æˆ‘ä»¬è¿›åœºçš„ç†ç”± å¤šå¤´è®¯å·æœ‰ä¸‰ä¸ª: ä»·æ ¼ç”±ä¸‹å‘ä¸Š, ç©¿è¶Šä¸‹è½¨çº¿æ—¶æ˜¯ä¹°è¿›è®¯å· ä»·æ ¼ç”±ä¸‹å‘ä¸Š, ç©¿è¶Šä¸­é—´çº¿æ—¶, è‚¡ä»·å¯èƒ½åŠ é€Ÿå‘ä¸Š, æ˜¯åŠ ç ä¹°è¿›è®¯å· ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸ä¸Šè½¨çº¿ä¹‹é—´, æ³¢åŠ¨ä¸ºå¤šå¤´å¸‚åœº, å¯åšå¤š ç©ºå¤´è®¯å·æœ‰ä¸¤ä¸ª: ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸ä¸Šè½¨çº¿é—´, ç”±ä¸Šå¾€ä¸‹è·Œç ´ä¸­é—´çº¿, ä¸ºå–å‡ºè®¯å· ä»·æ ¼åœ¨ä¸­é—´çº¿ä¸ä¸‹è½¨çº¿ä¹‹é—´, å‘ä¸‹æ³¢åŠ¨æ—¶ä¸ºç©ºå¤´å¸‚åœº, å¯åšç©º å½¢æ€å­¦ æ³¨æ„ç”¨çº¿æ˜¯å°æ—¶çº¿è¿˜æ˜¯æ—¥çº¿, M/Wå½¢ ä¼šè·Œ, Må¤´, credit: cmoney ä¼šå‡, Wåº•, credit: cmoney å¤´è‚© å¤´è‚©é¡¶, ä¼šè·Œ, credit: cmoney å¤´è‚©åº•(å€’), ä¼šå‡, credit: cmoney ç¼ºå£ ä¼šè·Œ, å¤´éƒ¨çš„å²›çŠ¶åè½¬, credit: cmoney ä¼šå‡, åº•éƒ¨çš„å²›çŠ¶åè½¬, credit: cmoney ä¸‰è§’æ——/æ——å½¢ æ——å€¾æ–œæ–¹å‘ä¸ä»·æ ¼è¶‹åŠ¿ç›¸å, credit: cmoney æ”¯æ’‘å’Œå‹åŠ› ä¼šè·Œ, è¿æ¥è‡³å°‘2ä¸ªæœ€ä½ç‚¹, çœŸçªç ´æ”¯æ’‘å°±ä¼šå½¢æˆè·ŒåŠ¿, credit: cmoney ä¼šå‡, è¿æ¥è‡³å°‘2ä¸ªæœ€é«˜ç‚¹, çœŸçªç ´å‹åŠ›å°±ä¼šå½¢æˆå‡åŠ¿, credit: cmoney çœŸçªç ´: &amp;gt;3%ä»·, &amp;gt;30%é‡, credit: cmoney å…¶ä»– ä¼šè·Œ, ä¸‰åªä¹Œé¸¦(åœ¨ä¸Šå‡è¶‹åŠ¿ä¸­å‡ºç°ä¸€æ ¹å¤§é˜³çº¿, æ¥ä¸‹æ¥è¿ç»­å‡ºç°ä¸‰æ ¹é˜´Kçº¿, æ—¥çº¿çº§åˆ«), credit: zhihuæ™“æ™“ ç®±å‹æ•´ç†, credit: moneynet ä¸Šå‡æ¥”å½¢, support/ä¸‹çº¿å¡åº¦æ›´å¤§ ä¸‹é™æ¥”å½¢, resistance/ä¸Šçº¿å¡åº¦æ›´å¤§ æ•´ç†å½¢æ€: æœºæ„é€šè¿‡æ´—ç›˜5, ä¸€è¾¹æ’µèµ°äº†æ„å¿—ä¸åšå®šçš„æŠ•èµ„äºº, é‡æ–°åœ¨é«˜ä½å¼•è¿›äº†å¦ä¸€æ‰¹çœ‹å¥½åå¸‚çš„æŠ•èµ„äºº(æ¸…ç†å‡ºè·åˆ©ç­¹ç , å¼•è¿›é«˜æˆæœ¬éŸ­èœ) ä¸€è¾¹æ•™è‚²äº†ç»§ç»­æŒè‚¡çš„æŠ•èµ„äºº, ä¸è¦è½»æ˜“ä¹°å–è‚¡ç¥¨, é•¿æŠ±ä¸æ‡ˆæ‰èƒ½æŒ£å¤§é’± ä¸€è¾¹æ‘Šä½äº†è‡ªå·±çš„æŒä»“æˆæœ¬(é«˜å–ä½å¸) ä¸€çŸ³ä¸‰é¸Ÿ. è¿™æ ·æœºæ„æ‰èƒ½å¤Ÿåœ¨é«˜ä½ä»å®¹å‡ºé€ƒ æ³¨æ„ æŠ€æœ¯åˆ†æèƒ½åˆ¤æ–­è‚¡ä»·æ–¹å‘, ä¸èƒ½åæ˜ çœŸå®ä»·å€¼ æŠ€æœ¯åˆ†æèƒ½æé«˜èƒœç‡, ä½†ä¸æ˜¯100%ä¼šæˆåŠŸ å¸‚åœºææ…Œæ—¶, æŠ€æœ¯åˆ†æä¼šå¤±å»åˆ¤æ–­æ–¹å‘çš„èƒ½åŠ› æˆäº¤é‡ åœ¨ä¸€ä¸ªäº¤æ˜“æ—¥å½“ä¸­, è‹¥ä¸€åªä¸ªè‚¡çš„æˆäº¤é‡ä¸º150000è‚¡, åˆ™è¡¨ç¤ºä¹°æ–¹åœ¨å½“æ—¥å…±ä¹°è¿›äº†150000è‚¡, åŒæ—¶å–æ–¹ä¹Ÿå–å‡ºäº†150000è‚¡3 æˆäº¤é‡æ˜¯å¤šç©ºåŒæ–¹äº¤é”‹åŠ›åº¦çš„ä½“ç°. æˆäº¤é‡å¤§, è¯´æ˜å¤šç©ºåŒæ–¹äº¤é”‹è¾ƒä¸ºæ¿€çƒˆ, è¿™ä¸»è¦å‘ç”Ÿåœ¨ä»·æ ¼èµ°åŠ¿è¾ƒä¸ºæ¿€è¿›çš„æ—¶å€™, ä¾‹å¦‚å¿«é€Ÿçš„ä¸Šæ¶¨ã€å¿«é€Ÿçš„ä¸‹è·Œç­‰ æˆäº¤é‡å°, è¯´æ˜å¤šç©ºåŒæ–¹äº¤é”‹ç¼“å’Œ, è¿™ä¸»è¦å‘ç”Ÿåœ¨ä»·æ ¼èµ°åŠ¿è¾ƒä¸ºå¹³ç¼“ã€å¤šç©ºåŒæ–¹åˆ†æ­§ä¸å¤§çš„æ—¶å€™, ä¾‹å¦‚æ¨ªç›˜çš„çª„å¹…éœ‡è¡èµ°åŠ¿ æˆäº¤é‡å¯ä»¥æœ‰æ•ˆåœ°æ­ç¤ºä¸»åŠ›çš„å¸‚åœºè¡Œä¸ºå¹¶é¢„ç¤ºä»·æ ¼èµ°åŠ¿, è¿™å°±æ˜¯æ‰€è°“çš„é‡åœ¨ä»·å…ˆ. é‡åœ¨ä»·å…ˆæ˜¯æŒ‡ï¼šåœ¨ä»·æ ¼èµ°åŠ¿æœªè§æ˜æ˜¾å˜åŒ–çš„æƒ…å†µä¸‹, æˆäº¤é‡å¾€å¾€ä¼šæå‰å˜åŒ–, å¦‚æœæˆ‘ä»¬å¯ä»¥ç†è§£é‡èƒ½è¿™ç§å˜åŒ–çš„å¸‚åœºå«ä¹‰, å°±å¯ä»¥èµ°åœ¨å¸‚åœºçš„å‰é¢, ä»è€ŒæˆåŠŸåœ°å±•å¼€ä½ä¹°é«˜å–çš„æ“ä½œ é‡ä»·å…³ç³», credit: ç†Šå¸‚çŒæ‰‹ æ€»ä¹‹, ä¸Šå‡è¦é‡, ä¸‹è·Œæœªå¿…è¦é‡ æ³¢æµªç†è®º è‚¡ä»·æœ‰ä¸€ä¸ªã€äº”æ³¢ä¸Šå‡ã€ä¸‰æ³¢ä¸‹é™ã€çš„åŸºæœ¬è§„å¾‹, credit: cmoney 1,3,5å‡ 2,4,bå›è°ƒ a,cè·Œ Reference è‚¡ç¥¨æŠ€æœ¯é¢åˆ†æ ä¸­ç¹¼å‹æ…‹åœ–å½¢1ç®±å‹æ•´ç† æˆäº¤é‡ä¿¡å· æˆäº¤é‡ä¿¡å·2 æ•´ç†å½¢æ€</summary></entry><entry><title type="html">stock screening</title><link href="http://localhost:4000/2020/07/06/00_stock_screening.html" rel="alternate" type="text/html" title="stock screening" /><published>2020-07-06T00:00:00+08:00</published><updated>2020-07-06T00:00:00+08:00</updated><id>http://localhost:4000/2020/07/06/00_stock_screening</id><content type="html" xml:base="http://localhost:4000/2020/07/06/00_stock_screening.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;ä»Šå¤©æ€»ç»“ä¸€ä¸‹æœ€è¿‘å­¦åˆ°çš„é€‰è‚¡æµç¨‹,&lt;/p&gt;

&lt;p&gt;ä»‹ç»å…¶ä¸­çš„æŒ‡æ ‡å’Œç½‘ç«™,&lt;/p&gt;

&lt;h1 id=&quot;metric&quot;&gt;Metric&lt;/h1&gt;
&lt;h2 id=&quot;overview-1&quot;&gt;overview&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/86585827-9e112480-bfb9-11ea-8569-05ed33d34ecd.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;https://www.gurufocus.com/stock/fb&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;returns-ration&quot;&gt;returns ration&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/86586101-f7795380-bfb9-11ea-8622-1f8534f79232.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;https://www.cnbc.com/quotes/?symbol=fb&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;price-forecast&quot;&gt;price forecast&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/86586342-5212af80-bfba-11ea-9f3c-c85a44720e90.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;https://money.cnn.com/quote/forecast/forecast.html?symb=FB&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;peer-comparison&quot;&gt;peer comparison&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/86622438-768a7e00-bff2-11ea-83e8-3a744f90764b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;https://www.gurufocus.com/term/ev2ebitda/NAS:FB/EV-to-EBITDA/Facebook&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;financial-statement&quot;&gt;financial statement&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/86624720-65437080-bff6-11ea-8a6a-4249ad585f65.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;https://www.wsj.com/market-data/quotes/FB/financials&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="stock" /><summary type="html">Overview ä»Šå¤©æ€»ç»“ä¸€ä¸‹æœ€è¿‘å­¦åˆ°çš„é€‰è‚¡æµç¨‹, ä»‹ç»å…¶ä¸­çš„æŒ‡æ ‡å’Œç½‘ç«™, Metric overview https://www.gurufocus.com/stock/fb returns ration https://www.cnbc.com/quotes/?symbol=fb price forecast https://money.cnn.com/quote/forecast/forecast.html?symb=FB peer comparison https://www.gurufocus.com/term/ev2ebitda/NAS:FB/EV-to-EBITDA/Facebook financial statement https://www.wsj.com/market-data/quotes/FB/financials</summary></entry><entry><title type="html">apache kafkaå…³æ³¨ç‚¹</title><link href="http://localhost:4000/2020/06/23/00_kafka.html" rel="alternate" type="text/html" title="apache kafkaå…³æ³¨ç‚¹" /><published>2020-06-23T00:00:00+08:00</published><updated>2020-06-23T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/23/00_kafka</id><content type="html" xml:base="http://localhost:4000/2020/06/23/00_kafka.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;ä¸Šæ¬¡çš„mqçœ‹äº†pulsar, è¿™æ¬¡çœ‹çœ‹æ›´å¤šstartçš„kafka, å› ä¸ºç»„ä»¶ç›¸å¯¹å°‘(bookeeper), æ‰€ä»¥codeç›¸å¯¹æ›´å¤š(è‡ªå¤„ç†), å¦å¤–æ€»ä½“æ„Ÿè§‰source code(v2.5.0)æ¯”è¾ƒå¤æ‚. wrapäº†å¾ˆå¤šå±‚.&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system.exit()&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addShutdownHook()&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„draft, ä¹Ÿæ²¡æœ‰ç”»å›¾, ä¹‹åæœ‰æœºä¼šå†è¡¥å…….&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/85315953-84b6a580-b4ee-11ea-9fa5-5a8caf76b777.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;kafkaæ¶ˆæ¯ç”Ÿæˆæµç¨‹, credit: flykinghg&lt;sup&gt;1&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;startup&quot;&gt;startup&lt;/h1&gt;
&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaConfig&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NumPartitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LogDir&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/tmp/kafka-logs&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaServerStartable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;kafkaServerStartable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// çº¿ç¨‹æ± å·¥å‚, ScheduledThreadPoolExecutor&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kafkaScheduler&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaScheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kafkaScheduler&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaScheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;backgroundThreads&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// å…³äºrecord/logçš„å‘¨æœŸæ€§flushå’Œcleanup&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LogManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initialOfflineDirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zkClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;brokerState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kafkaScheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;brokerTopicStats&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logDirFailureChannel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;LogManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loadLogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loadLog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentLogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topicPartition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nio&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spi&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;package&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;// &lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Handles&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;connections&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;responses&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;broker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;socketServer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SocketServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;socketServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// äº‹åŠ¡&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;transactionCoordinator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TransactionCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;transactionCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// admin api&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaApis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaRequestHandlerPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// åŠ¨æ€é…ç½®ç›‘å¬å™¨&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dynamicConfigManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DynamicConfigManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zkClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dynamicConfigHandlers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ZooKeeperClientWatcher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;partitionsInitializing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topicPartition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// æ›´æ–°ä¸ºtrue(dirtyäº†), would reload later&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;shutdown&quot;&gt;shutdown&lt;/h1&gt;
&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// one thread&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;kafkaServerStartable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;shutdown&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shutdownLatch&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;shutdownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;countDown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// main thread&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// will hold until kafkaServerStartable.shutdown be called(shutdownLatch equal zero)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;kafkaServerStartable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;awaitShutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;awaitShutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shutdownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/85064830-bb36ac80-b1de-11ea-80c8-55cf88945b7a.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;client&quot;&gt;client&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/85231509-17414100-b42a-11ea-8f06-320b230eb834.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;producer&quot;&gt;producer&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/85257874-15fb2d00-b499-11ea-9948-583da0b66b75.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ProducerConfig&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// 0.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ConsoleProducer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProducerConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0. åˆå§‹åŒ–, å…³é”®ç‚¹KEY&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaProducer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;accumulator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RecordAccumulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ç´¯ç§¯å™¨&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Sender&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;accumulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// flushå™¨&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ioThread&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;KafkaThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ioThreadName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// å¼‚æ­¥flush&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProducerRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0.&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;doSend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0. get kafka cluster info/metadata&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;waitOnMetadata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;cluster&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;serializedKey&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;keySerializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;serializedValue&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;valueSerializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;partition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;allPartitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;partitionsForTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DefaultPartitioner&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// murmur2 % numPartitions&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RoundRobinPartitioner&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topicCounterMap.get(topic).incr() % numPartitions (ç±»ä¼¼random % numPartitions)&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UniformStickyPartitioner&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// pick by topic, then random then cache, similar to DefaultPartitioner but with topic cache picker&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TopicPartition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 0. å› ä¸ºæ˜¯batchæ¨¡å¼, æ‰€ä»¥æ¯æ¡æ–°äº§ç”Ÿçš„recordéƒ½ä¼šå…ˆç´¯ç§¯èµ·æ¥&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// è¿™é‡Œæ˜¯å¼‚æ­¥, æ¡¥æ¢æ˜¯**RecordAccumulator**, ä¸€äº›çº¿ç¨‹RecordAccumulator.batches.appendè´Ÿè´£ç´¯ç§¯, ä¸€äº›çº¿ç¨‹Sender.RecordAccumulator.flushè´Ÿè´£è½ç›˜.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ç´¯ç§¯&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;RecordAccumulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ProducerBatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;tryAppend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;appendDefaultRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DefaultRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;writeTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appendStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsetDelta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timestampDelta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nextSequentialOffset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;lastOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baseOffset&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;lastOffset&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lastOffset&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// flush&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;sendProduceRequests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;requestBuilder&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ProduceRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;forMagic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clientRequest&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newClientRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nodeId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clientRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;consumer&quot;&gt;consumer&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/85257801-fe23a900-b498-11ea-8e15-59533f34e4df.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ConsumerConfig&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;// 0.
ConsoleConsumer.main()
new ConsumerConfig(args)&lt;/p&gt;

&lt;p&gt;// 0. åˆå§‹åŒ–
new KafkaConsumer()&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;this.fetcher = new Fetcher()
new ConsumerWrapper(consumer) // mainly for its recordIter&lt;/li&gt;
  &lt;li&gt;consumerInit() // binding topic partition, and offset&lt;/li&gt;
  &lt;li&gt;this.subscriptions.assignFromUser(new HashSet&amp;lt;&amp;gt;(partitions))&lt;/li&gt;
  &lt;li&gt;this.subscriptions.seekUnvalidated(partition, newPosition); // è®¾å®šoffset&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;// 0. receive
msg = consumer.receive().poll()
records = pollForFetches()&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;fetcher.sendFetches(); // å‘é€requeståˆ°clusterå–æ•°, å¹¶å­˜æ”¾åˆ°buffer
    &lt;ul&gt;
      &lt;li&gt;this.completedFetches.CompletedFetch.batches.currentBatch.streamingIterator()&lt;/li&gt;
      &lt;li&gt;client.send(fetchTarget, request) // ç½‘ç»œ, async&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;fetcher.fetchedRecords()
    &lt;ul&gt;
      &lt;li&gt;records = fetchRecords(nextInLineFetch, recordsRemaining)&lt;/li&gt;
      &lt;li&gt;lastRecord = nextFetchedRecord()
        &lt;ul&gt;
          &lt;li&gt;records = currentBatch.streamingIterator(decompressionBufferSupplier)
            &lt;ul&gt;
              &lt;li&gt;DefaultRecordBatch() // ä»ä¹‹å‰çš„fetcher-bufferé‡Œé¢è¯»bytes
                &lt;ul&gt;
                  &lt;li&gt;buffer = this.buffer.duplicate()&lt;/li&gt;
                  &lt;li&gt;new RecordIterator()&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;record = records.next()&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;transaction&quot;&gt;transaction&lt;/h1&gt;
&lt;p&gt;from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ExactlyOnceMessageProcessor.java&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;initTransactions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;beginTransaction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;customizedRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sendOffsetsToTransaction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;consumer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;groupMetadata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;commitTransaction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;producer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;abortTransaction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;producer-client-send&quot;&gt;producer client send&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;producer.sendOffsetsToTransaction -&amp;gt;  new AddOffsetsToTxnHandler(new AddOffsetsToTxnRequest(&lt;strong&gt;ApiKeys.ADD_OFFSETS_TO_TXN&lt;/strong&gt;))&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;producer.commitTransaction  -&amp;gt; new EndTxnHandler(new EndTxnRequest(new EndTxnRequestData(id=commit, ApiKeys.END_TXN)))
    &lt;ul&gt;
      &lt;li&gt;new InitProducerIdHandler(new InitProducerIdRequest(ApiKeys.INIT_PRODUCER_ID))&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;producer.commitTransaction  -&amp;gt; new EndTxnHandler(new EndTxnRequest(new EndTxnRequestData(id=abort, ApiKeys.END_TXN)))
    &lt;ul&gt;
      &lt;li&gt;new InitProducerIdHandler(new InitProducerIdRequest(ApiKeys.INIT_PRODUCER_ID))&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pendingRequests&lt;/code&gt;æ¥æ²Ÿé€š.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;broker-server-receive&quot;&gt;broker server receive&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;case ApiKeys.ADD_OFFSETS_TO_TXN =&amp;gt; handleAddOffsetsToTxnRequest(request)&lt;/li&gt;
  &lt;li&gt;case ApiKeys.END_TXN =&amp;gt; handleEndTxnRequest(request)&lt;/li&gt;
  &lt;li&gt;case ApiKeys.INIT_PRODUCER_ID =&amp;gt; handleInitProducerIdRequest(request)&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;txnCoordinator.handleEndTransaction()
    &lt;ul&gt;
      &lt;li&gt;è¿™é‡Œä¹Ÿæ˜¯å¼‚æ­¥çš„, ä¸€ä¸ªsendResponseCallback()å°†callæ”¾åˆ°responseQueueé‡Œé¢, å†é€šè¿‡processNewResponses()æ¥å¤„ç†&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;preAppendResult
    &lt;ul&gt;
      &lt;li&gt;txnManager.getTransactionState(&lt;strong&gt;transactionalId&lt;/strong&gt;)&lt;/li&gt;
    &lt;/ul&gt;
    &lt;ul&gt;
      &lt;li&gt;txnMetadata.inLock { â€¦ }
        &lt;ul&gt;
          &lt;li&gt;Left(Errors.CONCURRENT_TRANSACTIONS) // åŒä¸€ä¸ª(transactionalId, partitionId)ä¸‹é¢çš„transactionä¸èƒ½å¹¶è¡Œ&lt;/li&gt;
          &lt;li&gt;Ongoing
            &lt;ul&gt;
              &lt;li&gt;PrepareCommit&lt;/li&gt;
              &lt;li&gt;PrepareAbort&lt;/li&gt;
              &lt;li&gt;txnMetadata.prepareAbortOrCommit(nextState, time.milliseconds())&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;CompleteCommit&lt;/li&gt;
      &lt;li&gt;CompleteAbort&lt;/li&gt;
      &lt;li&gt;PrepareCommit&lt;/li&gt;
      &lt;li&gt;PrepareAbort&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;txnManager.appendTransactionToLog()
    &lt;ul&gt;
      &lt;li&gt;sendTxnMarkersCallback()&lt;/li&gt;
    &lt;/ul&gt;
    &lt;ul&gt;
      &lt;li&gt;PrepareCommit&lt;/li&gt;
      &lt;li&gt;PrepareAbort&lt;/li&gt;
      &lt;li&gt;txnMetadata.prepareComplete()
      - replicaManager.appendRecords()
 -updateCacheCallback()
        &lt;ul&gt;
          &lt;li&gt;metadata.completeTransitionTo(newMetadata)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“è¦commitæœªå®Œå…¨æäº¤, å°±è¿˜æœ‰åŠæ³•abort, è€Œè¿™ä¸ªabortæ˜¯é€šè¿‡åŒä¸€ä¸ªtransactionalIdæ¥æ²Ÿé€š, å³ä¹‹å‰æ˜¯commit, ç°åœ¨å˜æ›´ä¸ºabort, è€Œè¿™ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;txnManager.getTransactionState(transactionalId)&lt;/code&gt;æ‰€å¯¹åº”çš„çŠ¶æ€ä¹Ÿè¦éšä¹‹è€Œæ”¹å˜. ä¾‹å¦‚æ¸…ç©ºæ‰€æœ‰ä¹‹å‰commit pending, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if (nextState == PrepareAbort &amp;amp;&amp;amp; txnMetadata.pendingState.contains(PrepareEpochFence)) {...}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;what-can-i-learn-from-this-project&quot;&gt;what can i learn from this project&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;å…ˆnewç±», ç„¶åè°ƒç”¨ç±»æ–¹æ³•. è¿™æ ·ç±»æ–¹æ³•é‡Œé¢å°±å¯ä»¥ç›´æ¥ç”¨newç±»çš„å‚æ•°
    &lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;tokenManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DelegationTokenManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenCache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zkClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;tokenManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;å¯ä»¥é€šè¿‡interface/abstract classæ¥å¿«é€ŸæŸ¥çœ‹architect/component&lt;/li&gt;
  &lt;li&gt;ä»returnå¾€å›æ‰¾å…¶äº§ç”Ÿè¿‡ç¨‹/è°ƒç”¨é“¾&lt;/li&gt;
  &lt;li&gt;å½“ä¸æ˜¯å¾ˆæ¸…æ¥šsource codeæŸäº›é€»è¾‘æ—¶, å¯ä»¥é€šè¿‡Googleæ‰¾æ‰¾çµæ„Ÿ&lt;sup&gt;3&lt;/sup&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;referene&quot;&gt;Referene&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/flykinghg/article/details/100777641&quot;&gt;kafkaç”Ÿäº§è€…çš„è“„æ°´æ± æœºåˆ¶&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://chenfh5.github.io/2020/06/14/00_pulsar.html&quot;&gt;apache pulsarå…³æ³¨ç‚¹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhmin.github.io/2019/05/20/kafka-transaction/&quot;&gt;Kafka äº‹åŠ¡å®ç°åŸç†&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="source-code" /><category term="kafka" /><summary type="html">Overview ä¸Šæ¬¡çš„mqçœ‹äº†pulsar, è¿™æ¬¡çœ‹çœ‹æ›´å¤šstartçš„kafka, å› ä¸ºç»„ä»¶ç›¸å¯¹å°‘(bookeeper), æ‰€ä»¥codeç›¸å¯¹æ›´å¤š(è‡ªå¤„ç†), å¦å¤–æ€»ä½“æ„Ÿè§‰source code(v2.5.0)æ¯”è¾ƒå¤æ‚. wrapäº†å¾ˆå¤šå±‚. æ¯”å¦‚system.exit()å’ŒaddShutdownHook() è¿™æ˜¯ä¸€ä¸ªç®€å•çš„draft, ä¹Ÿæ²¡æœ‰ç”»å›¾, ä¹‹åæœ‰æœºä¼šå†è¡¥å……. kafkaæ¶ˆæ¯ç”Ÿæˆæµç¨‹, credit: flykinghg1 startup args new KafkaConfig - val NumPartitions = 1 - val LogDir = &quot;/tmp/kafka-logs&quot; new KafkaServerStartable() kafkaServerStartable.startup() ---- // çº¿ç¨‹æ± å·¥å‚, ScheduledThreadPoolExecutor kafkaScheduler = new KafkaScheduler() kafkaScheduler = new KafkaScheduler(config.backgroundThreads) // å…³äºrecord/logçš„å‘¨æœŸæ€§flushå’Œcleanup logManager = LogManager(config, initialOfflineDirs, zkClient, brokerState, kafkaScheduler, time, brokerTopicStats, logDirFailureChannel) LogManager -&amp;gt; loadLogs() -&amp;gt; loadLog() -&amp;gt; this.currentLogs.put(topicPartition, log) java nio file spi api package // Handles new connections, requests and responses to and from broker. socketServer = new SocketServer( socketServer.startup() // äº‹åŠ¡ transactionCoordinator = TransactionCoordinator() transactionCoordinator.startup() // admin api new KafkaApis() new KafkaRequestHandlerPool() // åŠ¨æ€é…ç½®ç›‘å¬å™¨ dynamicConfigManager = new DynamicConfigManager(zkClient, dynamicConfigHandlers) ZooKeeperClientWatcher() partitionsInitializing.replace(topicPartition, false, true) // æ›´æ–°ä¸ºtrue(dirtyäº†), would reload later shutdown // one thread kafkaServerStartable.shutdown (private var shutdownLatch = new CountDownLatch(1)) def shutdown(): Unit = {} shutdownLatch.countDown() // main thread // will hold until kafkaServerStartable.shutdown be called(shutdownLatch equal zero) kafkaServerStartable.awaitShutdown() def awaitShutdown(): Unit = shutdownLatch.await() client producer ProducerConfig // 0. ConsoleProducer.main() new ProducerConfig(args) // 0. åˆå§‹åŒ–, å…³é”®ç‚¹KEY new KafkaProducer() - this.accumulator = new RecordAccumulator() // ç´¯ç§¯å™¨ - this.sender = new Sender(this.accumulator) // flushå™¨ - this.ioThread = new KafkaThread(ioThreadName, this.sender).start() // å¼‚æ­¥flush // 0. new ProducerRecord(topic, msg.getBytes) // 0. send(producer, record).doSend() // 0. get kafka cluster info/metadata cluster = waitOnMetadata().cluster serializedKey = keySerializer.serialize(record.topic(), record.headers(), record.key()) serializedValue = valueSerializer.serialize(record.topic(), record.headers(), record.value()) if (partition == null){ partition = partition(record, serializedKey, serializedValue, cluster) } else{ allPartitions = cluster.partitionsForTopic(topic) 1. DefaultPartitioner // murmur2 % numPartitions 2. RoundRobinPartitioner // topicCounterMap.get(topic).incr() % numPartitions (ç±»ä¼¼random % numPartitions) 3. UniformStickyPartitioner // pick by topic, then random then cache, similar to DefaultPartitioner but with topic cache picker } // 0. tp = new TopicPartition(record.topic(), partition) // 0. å› ä¸ºæ˜¯batchæ¨¡å¼, æ‰€ä»¥æ¯æ¡æ–°äº§ç”Ÿçš„recordéƒ½ä¼šå…ˆç´¯ç§¯èµ·æ¥ // è¿™é‡Œæ˜¯å¼‚æ­¥, æ¡¥æ¢æ˜¯**RecordAccumulator**, ä¸€äº›çº¿ç¨‹RecordAccumulator.batches.appendè´Ÿè´£ç´¯ç§¯, ä¸€äº›çº¿ç¨‹Sender.RecordAccumulator.flushè´Ÿè´£è½ç›˜. // ç´¯ç§¯ result = RecordAccumulator.append(tp, serializedKey, serializedValue) ProducerBatch(tp).tryAppend(key, value) appendDefaultRecord(offset, timestamp, key, value, headers) DefaultRecord.writeTo(appendStream, offsetDelta, timestampDelta, key, value, headers) offset = nextSequentialOffset(): Long{ lastOffset == null ? baseOffset : lastOffset + 1 } lastOffset = offset; // flush sendProduceRequests(batches, now) requestBuilder = ProduceRequest.Builder.forMagic() clientRequest = client.newClientRequest(nodeId, requestBuilder) client.send(clientRequest, now) consumer ConsumerConfig // 0. ConsoleConsumer.main() new ConsumerConfig(args) // 0. åˆå§‹åŒ– new KafkaConsumer() this.fetcher = new Fetcher() new ConsumerWrapper(consumer) // mainly for its recordIter consumerInit() // binding topic partition, and offset this.subscriptions.assignFromUser(new HashSet&amp;lt;&amp;gt;(partitions)) this.subscriptions.seekUnvalidated(partition, newPosition); // è®¾å®šoffset // 0. receive msg = consumer.receive().poll() records = pollForFetches() fetcher.sendFetches(); // å‘é€requeståˆ°clusterå–æ•°, å¹¶å­˜æ”¾åˆ°buffer this.completedFetches.CompletedFetch.batches.currentBatch.streamingIterator() client.send(fetchTarget, request) // ç½‘ç»œ, async fetcher.fetchedRecords() records = fetchRecords(nextInLineFetch, recordsRemaining) lastRecord = nextFetchedRecord() records = currentBatch.streamingIterator(decompressionBufferSupplier) DefaultRecordBatch() // ä»ä¹‹å‰çš„fetcher-bufferé‡Œé¢è¯»bytes buffer = this.buffer.duplicate() new RecordIterator() record = records.next() transaction from ExactlyOnceMessageProcessor.java producer.initTransactions() try { producer.beginTransaction() for() { producer.send(customizedRecord) } producer.sendOffsetsToTransaction(offsets, consumer.groupMetadata()) producer.commitTransaction() } catch { producer.abortTransaction() } producer client send producer.sendOffsetsToTransaction -&amp;gt; new AddOffsetsToTxnHandler(new AddOffsetsToTxnRequest(ApiKeys.ADD_OFFSETS_TO_TXN)) producer.commitTransaction -&amp;gt; new EndTxnHandler(new EndTxnRequest(new EndTxnRequestData(id=commit, ApiKeys.END_TXN))) new InitProducerIdHandler(new InitProducerIdRequest(ApiKeys.INIT_PRODUCER_ID)) producer.commitTransaction -&amp;gt; new EndTxnHandler(new EndTxnRequest(new EndTxnRequestData(id=abort, ApiKeys.END_TXN))) new InitProducerIdHandler(new InitProducerIdRequest(ApiKeys.INIT_PRODUCER_ID)) é€šè¿‡pendingRequestsæ¥æ²Ÿé€š. broker server receive case ApiKeys.ADD_OFFSETS_TO_TXN =&amp;gt; handleAddOffsetsToTxnRequest(request) case ApiKeys.END_TXN =&amp;gt; handleEndTxnRequest(request) case ApiKeys.INIT_PRODUCER_ID =&amp;gt; handleInitProducerIdRequest(request) txnCoordinator.handleEndTransaction() è¿™é‡Œä¹Ÿæ˜¯å¼‚æ­¥çš„, ä¸€ä¸ªsendResponseCallback()å°†callæ”¾åˆ°responseQueueé‡Œé¢, å†é€šè¿‡processNewResponses()æ¥å¤„ç† preAppendResult txnManager.getTransactionState(transactionalId) txnMetadata.inLock { â€¦ } Left(Errors.CONCURRENT_TRANSACTIONS) // åŒä¸€ä¸ª(transactionalId, partitionId)ä¸‹é¢çš„transactionä¸èƒ½å¹¶è¡Œ Ongoing PrepareCommit PrepareAbort txnMetadata.prepareAbortOrCommit(nextState, time.milliseconds()) CompleteCommit CompleteAbort PrepareCommit PrepareAbort txnManager.appendTransactionToLog() sendTxnMarkersCallback() PrepareCommit PrepareAbort txnMetadata.prepareComplete() - replicaManager.appendRecords() -updateCacheCallback() metadata.completeTransitionTo(newMetadata) å½“è¦commitæœªå®Œå…¨æäº¤, å°±è¿˜æœ‰åŠæ³•abort, è€Œè¿™ä¸ªabortæ˜¯é€šè¿‡åŒä¸€ä¸ªtransactionalIdæ¥æ²Ÿé€š, å³ä¹‹å‰æ˜¯commit, ç°åœ¨å˜æ›´ä¸ºabort, è€Œè¿™ä¸ªtxnManager.getTransactionState(transactionalId)æ‰€å¯¹åº”çš„çŠ¶æ€ä¹Ÿè¦éšä¹‹è€Œæ”¹å˜. ä¾‹å¦‚æ¸…ç©ºæ‰€æœ‰ä¹‹å‰commit pending, if (nextState == PrepareAbort &amp;amp;&amp;amp; txnMetadata.pendingState.contains(PrepareEpochFence)) {...} what can i learn from this project å…ˆnewç±», ç„¶åè°ƒç”¨ç±»æ–¹æ³•. è¿™æ ·ç±»æ–¹æ³•é‡Œé¢å°±å¯ä»¥ç›´æ¥ç”¨newç±»çš„å‚æ•° tokenManager = new DelegationTokenManager(config, tokenCache, time , zkClient) tokenManager.startup() å¯ä»¥é€šè¿‡interface/abstract classæ¥å¿«é€ŸæŸ¥çœ‹architect/component ä»returnå¾€å›æ‰¾å…¶äº§ç”Ÿè¿‡ç¨‹/è°ƒç”¨é“¾ å½“ä¸æ˜¯å¾ˆæ¸…æ¥šsource codeæŸäº›é€»è¾‘æ—¶, å¯ä»¥é€šè¿‡Googleæ‰¾æ‰¾çµæ„Ÿ3 Referene kafkaç”Ÿäº§è€…çš„è“„æ°´æ± æœºåˆ¶ apache pulsarå…³æ³¨ç‚¹ Kafka äº‹åŠ¡å®ç°åŸç†</summary></entry><entry><title type="html">eaten japanese buffets in singapore</title><link href="http://localhost:4000/2020/06/21/00_sg-japanese-buffet.html" rel="alternate" type="text/html" title="eaten japanese buffets in singapore" /><published>2020-06-21T00:00:00+08:00</published><updated>2020-06-21T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/21/00_sg-japanese-buffet</id><content type="html" xml:base="http://localhost:4000/2020/06/21/00_sg-japanese-buffet.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;æ„Ÿè§‰japanæ˜¯ä¸€ä¸ªæ¯”è¾ƒclean, politeçš„åœ°æ–¹, å½“ç„¶å…¶ä¸­çš„foodä¹Ÿæ˜¯å¾ˆç²¾è‡´, å…¶ä¸­æ¯”è¾ƒå–œæ¬¢çš„æ˜¯&lt;a href=&quot;https://en.wikipedia.org/wiki/Sashimi&quot;&gt;sashimi&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;è™½ç„¶å¹³æ—¶ä¹Ÿä¼šåˆ°japan restaurantå•ç‚¹ala carte, ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰åˆ°buffetåƒçš„å¼€, ç‰¹åˆ«æ˜¯è¿åŠ¨è¿‡åçš„ä¸‹ä¸€é¤.&lt;/p&gt;

&lt;p&gt;å³ä¾¿æˆ‘çš„å‘³è•¾å¾ˆå·®, åƒä¸å‡ºæ¥ç»†è…»çš„å‘³é“, ä½†æ˜¯é²œç¾åº”è¯¥è¿˜æ˜¯å¯ä»¥tasteåˆ°å§? é¤å…ç¯å¢ƒ, é£Ÿç‰©æ•´æ´ä¹Ÿæ˜¯å¾ˆé‡è¦çš„å‚è€ƒ.&lt;/p&gt;

&lt;h1 id=&quot;singapore-buffet&quot;&gt;singapore buffet&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;restaurant&lt;/th&gt;
      &lt;th&gt;fee(S$)&lt;/th&gt;
      &lt;th&gt;remark&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.facebook.com/kisekirestaurant/&quot;&gt;kiseki&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;22.8 ~ 39.8&lt;/td&gt;
      &lt;td&gt;5æ¥¼?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.facebook.com/shinminori/&quot;&gt;shin minori&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;53.9&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.facebook.com/kushidining/&quot;&gt;kushi&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;38.8 ~ 69.8&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.facebook.com/eatmitsuba/&quot;&gt;mitsuba&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;41.9&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.facebook.com/ikoijapaneserestaurant/&quot;&gt;ikoi&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;38.0&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;referene&quot;&gt;Referene&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://sethlui.com/best-japanese-buffets-singapore/&quot;&gt;14 Best Japanese Buffets in Singapore For Your Sashimi Fix&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://eatbook.sg/japanese-buffet/&quot;&gt;15 Japanese Buffets In Singapore From $18.90++ For Unlimited Sashimi And Wagyu&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="food" /><summary type="html">Overview æ„Ÿè§‰japanæ˜¯ä¸€ä¸ªæ¯”è¾ƒclean, politeçš„åœ°æ–¹, å½“ç„¶å…¶ä¸­çš„foodä¹Ÿæ˜¯å¾ˆç²¾è‡´, å…¶ä¸­æ¯”è¾ƒå–œæ¬¢çš„æ˜¯sashimi. è™½ç„¶å¹³æ—¶ä¹Ÿä¼šåˆ°japan restaurantå•ç‚¹ala carte, ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰åˆ°buffetåƒçš„å¼€, ç‰¹åˆ«æ˜¯è¿åŠ¨è¿‡åçš„ä¸‹ä¸€é¤. å³ä¾¿æˆ‘çš„å‘³è•¾å¾ˆå·®, åƒä¸å‡ºæ¥ç»†è…»çš„å‘³é“, ä½†æ˜¯é²œç¾åº”è¯¥è¿˜æ˜¯å¯ä»¥tasteåˆ°å§? é¤å…ç¯å¢ƒ, é£Ÿç‰©æ•´æ´ä¹Ÿæ˜¯å¾ˆé‡è¦çš„å‚è€ƒ. singapore buffet restaurant fee(S$) remark kiseki 22.8 ~ 39.8 5æ¥¼? shin minori 53.9 - kushi 38.8 ~ 69.8 - mitsuba 41.9 - ikoi 38.0 - Referene 14 Best Japanese Buffets in Singapore For Your Sashimi Fix 15 Japanese Buffets In Singapore From $18.90++ For Unlimited Sashimi And Wagyu</summary></entry><entry><title type="html">apache pulsarå…³æ³¨ç‚¹</title><link href="http://localhost:4000/2020/06/14/00_pulsar.html" rel="alternate" type="text/html" title="apache pulsarå…³æ³¨ç‚¹" /><published>2020-06-14T00:00:00+08:00</published><updated>2020-06-14T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/14/00_pulsar</id><content type="html" xml:base="http://localhost:4000/2020/06/14/00_pulsar.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çœ‹åˆ°mqè¿™å—, kafkaå¾ˆç«(star 16k), è€Œä¸”èå…¥äº†scala. é‚£ä¹ˆå¸‚åœºä¸Šå…¶alternative apache pulsarè¡¨ç°å¦‚ä½•? æ‰€ä»¥clone(v2.5.2)ä¸‹æ¥ç²—ç•¥çœ‹äº†çœ‹, ä¸‹é¢æ˜¯ä¸ªäººå¯¹å…¶çš„å…³æ³¨ç‚¹&lt;/p&gt;

&lt;h1 id=&quot;architect&quot;&gt;Architect&lt;/h1&gt;
&lt;h2 id=&quot;cluster-level&quot;&gt;cluster level&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªpulsar clusterç”±ä»¥ä¸‹ç»„ä»¶æ„æˆ, 
&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84564993-ac906580-ad98-11ea-83c9-65081cae3de1.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;pulsar cluster, credit: apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;brokeræ˜¯ä¸­é—´å±‚&lt;/li&gt;
  &lt;li&gt;zkæ˜¯æœåŠ¡å‘ç°, é€‰ä¸»å’Œé›†ä¸­é…ç½®&lt;/li&gt;
  &lt;li&gt;bookKeeperæ˜¯æŒä¹…åŒ–å±‚
    &lt;ul&gt;
      &lt;li&gt;quorum replicaæœºåˆ¶, brokeré€šè¿‡BK clientå¹¶å‘å‘é€å†™æ“ä½œåˆ°Nä¸ªbookies(å‰¯æœ¬), ç„¶åç­‰å¾…ç›¸å…³bookiesè¿”å›quorum ack, æ¥ç€è¿”å›ackç»™producer, å¹¶æŠ•é€’è¯¥msgç»™consumer&lt;sup&gt;2&lt;/sup&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç±»ä¼¼&lt;a href=&quot;https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/Federation.html&quot;&gt;hdfs federation&lt;/a&gt;æˆ–è€…&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/master/modules-cross-cluster-search.html&quot;&gt;elasticsearch cross-cluster&lt;/a&gt;, é€šè¿‡global zkæ¥å…³è”2ä¸ªä¸åŒcluster, å®ç°äº†æ•°æ®çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å¼‚åœ°geo/å¼‚é›†ç¾¤&lt;/code&gt;çš„&lt;strong&gt;ä¼ è¾“/å¤‡ä»½&lt;a href=&quot;http://pulsar.apache.org/docs/en/administration-geo/&quot;&gt;replica&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;instance-level&quot;&gt;instance level&lt;/h2&gt;
&lt;p&gt;å•ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pulsarå®ä¾‹&lt;/code&gt;ç”±ä¸€ä¸ªæˆ–å¤šä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pulsaré›†ç¾¤&lt;/code&gt;ç»„æˆ. å®ä¾‹ä¸­çš„é›†ç¾¤ä¹‹é—´å¯ä»¥ç›¸äº’å¤åˆ¶æ•°æ®
&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/82873501-2e922900-9f67-11ea-9b61-9763816dde54.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;pulsar instance, credit: tibco&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84565596-bddb7100-ad9c-11ea-885d-144efe313121.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;pulsar instance - é€šè¿‡geo replica, consumer C1å’ŒC2å°±å¯ä»¥æ¶ˆè´¹åˆ°producer P3çš„send msg, å› ä¸ºcluster ABCéƒ½æ˜¯shareåŒä¸€ä¸ªtopicå³T1, credit: apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;broker&quot;&gt;broker&lt;/h1&gt;
&lt;p&gt;brokerç›¸å½“äº&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#coordinating-node&quot;&gt;es coordinator&lt;/a&gt;, ä½œä¸ºä¸€ä¸ªä¸­é—´å±‚, èµ·æ‰¿è½¬åˆ&lt;/p&gt;

&lt;p&gt;brokeræœ¬èº«æ˜¯æ— çŠ¶æ€çš„, æ‰€ä»¥å¯ä»¥å¾ˆå¥½çš„æ°´å¹³æ‰©å±•scaling,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;æä¾›topicæœåŠ¡&lt;/li&gt;
  &lt;li&gt;å¤„ç†messageä¼ è¾“&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/82834671-601ddc80-9ef4-11ea-9586-643322d92022.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;client&quot;&gt;client&lt;/h1&gt;
&lt;p&gt;Pulsaræ¨å‡ºäº†æ”¯æŒJava, Go, Pythonå’ŒC++çš„å®¢æˆ·ç«¯API&lt;/p&gt;

&lt;p&gt;PuslarAPIå°è£…äº†å®¢æˆ·ç«¯åˆ°brokerç«¯çš„é€šä¿¡åè®®, æš´éœ²å‡ºä¸€å¥—APIä¾›åº”ç”¨ç¨‹åºä½¿ç”¨&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/82834937-213c5680-9ef5-11ea-994d-c0def45a0ba8.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç‹¬ç«‹clientåªæ˜¯å…¶ä¸­ä¸€ä¸ªæ“ä½œpulsar instance/clusterçš„æ–¹å¼, è¿˜æœ‰å¦å¤–çš„&lt;a href=&quot;http://pulsar.apache.org/docs/en/admin-api-overview/&quot;&gt;2ç§æ–¹å¼&lt;/a&gt;,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;admin REST api
    &lt;ul&gt;
      &lt;li&gt;e.g., &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;curl http://localhost:9092/admin/v2/persistent/{tenant}/{namespace}&lt;/code&gt;, ç±»ä¼¼esçš„curl&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;pulsar-admin CLI
    &lt;ul&gt;
      &lt;li&gt;e.g., &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh bin/pulsar-admin topics list tenant/cluster/namespace&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;broker-service-discovery&quot;&gt;broker service discovery&lt;/h1&gt;
&lt;p&gt;clientè¦ä¸bookieè¿›è¡Œäº¤äº’(index or query)éƒ½éœ€è¦ç»è¿‡broker&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæ¨¡å—å°±æä¾›ä¸€ä¸ªhttp server(jetty), ç”¨äºclientå‘é€httpæ¥round-robin zkä¸Šå­˜ç€çš„å¯ç”¨brokers&lt;/p&gt;

&lt;p&gt;å¯ç”¨brokersä¸http serverä¹‹é—´çš„é€šä¿¡æ¡¥æ¢æ˜¯zk, å³confé…ç½®&lt;/p&gt;

&lt;p&gt;It keeps list of active available brokers and redirects all incoming requests to one of the broker in round-robin manner&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zookeeperServers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInitParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zookeeperServers&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83443974-3da03c00-a47d-11ea-85ae-79c6daddce75.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;functions&quot;&gt;functions&lt;/h1&gt;
&lt;p&gt;ç±»ä¼¼ä¸€ä¸ªå°å‹flink/spark/MRæ¡†æ¶, å¯ä»¥éƒ¨ç½²åˆ°ç°æœ‰çš„brokerä¸Š(å®ç°å¤ç”¨)&lt;/p&gt;

&lt;p&gt;æœ‰ä¸€ä¸ªdashboard, ä½†æ˜¯UIè‚¯å®šæ²¡æœ‰sparké‚£ä¹ˆä¸°å¯Œ, å¯ä»¥çœ‹åˆ°lineage DAG, resource&lt;/p&gt;

&lt;p&gt;ä¸è¿‡å¯¹äºsimpleåº”ç”¨(map, flatMap)ç­‰, å°±å¯ä»¥æ¯”è¾ƒå¿«é€Ÿç®€å•å®ç°, ä¸ç”¨å¼•å…¥3rd party&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84366257-27287c00-ac05-11ea-8591-b4a92d9d3be3.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;io&quot;&gt;IO&lt;/h1&gt;
&lt;p&gt;å¤–éƒ¨ç»„ä»¶ä½œä¸ºsource/sinkä¸pulsarçš„è¿æ¥&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84407047-e51b2c80-ac3c-11ea-87b9-c6465d831f98.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;io connector, credit: apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84417445-35e45280-ac48-11ea-9630-2149944f7cdc.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;3ç±»&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;processing guarantee&lt;/code&gt;,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;at-most-once&lt;/li&gt;
  &lt;li&gt;at-least-once&lt;/li&gt;
  &lt;li&gt;effectively-once&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84420343-7b0a8380-ac4c-11ea-96b0-7700838783d5.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;processing guarantee&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;transaction&quot;&gt;transaction&lt;/h1&gt;
&lt;p&gt;base on &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html#thenCompose-java.util.function.Function-&quot;&gt;CompletableFuture thenCompose&lt;/a&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84506649-418c5380-acf2-11ea-8234-6b0814538465.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;sql&quot;&gt;SQL&lt;/h1&gt;
&lt;p&gt;base on &lt;a href=&quot;https://github.com/prestodb/presto&quot;&gt;presto&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;éœ€è¦å•ç‹¬èµ·sql-worker, å³è¿è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh ${PRESTO_HOME}/bin/launcher run&lt;/code&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84541769-95b32a00-ad2a-11ea-8459-480b27f2b6b3.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;bootstrap&quot;&gt;bootstrap&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨standalone&lt;a href=&quot;https://pulsar.apache.org/docs/en/standalone/#start-pulsar-standalone&quot;&gt;æ¨¡å¼&lt;/a&gt;æ¥è¿‡ä¸€éå¯åŠ¨æ—¶ä¼šç»å†å“ªäº›çŠ¶æ€,&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84541978-12460880-ad2b-11ea-961c-85717a72d795.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;create pulsarConfiguration include zk
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;conf/standalone.conf&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;broker
    &lt;ul&gt;
      &lt;li&gt;zk&lt;/li&gt;
      &lt;li&gt;bookKeeper&lt;/li&gt;
      &lt;li&gt;loadManager(ResourceUnit)&lt;/li&gt;
      &lt;li&gt;webService(admin REST api)&lt;/li&gt;
      &lt;li&gt;startLeaderElectionService(zk-Watcher-notify-recursively)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;create nameSpace for tenant&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;performance-benchmark&quot;&gt;performance benchmark&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬ä»ä»¥ä¸‹2ä¸ªæ–¹é¢å…¥æ‰‹é€‰æ‹©é€‚åˆä¸šåŠ¡ç³»ç»Ÿçš„messaging system/streaming platform,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;latency: å›ºå®šé‡(size-mb)çš„æ•°æ®ä»ç”Ÿäº§åˆ°è¢«æ¶ˆè´¹ç¡®è®¤æ‰€éœ€çš„æ—¶é—´(time-sec)&lt;/li&gt;
  &lt;li&gt;throughput: å•ä½æ—¶é—´(time-sec)å†…æœ€å¤§çš„æ•°æ®å‘é€/æ¥æ”¶é‡(size-mb)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;latency&quot;&gt;latency&lt;/h2&gt;
&lt;p&gt;kafkaesque&lt;sup&gt;3&lt;/sup&gt;åœ¨2019å¹´ä»ä»¥ä¸‹æ–¹é¢è¯¦ç»†ç»™å‡ºäº†å…³äºlatencyçš„benchmark,&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;project&lt;/th&gt;
      &lt;th&gt;sub-item&lt;/th&gt;
      &lt;th&gt;remark&lt;/th&gt;
      &lt;th&gt;kafka&lt;/th&gt;
      &lt;th&gt;pulsar&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;latency&lt;/td&gt;
      &lt;td&gt;publishing latency&lt;/td&gt;
      &lt;td&gt;æ¶ˆæ¯å‘é€åˆ°è¢«messaging system ackçš„æ—¶é—´&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;end-to-end latency&lt;/td&gt;
      &lt;td&gt;æ¶ˆæ¯å‘é€åˆ°è¢«consumer ackçš„æ—¶é—´&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;durability&lt;/td&gt;
      &lt;td&gt;enable&lt;/td&gt;
      &lt;td&gt;å¼€å¯å†™ç£ç›˜(flush)çš„æŒä¹…åŒ–&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;disable&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;replication&lt;/td&gt;
      &lt;td&gt;enable&lt;/td&gt;
      &lt;td&gt;å¤šæ•°æ®å‰¯æœ¬&lt;/td&gt;
      &lt;td&gt;x(leader-follower)&lt;/td&gt;
      &lt;td&gt;y(bookKeeper quorum)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;disable&lt;/td&gt;
      &lt;td&gt;é›¶å‰¯æœ¬&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;workloads partition&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;åˆ†åŒºæ•°&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;y&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ä»æŠ¥å‘Šæ¥çœ‹, å°ç»“å¦‚ä¸‹,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;åœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;end-to-end&lt;/code&gt; latency, kafkaå»¶è¿Ÿæ›´ä½; ä½†pulsaræ–¹å·®æ›´å°(smooth)&lt;/li&gt;
  &lt;li&gt;åœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;publishing&lt;/code&gt; latency, pulsarå»¶è¿Ÿæ›´ä½ä¸”æ›´smooth&lt;/li&gt;
  &lt;li&gt;ç›¸æ¯”å•åˆ†åŒº, åœ¨å¢åŠ åˆ†åŒºpartitionæ—¶, pulsarè¡¨ç°å‡ºå»¶è¿Ÿæ›´ä½; è€Œkafkaåˆ™ç›¸åå…¶å¤šåˆ†åŒºå»¶è¿Ÿæ¯”å•åˆ†åŒºæ›´é«˜&lt;/li&gt;
  &lt;li&gt;åœ¨å¼€å¯durabilityçš„æƒ…å†µä¸‹, pulsarå»¶è¿Ÿæ›´ä½&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½†æ˜¯&lt;a href=&quot;http://disq.us/p/2452fkx&quot;&gt;è¯„è®ºåŒº&lt;/a&gt;ä¹Ÿæœ‰äººæŒ‡å‡ºåº”è¯¥ä½¿ç”¨&lt;strong&gt;å¤šbrokers&lt;/strong&gt;æ¥åšbenchmark, that make sense making benchmark workloads closer to PRD env&lt;/p&gt;

&lt;h2 id=&quot;throughput&quot;&gt;throughput&lt;/h2&gt;
&lt;p&gt;åœ¨2018å¹´ç»™å‡ºäº†pulsarååé‡æ›´é«˜çš„ç»“è®º&lt;sup&gt;2,4&lt;/sup&gt;, ä½†æ˜¯ä¹Ÿæœ‰æœ‰ä¸åŒè§‚ç‚¹&lt;sup&gt;5&lt;/sup&gt;&lt;/p&gt;

&lt;h1 id=&quot;more&quot;&gt;More&lt;/h1&gt;
&lt;p&gt;kafka - åœ¨æé«˜latencyæ–¹é¢, kafkaä¹Ÿæœ‰å¾€&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-250+Add+Support+for+Quorum-based+Producer+Acknowledgment&quot;&gt;quorumè½¬&lt;/a&gt;? ä½†æ˜¯å½“ä¸‹çš„åŸºäºprimary-backupå¯¹å®¹é”™æ”¯æŒæ›´å¥½&lt;sup&gt;6&lt;/sup&gt;. ä¸è¿‡kafkaè¶Šæ¥è¶Šç‹¬ç«‹&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-500%3A+Replace+ZooKeeper+with+a+Self-Managed+Metadata+Quorum&quot;&gt;è‡ªæˆç³»ç»Ÿ&lt;/a&gt;äº†&lt;/p&gt;

&lt;p&gt;pulsar - ç«™åœ¨äº†bookKeeperå’Œzkç­‰ç¬¬ä¸‰æ–¹æ¡†æ¶çš„è‚©è†€ä¸Š. ä½†æ˜¯ä¹Ÿå®ç°äº†å­˜å‚¨å’ŒæœåŠ¡åˆ†ç¦», scalingå¾ˆå¥½&lt;/p&gt;

&lt;p&gt;ä¸ªäººæ¯”è¾ƒå–œæ¬¢pulsarçš„åˆ†ç¦»è®¾è®¡, å¤§å¤§æé«˜äº†å¯æ‰©å±•æ€§, å¯ä»¥æ›´å¥½åœ°å¢åŠ partitionæ¥åº”å¯¹çªå‘æµé‡, è€Œä¸åƒkafkaé‚£æ ·éœ€è¦äººå·¥ä»‹å…¥rebalance/reassign&lt;sup&gt;7&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;å½“ç„¶å¯¹äºkafkaä¸»åŠ¨è„±ç¦»zkè€Œè‡ªç®¡ç†metadataä¹Ÿå¾ˆæœŸå¾…&lt;/p&gt;

&lt;h1 id=&quot;referene&quot;&gt;Referene&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://pulsar.apache.org/&quot;&gt;apache pulsar&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://myslide.cn/slides/10512&quot;&gt;Apache Pulsaråˆ†å±‚åˆ†ç‰‡æ¶æ„&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://kafkaesque.io/performance-comparison-between-apache-pulsar-and-kafka-latency/&quot;&gt;performance comparison between apache pulsar and kafka: latency&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://streamnative.io/success-stories/yahoo_japan/&quot;&gt;Apache Pulsar at Yahoo!JAPAN&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.confluent.io/kafka-vs-pulsar/&quot;&gt;Kafka vs. Pulsar vs. RabbitMQ: Performance, Architecture, and Features Compared&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://colobu.com/2017/11/02/kafka-replication/&quot;&gt;Kafkaçš„å¤åˆ¶æœºåˆ¶&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/piperck/p/12172752.html&quot;&gt;Kafkaè¿›è¡Œæœºå™¨æ‰©å®¹åçš„å‰¯æœ¬å†å¹³è¡¡å’Œä¸ºå·²æœ‰åˆ†åŒºå¢åŠ replicaå®è·µ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.tibco.com/sites/default/files/wiki_files/how_to_configure_apache_pulsar_cluster_georeplication.pdf&quot;&gt;How to Configure Apache Pulsar Cluster Geo Replication between Regions on AWS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://chenfh5.github.io/2020/06/23/00_kafka.html&quot;&gt;apache kafkaå…³æ³¨ç‚¹&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="source-code" /><category term="pulsar" /><summary type="html">Overview æœ€è¿‘çœ‹åˆ°mqè¿™å—, kafkaå¾ˆç«(star 16k), è€Œä¸”èå…¥äº†scala. é‚£ä¹ˆå¸‚åœºä¸Šå…¶alternative apache pulsarè¡¨ç°å¦‚ä½•? æ‰€ä»¥clone(v2.5.2)ä¸‹æ¥ç²—ç•¥çœ‹äº†çœ‹, ä¸‹é¢æ˜¯ä¸ªäººå¯¹å…¶çš„å…³æ³¨ç‚¹ Architect cluster level ä¸€ä¸ªpulsar clusterç”±ä»¥ä¸‹ç»„ä»¶æ„æˆ, pulsar cluster, credit: apache brokeræ˜¯ä¸­é—´å±‚ zkæ˜¯æœåŠ¡å‘ç°, é€‰ä¸»å’Œé›†ä¸­é…ç½® bookKeeperæ˜¯æŒä¹…åŒ–å±‚ quorum replicaæœºåˆ¶, brokeré€šè¿‡BK clientå¹¶å‘å‘é€å†™æ“ä½œåˆ°Nä¸ªbookies(å‰¯æœ¬), ç„¶åç­‰å¾…ç›¸å…³bookiesè¿”å›quorum ack, æ¥ç€è¿”å›ackç»™producer, å¹¶æŠ•é€’è¯¥msgç»™consumer2 ç±»ä¼¼hdfs federationæˆ–è€…elasticsearch cross-cluster, é€šè¿‡global zkæ¥å…³è”2ä¸ªä¸åŒcluster, å®ç°äº†æ•°æ®çš„å¼‚åœ°geo/å¼‚é›†ç¾¤çš„ä¼ è¾“/å¤‡ä»½replica instance level å•ä¸ªPulsarå®ä¾‹ç”±ä¸€ä¸ªæˆ–å¤šä¸ªPulsaré›†ç¾¤ç»„æˆ. å®ä¾‹ä¸­çš„é›†ç¾¤ä¹‹é—´å¯ä»¥ç›¸äº’å¤åˆ¶æ•°æ® pulsar instance, credit: tibco pulsar instance - é€šè¿‡geo replica, consumer C1å’ŒC2å°±å¯ä»¥æ¶ˆè´¹åˆ°producer P3çš„send msg, å› ä¸ºcluster ABCéƒ½æ˜¯shareåŒä¸€ä¸ªtopicå³T1, credit: apache broker brokerç›¸å½“äºes coordinator, ä½œä¸ºä¸€ä¸ªä¸­é—´å±‚, èµ·æ‰¿è½¬åˆ brokeræœ¬èº«æ˜¯æ— çŠ¶æ€çš„, æ‰€ä»¥å¯ä»¥å¾ˆå¥½çš„æ°´å¹³æ‰©å±•scaling, æä¾›topicæœåŠ¡ å¤„ç†messageä¼ è¾“ client Pulsaræ¨å‡ºäº†æ”¯æŒJava, Go, Pythonå’ŒC++çš„å®¢æˆ·ç«¯API PuslarAPIå°è£…äº†å®¢æˆ·ç«¯åˆ°brokerç«¯çš„é€šä¿¡åè®®, æš´éœ²å‡ºä¸€å¥—APIä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ ç‹¬ç«‹clientåªæ˜¯å…¶ä¸­ä¸€ä¸ªæ“ä½œpulsar instance/clusterçš„æ–¹å¼, è¿˜æœ‰å¦å¤–çš„2ç§æ–¹å¼, admin REST api e.g., curl http://localhost:9092/admin/v2/persistent/{tenant}/{namespace}, ç±»ä¼¼esçš„curl pulsar-admin CLI e.g., sh bin/pulsar-admin topics list tenant/cluster/namespace broker service discovery clientè¦ä¸bookieè¿›è¡Œäº¤äº’(index or query)éƒ½éœ€è¦ç»è¿‡broker è¿™ä¸ªæ¨¡å—å°±æä¾›ä¸€ä¸ªhttp server(jetty), ç”¨äºclientå‘é€httpæ¥round-robin zkä¸Šå­˜ç€çš„å¯ç”¨brokers å¯ç”¨brokersä¸http serverä¹‹é—´çš„é€šä¿¡æ¡¥æ¢æ˜¯zk, å³confé…ç½® It keeps list of active available brokers and redirects all incoming requests to one of the broker in round-robin manner String zookeeperServers = config.getInitParameter(&quot;zookeeperServers&quot;); functions ç±»ä¼¼ä¸€ä¸ªå°å‹flink/spark/MRæ¡†æ¶, å¯ä»¥éƒ¨ç½²åˆ°ç°æœ‰çš„brokerä¸Š(å®ç°å¤ç”¨) æœ‰ä¸€ä¸ªdashboard, ä½†æ˜¯UIè‚¯å®šæ²¡æœ‰sparké‚£ä¹ˆä¸°å¯Œ, å¯ä»¥çœ‹åˆ°lineage DAG, resource ä¸è¿‡å¯¹äºsimpleåº”ç”¨(map, flatMap)ç­‰, å°±å¯ä»¥æ¯”è¾ƒå¿«é€Ÿç®€å•å®ç°, ä¸ç”¨å¼•å…¥3rd party IO å¤–éƒ¨ç»„ä»¶ä½œä¸ºsource/sinkä¸pulsarçš„è¿æ¥ io connector, credit: apache 3ç±»processing guarantee, at-most-once at-least-once effectively-once processing guarantee transaction base on CompletableFuture thenCompose SQL base on presto éœ€è¦å•ç‹¬èµ·sql-worker, å³è¿è¡Œsh ${PRESTO_HOME}/bin/launcher run bootstrap ä½¿ç”¨standaloneæ¨¡å¼æ¥è¿‡ä¸€éå¯åŠ¨æ—¶ä¼šç»å†å“ªäº›çŠ¶æ€, create pulsarConfiguration include zk conf/standalone.conf broker zk bookKeeper loadManager(ResourceUnit) webService(admin REST api) startLeaderElectionService(zk-Watcher-notify-recursively) create nameSpace for tenant performance benchmark ä¸€èˆ¬ä»ä»¥ä¸‹2ä¸ªæ–¹é¢å…¥æ‰‹é€‰æ‹©é€‚åˆä¸šåŠ¡ç³»ç»Ÿçš„messaging system/streaming platform, latency: å›ºå®šé‡(size-mb)çš„æ•°æ®ä»ç”Ÿäº§åˆ°è¢«æ¶ˆè´¹ç¡®è®¤æ‰€éœ€çš„æ—¶é—´(time-sec) throughput: å•ä½æ—¶é—´(time-sec)å†…æœ€å¤§çš„æ•°æ®å‘é€/æ¥æ”¶é‡(size-mb) latency kafkaesque3åœ¨2019å¹´ä»ä»¥ä¸‹æ–¹é¢è¯¦ç»†ç»™å‡ºäº†å…³äºlatencyçš„benchmark, project sub-item remark kafka pulsar latency publishing latency æ¶ˆæ¯å‘é€åˆ°è¢«messaging system ackçš„æ—¶é—´ x y - end-to-end latency æ¶ˆæ¯å‘é€åˆ°è¢«consumer ackçš„æ—¶é—´ x y durability enable å¼€å¯å†™ç£ç›˜(flush)çš„æŒä¹…åŒ– x y - disable - x y replication enable å¤šæ•°æ®å‰¯æœ¬ x(leader-follower) y(bookKeeper quorum) - disable é›¶å‰¯æœ¬ x y workloads partition 1 åˆ†åŒºæ•° x y - 6 - x y - 16 - x y ä»æŠ¥å‘Šæ¥çœ‹, å°ç»“å¦‚ä¸‹, åœ¨end-to-end latency, kafkaå»¶è¿Ÿæ›´ä½; ä½†pulsaræ–¹å·®æ›´å°(smooth) åœ¨publishing latency, pulsarå»¶è¿Ÿæ›´ä½ä¸”æ›´smooth ç›¸æ¯”å•åˆ†åŒº, åœ¨å¢åŠ åˆ†åŒºpartitionæ—¶, pulsarè¡¨ç°å‡ºå»¶è¿Ÿæ›´ä½; è€Œkafkaåˆ™ç›¸åå…¶å¤šåˆ†åŒºå»¶è¿Ÿæ¯”å•åˆ†åŒºæ›´é«˜ åœ¨å¼€å¯durabilityçš„æƒ…å†µä¸‹, pulsarå»¶è¿Ÿæ›´ä½ ä½†æ˜¯è¯„è®ºåŒºä¹Ÿæœ‰äººæŒ‡å‡ºåº”è¯¥ä½¿ç”¨å¤šbrokersæ¥åšbenchmark, that make sense making benchmark workloads closer to PRD env throughput åœ¨2018å¹´ç»™å‡ºäº†pulsarååé‡æ›´é«˜çš„ç»“è®º2,4, ä½†æ˜¯ä¹Ÿæœ‰æœ‰ä¸åŒè§‚ç‚¹5 More kafka - åœ¨æé«˜latencyæ–¹é¢, kafkaä¹Ÿæœ‰å¾€quorumè½¬? ä½†æ˜¯å½“ä¸‹çš„åŸºäºprimary-backupå¯¹å®¹é”™æ”¯æŒæ›´å¥½6. ä¸è¿‡kafkaè¶Šæ¥è¶Šç‹¬ç«‹è‡ªæˆç³»ç»Ÿäº† pulsar - ç«™åœ¨äº†bookKeeperå’Œzkç­‰ç¬¬ä¸‰æ–¹æ¡†æ¶çš„è‚©è†€ä¸Š. ä½†æ˜¯ä¹Ÿå®ç°äº†å­˜å‚¨å’ŒæœåŠ¡åˆ†ç¦», scalingå¾ˆå¥½ ä¸ªäººæ¯”è¾ƒå–œæ¬¢pulsarçš„åˆ†ç¦»è®¾è®¡, å¤§å¤§æé«˜äº†å¯æ‰©å±•æ€§, å¯ä»¥æ›´å¥½åœ°å¢åŠ partitionæ¥åº”å¯¹çªå‘æµé‡, è€Œä¸åƒkafkaé‚£æ ·éœ€è¦äººå·¥ä»‹å…¥rebalance/reassign7 å½“ç„¶å¯¹äºkafkaä¸»åŠ¨è„±ç¦»zkè€Œè‡ªç®¡ç†metadataä¹Ÿå¾ˆæœŸå¾… Referene apache pulsar Apache Pulsaråˆ†å±‚åˆ†ç‰‡æ¶æ„ performance comparison between apache pulsar and kafka: latency Apache Pulsar at Yahoo!JAPAN Kafka vs. Pulsar vs. RabbitMQ: Performance, Architecture, and Features Compared Kafkaçš„å¤åˆ¶æœºåˆ¶ Kafkaè¿›è¡Œæœºå™¨æ‰©å®¹åçš„å‰¯æœ¬å†å¹³è¡¡å’Œä¸ºå·²æœ‰åˆ†åŒºå¢åŠ replicaå®è·µ How to Configure Apache Pulsar Cluster Geo Replication between Regions on AWS apache kafkaå…³æ³¨ç‚¹</summary></entry><entry><title type="html">stock learning</title><link href="http://localhost:4000/2020/06/09/00_stock.html" rel="alternate" type="text/html" title="stock learning" /><published>2020-06-09T00:00:00+08:00</published><updated>2020-06-09T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/09/00_stock</id><content type="html" xml:base="http://localhost:4000/2020/06/09/00_stock.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;æœˆåˆæ—¶, çœ‹åˆ°æ–°åŠ å¡è¿™è¾¹çš„æ­£å¸¸åˆ©æ¯å®åœ¨å¤ªä½äº†(75K SGDæœ¬é‡‘ä¸€å¹´æ˜¯37.5 SGDåˆ©æ¯, 0.05%), å³ä¾¿è¾¾æ ‡one interest(æ¯ä¸ªæœˆè‡³å°‘æ¶ˆè´¹500 SGD)åˆ©ç‡ä¹Ÿå³3.68%(è€Œä¸”æœ¬é‡‘ä¸Šé™æ˜¯75K, å¤šå‡ºçš„éƒ½åªæ˜¯æŒ‰ç…§base interestæ¥ç®—).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84125385-0d553080-aa6f-11ea-85f2-bd88028d639d.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;base interest only&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84125400-134b1180-aa6f-11ea-9562-c55162ef0e1c.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;base plus one interest&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84125954-dd5a5d00-aa6f-11ea-9d71-d6c2feadf028.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;larger deposits&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¦‚æœåœ¨å›½å†…, ç”±äºtopäº’è”ç½‘å…¬å¸éƒ½æœ‰äº’è”ç½‘é‡‘èç‰Œç…§, å¯ä»¥è½¬ç§»åˆ°ä»–ä»¬çš„åŸºé‡‘äº§å“è¿›è¡Œç®€å•æŠ•èµ„. è¿™æ ·è‡³å°‘æ¯”æ´»æœŸåœ¨é“¶è¡Œæœ‰åˆ©, è€Œä¸”çµæ´»æ€§å’ŒæµåŠ¨æ€§æ²¡æœ‰å—åˆ°å¤ªå¤§é™åˆ¶.&lt;/p&gt;

&lt;p&gt;è€Œå¹´åˆç»å†äº†&lt;a href=&quot;https://en.wikipedia.org/wiki/COVID-19_pandemic&quot;&gt;COVID-19 pandemic&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/China%E2%80%93United_States_trade_war&quot;&gt;trade war&lt;/a&gt;, &lt;a href=&quot;https://zh-yue.wikipedia.org/wiki/%E9%A6%99%E6%B8%AF%E5%9C%8B%E5%AE%B6%E5%AE%89%E5%85%A8%E6%B3%95&quot;&gt;HK national security law&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/George_Floyd_protests&quot;&gt;floyd protest&lt;/a&gt;ä¹‹å, ç¾å›½è‚¡å¸‚è‡³ä»Šä¸€ç›´åˆ©å¥½, é“ºå¤©ç›–åœ°çš„news. æ‰€ä»¥ä¸ç®¡æ˜¯å‡ºäºæƒ³èµ„äº§å¢å€¼è¿˜æ˜¯æƒ³å­¦ä¹ æŠ•èµ„, æœªå°ä¸å¯ä¸€è¯•. è™½ç„¶èµ·æ­¥æ™šäº†, å°±æ˜¯ä¸ªäººæ„Ÿè§‰ç°åœ¨ä¸å°‘å¤„äºè¶…ä¹°, ä½†æ˜¯è‡³å°‘çŸ¥é“äº†ä»€ä¹ˆæ˜¯è¶…ä¹°. é€šè¿‡è¿™æ¬¡å­¦ä¹ å’Œå‰æœŸå‡†å¤‡å·¥ä½œ, å½“ä¸‹ä¸€ä¸ªæœºä¼šæ¥ä¸´, å°±å¯ä»¥è¿…é€Ÿå…¥é‡‘å¹¶è¿›è¡Œç›¸å…³æŠ•èµ„.&lt;/p&gt;

&lt;p&gt;å½“ç„¶å¯ä»¥day-trading, è¿™ä¸ªæ¨¡å¼å¯èƒ½ä¸ä¼šååˆ†å…³æ³¨è¿™ä¸ªé•¿æœŸ, è€Œä¸“æ³¨äºçŸ­æœŸæ³¢åŠ¨, ä½†æ˜¯å´æ¯”è¾ƒç²¾ç»†å’Œè€—æ—¶, è€Œé€šè¿‡è“ç­¹è¿›è¡Œä»·å€¼æŠ•èµ„çš„è¯, ç›¸å¯¹çœå¿ƒ.&lt;/p&gt;

&lt;h1 id=&quot;preparation&quot;&gt;Preparation&lt;/h1&gt;
&lt;h2 id=&quot;broker&quot;&gt;broker&lt;/h2&gt;
&lt;p&gt;é€‰æ‹©ä¸€ä¸ªbrokerè¿›è¡Œè‚¡ç¥¨ä¹°å–, ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹æˆ‘åœ¨æ–°åŠ å¡å…³æ³¨çš„(ä»…ä»…ä»£è¡¨è‡ªå·±çš„ä¸ªäººçœ‹æ³•è€Œå·², è€Œä¸”ä¸ä¿è¯æ­£ç¡®, ä»¥æœ€æ–°å®˜ç½‘ä¸ºå‡†),&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;items&lt;/th&gt;
      &lt;th&gt;robinhood&lt;/th&gt;
      &lt;th&gt;etoro&lt;/th&gt;
      &lt;th&gt;td ameritrade&lt;/th&gt;
      &lt;th&gt;webull&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;commission fee&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
      &lt;td&gt;ä¹°å–æœ‰å·®ä»·(0.09%)&lt;/td&gt;
      &lt;td&gt;ä¹°å–æœ‰å·®ä»·&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;top up fee&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
      &lt;td&gt;$12.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;withdraw fee&lt;/td&gt;
      &lt;td&gt;zero&lt;/td&gt;
      &lt;td&gt;$5&lt;/td&gt;
      &lt;td&gt;$25&lt;/td&gt;
      &lt;td&gt;$45&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ä¼˜ç‚¹&lt;/td&gt;
      &lt;td&gt;freeå…è´¹, é€‚åˆå¤§ä¼—ç»„&lt;/td&gt;
      &lt;td&gt;æ“ä½œç®€å•, å¸‚åœºä¸°å¯Œ&lt;/td&gt;
      &lt;td&gt;æ¯”è¾ƒæˆç†Ÿä¸“ä¸š&lt;/td&gt;
      &lt;td&gt;æ“ä½œç®€å•, æ— ç‚¹å·®&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ç¼ºç‚¹&lt;/td&gt;
      &lt;td&gt;éœ€è¦USçš„SSNæ‰èƒ½æ³¨å†Œ&lt;/td&gt;
      &lt;td&gt;æœ‰ç‚¹å·®&lt;/td&gt;
      &lt;td&gt;æœ‰ç‚¹å·®&lt;/td&gt;
      &lt;td&gt;å‡ºå…¥é‡‘ä¸æ–¹ä¾¿&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å¦å¤–æ–°åŠ å¡è¿™è¾¹çš„credit cardå¦‚æœtop upåˆ°brokerè´¦æˆ·çš„è¯, æœ‰é¢å¤–çš„foreign currency transaction fee 3.25%(sgd -&amp;gt; usd)&lt;/p&gt;

&lt;p&gt;æˆ‘ä¼°è®¡withdrawçš„æ—¶å€™ä¹Ÿä¼šæœ‰currency feeäº§ç”Ÿ.&lt;/p&gt;

&lt;h2 id=&quot;trading-platforms&quot;&gt;trading platforms&lt;/h2&gt;

&lt;h3 id=&quot;platform&quot;&gt;platform&lt;/h3&gt;
&lt;p&gt;é€‰æ‹©ä¸€ä¸ªäº¤æ˜“å¹³å°æ¥åˆ†æè‚¡ç¥¨, è¿™ä¸ªå¯ä»¥æ˜¯å¤šä¸ªç»¼åˆåˆ†æ, å¹¶ä¸”ä¸brokerçš„çœŸå®ä¸‹å•åˆ†ç¦»,&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;items&lt;/th&gt;
      &lt;th&gt;td ameritrade&lt;/th&gt;
      &lt;th&gt;webull&lt;/th&gt;
      &lt;th&gt;futu&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ä¼˜ç‚¹&lt;/td&gt;
      &lt;td&gt;ä¸“ä¸š, æ“ä½œä¹ æƒ¯ç»†è…»&lt;/td&gt;
      &lt;td&gt;ç®€å•&lt;/td&gt;
      &lt;td&gt;ç®€å•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ç¼ºç‚¹&lt;/td&gt;
      &lt;td&gt;20minçš„delay&lt;/td&gt;
      &lt;td&gt;æƒå¨æ€§?&lt;/td&gt;
      &lt;td&gt;æ—¶é—´æ‹–åŠ¨æœ‰ç‚¹å¡&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å› ä¸ºè¿™èŠ‚ä¸æ¶‰åŠåˆ°äº¤æ˜“, åªæ˜¯åˆ†æ, ä¸ªäººçˆ±å¥½æ˜¯ä¸‰ä¸ªä¸€èµ·ç”¨(å„æœ‰å„çš„ä¼˜ç‚¹), ç›®å‰æ²¡æœ‰é‚£ä¹ˆå¤šä¸šä½™æ—¶é—´è¿›è¡Œday-trading, æ‰€ä»¥delayè¿˜å¯ä»¥æ¥å—.&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯&lt;a href=&quot;https://youtu.be/OkJh67jZsfo&quot;&gt;ç­›é€‰&lt;/a&gt;æœ‰æŠ•èµ„æ½œåŠ›çš„è‚¡ç¥¨, è¿˜æ˜¯ä½¿ç”¨tdæ¯”è¾ƒåˆé€‚.&lt;/p&gt;

&lt;h3 id=&quot;indicator&quot;&gt;indicator&lt;/h3&gt;
&lt;p&gt;å†å²æŠ¥ä»·é…åˆindicatorså¯ä»¥ä½œå‡ºæ›´åˆç†çš„åˆ†æå’Œåˆ¤æ–­, ä¸‹é¢æ˜¯ä¸€äº›ç”¨åˆ°çš„indicator,&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Trending&lt;/th&gt;
      &lt;th&gt;Kçº¿&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://youtu.be/_Ht6rUwjyC0&quot;&gt;VWAP&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://wiki.mbalib.com/wiki/EMA&quot;&gt;EMA&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://wiki.mbalib.com/wiki/RSI&quot;&gt;RSI&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://wiki.mbalib.com/wiki/MACD&quot;&gt;MACD&lt;/a&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;meaning&lt;/td&gt;
      &lt;td&gt;å¯ä»¥æ ¹æ®ä¸åŒæ—¶é—´ç²’åº¦è€Œèšåˆå‡ºä¸€ä¸ªèœ¡çƒ›, è¡¨æ˜äº†å¼€ç›˜ä»·, æ”¶ç›˜ä»·, æœ€é«˜ä»·, æœ€ä½ä»·. &lt;br /&gt;åæ˜ å¤§åŠ¿çš„çŠ¶å†µå’Œä»·æ ¼ä¿¡æ¯&lt;/td&gt;
      &lt;td&gt;æˆäº¤é‡åŠ æƒå¹³å‡ä»·, æ˜¯ä¸€ä¸ªå°†å¤šç¬”äº¤æ˜“çš„ä»·æ ¼æŒ‰å„è‡ªçš„æˆäº¤é‡åŠ æƒè€Œç®—å‡ºçš„å¹³å‡ä»·, å¸¸ç”¨äºday-trading. &lt;br /&gt;vwapæ—¢æ˜¯å‹åŠ›çº¿, ä¹Ÿæ˜¯æ”¯æ’‘çº¿&lt;/td&gt;
      &lt;td&gt;æ˜¯ä¸€å®šæœŸé—´å†…æ•°æ®(æ”¶ç›˜ä»·)çš„å¹³å‡å€¼, ä½†å´æé«˜äº†å½“æœŸæ•°æ®çš„æƒé‡&lt;/td&gt;
      &lt;td&gt;æ¯”è¾ƒä¸€æ®µæ—¶æœŸå†…çš„å¹³å‡æ”¶ç›˜&lt;strong&gt;æ¶¨&lt;/strong&gt;æ•°å’Œå¹³å‡æ”¶ç›˜&lt;strong&gt;è·Œ&lt;/strong&gt;æ•°æ¥åˆ†æå¸‚åœºä¹°å–ç›˜çš„æ„å‘å’Œå®åŠ›. &lt;br /&gt;RSIå¤šäº[30,70]ä¹‹é—´æ³¢åŠ¨, å½“æŒ‡æ ‡ä¸Šå‡(ä¸‹é™)åˆ°è¾¾80(20)æ—¶, è¡¨ç¤ºè‚¡å¸‚å·²æœ‰è¶…ä¹°(è¶…å–)ç°è±¡&lt;/td&gt;
      &lt;td&gt;ç”±ä¸€å¿«åŠä¸€æ…¢EMAä¹‹é—´çš„å·®è®¡ç®—å‡ºæ¥. &lt;br /&gt;â€œå¿«â€æŒ‡çŸ­æ—¶æœŸçš„EMA, è€Œâ€æ…¢â€åˆ™æŒ‡é•¿æ—¶æœŸçš„EMA, æœ€å¸¸ç”¨çš„æ˜¯12åŠ26æ—¥EMA, è¿ç”¨å¿«é€Ÿä¸æ…¢é€ŸEMAçš„èšåˆä¸åˆ†ç¦»çš„å¾å…†, æ¥ç ”åˆ¤ä¹°è¿›ä¸å–å‡ºçš„æ—¶æœºå’Œè®¯å·. &lt;br /&gt;å¿«æ…¢äº¤å‰ç‚¹å³é»„é‡‘äº¤å‰ç‚¹, ä¹Ÿç§°ä¹°å–ç‚¹&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;æœªæ¥å¯èƒ½&lt;/strong&gt;å‘ˆç°ä¸Šå‡â¤´ï¸è¶‹åŠ¿(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;æ¶¨ä»·&lt;/code&gt;)&lt;/td&gt;
      &lt;td&gt;ä¹‹å‰å¾ˆå¤šçº¢çƒ›, å¿½ç„¶æ¥äº†ä¸€ä¸ªå¾ˆé•¿çš„ç»¿çƒ›&lt;/td&gt;
      &lt;td&gt;èœ¡çƒ›å‘ä¸Šçªç ´vwap&lt;/td&gt;
      &lt;td&gt;èœ¡çƒ›å‘ä¸Šçªç ´ema&lt;/td&gt;
      &lt;td&gt;è¶…å–, ä»·å€¼è¢«ä½ä¼°äº†&lt;/td&gt;
      &lt;td&gt;çº¢æŸ±å¼€å§‹å‡å°‘/è¤ªè‰²&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;æœªæ¥å¯èƒ½&lt;/strong&gt;å‘ˆç°ä¸‹é™â¤µï¸è¶‹åŠ¿(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;é™ä»·&lt;/code&gt;)&lt;/td&gt;
      &lt;td&gt;ä¹‹å‰å¾ˆå¤šç»¿çƒ›, å¿½ç„¶æ¥äº†ä¸€ä¸ªå¾ˆé•¿çš„çº¢çƒ›&lt;/td&gt;
      &lt;td&gt;èœ¡çƒ›å‘ä¸‹è·Œç ´vwap&lt;/td&gt;
      &lt;td&gt;èœ¡çƒ›å‘ä¸‹è·Œç ´ema&lt;/td&gt;
      &lt;td&gt;è¶…ä¹°, ä»·å€¼è¢«é«˜ä¼°äº†&lt;/td&gt;
      &lt;td&gt;ç»¿æŸ±å¼€å§‹å‡å°‘/è¤ªè‰²&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;è¿™äº›indicatorsä¸æ˜¯å…¥å¸‚å’Œå‡ºå¸‚çš„å”¯ä¸€æ ‡å‡†, åªæ˜¯ä¸€ä¸ªå‚è€ƒ, æœ€ç»ˆçš„ä¸‹å•å†³å®šä»æœ‰è·¯è¦èµ°.&lt;/p&gt;

&lt;h3 id=&quot;é»„é‡‘åˆ†å‰²&quot;&gt;é»„é‡‘åˆ†å‰²&lt;/h3&gt;
&lt;p&gt;æŸæ—¶é—´æ®µå†…çš„æœ€é«˜ç‚¹(0%)ä¸æœ€ä½ç‚¹(100%)&lt;/p&gt;

&lt;p&gt;è§‚å¯Ÿkçº¿åœ¨é»„é‡‘åˆ†å‰²çº¿åŒºé—´çš„è¿ä½œ&lt;/p&gt;

&lt;p&gt;kçº¿çªç ´(å‘ä¸Š/å‘ä¸‹)æŸæ¡é»„é‡‘çº¿, é‚£ä¹ˆè¯¥é»„é‡‘çš„ä¸Šä¸‹å°±æ˜¯resistanceå’Œsupportçº¿&lt;/p&gt;

&lt;h4 id=&quot;æœ€ä½ä»·æ”¯æ’‘çº¿&quot;&gt;æœ€ä½ä»·æ”¯æ’‘çº¿&lt;/h4&gt;

&lt;p&gt;æŸæ—¶é—´æ®µå†…çš„ä¸€æ¡ç›´çº¿è¿æ¥2ä¸ªæœ€ä½ä»·(æˆ–è€…å°½é‡å¤šçš„ä½ä»·ç‚¹è¿èµ·æ¥)&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;å¦‚æœå½¢æˆä¸Šå‡è¶‹åŠ¿çº¿, ä¸ç ´ä½, æ²¿ç€æ”¹çº¿éœ‡è¡å‘ä¸Š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84878704-c5608a00-b0bc-11ea-9801-4f6887ee0511.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ref: https://www.youtube.com/watch?v=9Nm_or34P-Q&amp;amp;feature=youtu.be&amp;amp;t=443s&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;financial-statement&quot;&gt;financial statement&lt;/h2&gt;
&lt;p&gt;åœ¨æŠ•èµ„ä¸€ä¸ªå…¬å¸å‰, é¦–å…ˆå¯¹å…¶ä¸šåŠ¡è¿›è¡Œåˆ¤æ–­, æ˜¯å¦å¤•é˜³ä¸šåŠ¡, æ˜¯å¦æœªæ¥ä¸šåŠ¡.&lt;/p&gt;

&lt;p&gt;å…¶æ¬¡å¯¹å…¶è´¢æŠ¥è¿›è¡Œ&lt;a href=&quot;https://youtu.be/NCoMUTiaLE8&quot;&gt;åˆ†æ&lt;/a&gt;, æ˜¯å¦å€ºå°é«˜ç­‘(è¡Œä¸šå¹³å‡), æ˜¯å¦æœ‰è¶³å¤Ÿç°é‡‘æµ.
ä¸‹é¢æ˜¯ä¸€äº›åœ¨yahoo financeä¸Šçš„è´¢æŠ¥å…³æ³¨æŒ‡æ ‡,&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;èµ„äº§è´Ÿå€ºè¡¨, income statement&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;items&lt;/th&gt;
          &lt;th&gt;feature&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;æ€»ç°é‡‘&lt;/td&gt;
          &lt;td&gt;Cash Equivalents &amp;amp; Short Term Investments&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;é•¿æœŸè´Ÿå€º&lt;/td&gt;
          &lt;td&gt;Long Term Debt&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;ä¿ç•™ç›ˆåˆ©&lt;/td&gt;
          &lt;td&gt;ä»å…¬å¸åˆ›ç«‹ä»¥æ¥è‡³ä»Šçš„ç´¯è®¡åˆ©æ¶¦&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;æ€»èµ„äº§ - æ€»è´Ÿå€º&lt;/td&gt;
          &lt;td&gt;æ•°å€¼è¶Šå°‘, æµåŠ¨æ€§è¶Šå·®&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸç›Šè¡¨, balance sheet&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;items&lt;/th&gt;
          &lt;th&gt;feature&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;æ€»æ”¶ç›Š&lt;/td&gt;
          &lt;td&gt;çœ‹å…¬å¸æ˜¯å¦åœ¨æˆé•¿&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;ç»è¥æ”¶å…¥æˆ–äºæŸ&lt;/td&gt;
          &lt;td&gt;çœ‹ç®¡ç†å±‚çš„å·¥ä½œæ•ˆæœ&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;å‡€æ”¶ç›Š&lt;/td&gt;
          &lt;td&gt;çœ‹å…¬å¸æ˜¯å¦åœ¨æŒç»­èµšé’±&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç°é‡‘æµé‡è¡¨, cash flow&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;items&lt;/th&gt;
          &lt;th&gt;feature&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;è‡ªç”±ç°é‡‘æµé‡&lt;/td&gt;
          &lt;td&gt;å…¬å¸å¯ä»¥è‡ªç”±çµæ´»è¿ç”¨çš„èµ„é‡‘&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;referene&quot;&gt;Referene&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/channel/UC8AA0Ao2ZHxNWZu0ZFdRZxw&quot;&gt;Curtis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/channel/UCFnQI5gEF8X_YE9gKf5msPg&quot;&gt;Joseph Ma&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/1467393/&quot;&gt;The Intelligent Investor&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="stock" /><summary type="html">Overview æœˆåˆæ—¶, çœ‹åˆ°æ–°åŠ å¡è¿™è¾¹çš„æ­£å¸¸åˆ©æ¯å®åœ¨å¤ªä½äº†(75K SGDæœ¬é‡‘ä¸€å¹´æ˜¯37.5 SGDåˆ©æ¯, 0.05%), å³ä¾¿è¾¾æ ‡one interest(æ¯ä¸ªæœˆè‡³å°‘æ¶ˆè´¹500 SGD)åˆ©ç‡ä¹Ÿå³3.68%(è€Œä¸”æœ¬é‡‘ä¸Šé™æ˜¯75K, å¤šå‡ºçš„éƒ½åªæ˜¯æŒ‰ç…§base interestæ¥ç®—). base interest only base plus one interest larger deposits å¦‚æœåœ¨å›½å†…, ç”±äºtopäº’è”ç½‘å…¬å¸éƒ½æœ‰äº’è”ç½‘é‡‘èç‰Œç…§, å¯ä»¥è½¬ç§»åˆ°ä»–ä»¬çš„åŸºé‡‘äº§å“è¿›è¡Œç®€å•æŠ•èµ„. è¿™æ ·è‡³å°‘æ¯”æ´»æœŸåœ¨é“¶è¡Œæœ‰åˆ©, è€Œä¸”çµæ´»æ€§å’ŒæµåŠ¨æ€§æ²¡æœ‰å—åˆ°å¤ªå¤§é™åˆ¶. è€Œå¹´åˆç»å†äº†COVID-19 pandemic, trade war, HK national security law, floyd protestä¹‹å, ç¾å›½è‚¡å¸‚è‡³ä»Šä¸€ç›´åˆ©å¥½, é“ºå¤©ç›–åœ°çš„news. æ‰€ä»¥ä¸ç®¡æ˜¯å‡ºäºæƒ³èµ„äº§å¢å€¼è¿˜æ˜¯æƒ³å­¦ä¹ æŠ•èµ„, æœªå°ä¸å¯ä¸€è¯•. è™½ç„¶èµ·æ­¥æ™šäº†, å°±æ˜¯ä¸ªäººæ„Ÿè§‰ç°åœ¨ä¸å°‘å¤„äºè¶…ä¹°, ä½†æ˜¯è‡³å°‘çŸ¥é“äº†ä»€ä¹ˆæ˜¯è¶…ä¹°. é€šè¿‡è¿™æ¬¡å­¦ä¹ å’Œå‰æœŸå‡†å¤‡å·¥ä½œ, å½“ä¸‹ä¸€ä¸ªæœºä¼šæ¥ä¸´, å°±å¯ä»¥è¿…é€Ÿå…¥é‡‘å¹¶è¿›è¡Œç›¸å…³æŠ•èµ„. å½“ç„¶å¯ä»¥day-trading, è¿™ä¸ªæ¨¡å¼å¯èƒ½ä¸ä¼šååˆ†å…³æ³¨è¿™ä¸ªé•¿æœŸ, è€Œä¸“æ³¨äºçŸ­æœŸæ³¢åŠ¨, ä½†æ˜¯å´æ¯”è¾ƒç²¾ç»†å’Œè€—æ—¶, è€Œé€šè¿‡è“ç­¹è¿›è¡Œä»·å€¼æŠ•èµ„çš„è¯, ç›¸å¯¹çœå¿ƒ. Preparation broker é€‰æ‹©ä¸€ä¸ªbrokerè¿›è¡Œè‚¡ç¥¨ä¹°å–, ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹æˆ‘åœ¨æ–°åŠ å¡å…³æ³¨çš„(ä»…ä»…ä»£è¡¨è‡ªå·±çš„ä¸ªäººçœ‹æ³•è€Œå·², è€Œä¸”ä¸ä¿è¯æ­£ç¡®, ä»¥æœ€æ–°å®˜ç½‘ä¸ºå‡†), items robinhood etoro td ameritrade webull commission fee zero ä¹°å–æœ‰å·®ä»·(0.09%) ä¹°å–æœ‰å·®ä»· zero top up fee zero zero zero $12. withdraw fee zero $5 $25 $45 ä¼˜ç‚¹ freeå…è´¹, é€‚åˆå¤§ä¼—ç»„ æ“ä½œç®€å•, å¸‚åœºä¸°å¯Œ æ¯”è¾ƒæˆç†Ÿä¸“ä¸š æ“ä½œç®€å•, æ— ç‚¹å·® ç¼ºç‚¹ éœ€è¦USçš„SSNæ‰èƒ½æ³¨å†Œ æœ‰ç‚¹å·® æœ‰ç‚¹å·® å‡ºå…¥é‡‘ä¸æ–¹ä¾¿ å¦å¤–æ–°åŠ å¡è¿™è¾¹çš„credit cardå¦‚æœtop upåˆ°brokerè´¦æˆ·çš„è¯, æœ‰é¢å¤–çš„foreign currency transaction fee 3.25%(sgd -&amp;gt; usd) æˆ‘ä¼°è®¡withdrawçš„æ—¶å€™ä¹Ÿä¼šæœ‰currency feeäº§ç”Ÿ. trading platforms platform é€‰æ‹©ä¸€ä¸ªäº¤æ˜“å¹³å°æ¥åˆ†æè‚¡ç¥¨, è¿™ä¸ªå¯ä»¥æ˜¯å¤šä¸ªç»¼åˆåˆ†æ, å¹¶ä¸”ä¸brokerçš„çœŸå®ä¸‹å•åˆ†ç¦», items td ameritrade webull futu ä¼˜ç‚¹ ä¸“ä¸š, æ“ä½œä¹ æƒ¯ç»†è…» ç®€å• ç®€å• ç¼ºç‚¹ 20minçš„delay æƒå¨æ€§? æ—¶é—´æ‹–åŠ¨æœ‰ç‚¹å¡ å› ä¸ºè¿™èŠ‚ä¸æ¶‰åŠåˆ°äº¤æ˜“, åªæ˜¯åˆ†æ, ä¸ªäººçˆ±å¥½æ˜¯ä¸‰ä¸ªä¸€èµ·ç”¨(å„æœ‰å„çš„ä¼˜ç‚¹), ç›®å‰æ²¡æœ‰é‚£ä¹ˆå¤šä¸šä½™æ—¶é—´è¿›è¡Œday-trading, æ‰€ä»¥delayè¿˜å¯ä»¥æ¥å—. ä½†æ˜¯ç­›é€‰æœ‰æŠ•èµ„æ½œåŠ›çš„è‚¡ç¥¨, è¿˜æ˜¯ä½¿ç”¨tdæ¯”è¾ƒåˆé€‚. indicator å†å²æŠ¥ä»·é…åˆindicatorså¯ä»¥ä½œå‡ºæ›´åˆç†çš„åˆ†æå’Œåˆ¤æ–­, ä¸‹é¢æ˜¯ä¸€äº›ç”¨åˆ°çš„indicator, Trending Kçº¿ VWAP EMA RSI MACD meaning å¯ä»¥æ ¹æ®ä¸åŒæ—¶é—´ç²’åº¦è€Œèšåˆå‡ºä¸€ä¸ªèœ¡çƒ›, è¡¨æ˜äº†å¼€ç›˜ä»·, æ”¶ç›˜ä»·, æœ€é«˜ä»·, æœ€ä½ä»·. åæ˜ å¤§åŠ¿çš„çŠ¶å†µå’Œä»·æ ¼ä¿¡æ¯ æˆäº¤é‡åŠ æƒå¹³å‡ä»·, æ˜¯ä¸€ä¸ªå°†å¤šç¬”äº¤æ˜“çš„ä»·æ ¼æŒ‰å„è‡ªçš„æˆäº¤é‡åŠ æƒè€Œç®—å‡ºçš„å¹³å‡ä»·, å¸¸ç”¨äºday-trading. vwapæ—¢æ˜¯å‹åŠ›çº¿, ä¹Ÿæ˜¯æ”¯æ’‘çº¿ æ˜¯ä¸€å®šæœŸé—´å†…æ•°æ®(æ”¶ç›˜ä»·)çš„å¹³å‡å€¼, ä½†å´æé«˜äº†å½“æœŸæ•°æ®çš„æƒé‡ æ¯”è¾ƒä¸€æ®µæ—¶æœŸå†…çš„å¹³å‡æ”¶ç›˜æ¶¨æ•°å’Œå¹³å‡æ”¶ç›˜è·Œæ•°æ¥åˆ†æå¸‚åœºä¹°å–ç›˜çš„æ„å‘å’Œå®åŠ›. RSIå¤šäº[30,70]ä¹‹é—´æ³¢åŠ¨, å½“æŒ‡æ ‡ä¸Šå‡(ä¸‹é™)åˆ°è¾¾80(20)æ—¶, è¡¨ç¤ºè‚¡å¸‚å·²æœ‰è¶…ä¹°(è¶…å–)ç°è±¡ ç”±ä¸€å¿«åŠä¸€æ…¢EMAä¹‹é—´çš„å·®è®¡ç®—å‡ºæ¥. â€œå¿«â€æŒ‡çŸ­æ—¶æœŸçš„EMA, è€Œâ€æ…¢â€åˆ™æŒ‡é•¿æ—¶æœŸçš„EMA, æœ€å¸¸ç”¨çš„æ˜¯12åŠ26æ—¥EMA, è¿ç”¨å¿«é€Ÿä¸æ…¢é€ŸEMAçš„èšåˆä¸åˆ†ç¦»çš„å¾å…†, æ¥ç ”åˆ¤ä¹°è¿›ä¸å–å‡ºçš„æ—¶æœºå’Œè®¯å·. å¿«æ…¢äº¤å‰ç‚¹å³é»„é‡‘äº¤å‰ç‚¹, ä¹Ÿç§°ä¹°å–ç‚¹ æœªæ¥å¯èƒ½å‘ˆç°ä¸Šå‡â¤´ï¸è¶‹åŠ¿(æ¶¨ä»·) ä¹‹å‰å¾ˆå¤šçº¢çƒ›, å¿½ç„¶æ¥äº†ä¸€ä¸ªå¾ˆé•¿çš„ç»¿çƒ› èœ¡çƒ›å‘ä¸Šçªç ´vwap èœ¡çƒ›å‘ä¸Šçªç ´ema è¶…å–, ä»·å€¼è¢«ä½ä¼°äº† çº¢æŸ±å¼€å§‹å‡å°‘/è¤ªè‰² æœªæ¥å¯èƒ½å‘ˆç°ä¸‹é™â¤µï¸è¶‹åŠ¿(é™ä»·) ä¹‹å‰å¾ˆå¤šç»¿çƒ›, å¿½ç„¶æ¥äº†ä¸€ä¸ªå¾ˆé•¿çš„çº¢çƒ› èœ¡çƒ›å‘ä¸‹è·Œç ´vwap èœ¡çƒ›å‘ä¸‹è·Œç ´ema è¶…ä¹°, ä»·å€¼è¢«é«˜ä¼°äº† ç»¿æŸ±å¼€å§‹å‡å°‘/è¤ªè‰² è¿™äº›indicatorsä¸æ˜¯å…¥å¸‚å’Œå‡ºå¸‚çš„å”¯ä¸€æ ‡å‡†, åªæ˜¯ä¸€ä¸ªå‚è€ƒ, æœ€ç»ˆçš„ä¸‹å•å†³å®šä»æœ‰è·¯è¦èµ°. é»„é‡‘åˆ†å‰² æŸæ—¶é—´æ®µå†…çš„æœ€é«˜ç‚¹(0%)ä¸æœ€ä½ç‚¹(100%) è§‚å¯Ÿkçº¿åœ¨é»„é‡‘åˆ†å‰²çº¿åŒºé—´çš„è¿ä½œ kçº¿çªç ´(å‘ä¸Š/å‘ä¸‹)æŸæ¡é»„é‡‘çº¿, é‚£ä¹ˆè¯¥é»„é‡‘çš„ä¸Šä¸‹å°±æ˜¯resistanceå’Œsupportçº¿ æœ€ä½ä»·æ”¯æ’‘çº¿ æŸæ—¶é—´æ®µå†…çš„ä¸€æ¡ç›´çº¿è¿æ¥2ä¸ªæœ€ä½ä»·(æˆ–è€…å°½é‡å¤šçš„ä½ä»·ç‚¹è¿èµ·æ¥) å¦‚æœå½¢æˆä¸Šå‡è¶‹åŠ¿çº¿, ä¸ç ´ä½, æ²¿ç€æ”¹çº¿éœ‡è¡å‘ä¸Š ref: https://www.youtube.com/watch?v=9Nm_or34P-Q&amp;amp;feature=youtu.be&amp;amp;t=443s financial statement åœ¨æŠ•èµ„ä¸€ä¸ªå…¬å¸å‰, é¦–å…ˆå¯¹å…¶ä¸šåŠ¡è¿›è¡Œåˆ¤æ–­, æ˜¯å¦å¤•é˜³ä¸šåŠ¡, æ˜¯å¦æœªæ¥ä¸šåŠ¡. å…¶æ¬¡å¯¹å…¶è´¢æŠ¥è¿›è¡Œåˆ†æ, æ˜¯å¦å€ºå°é«˜ç­‘(è¡Œä¸šå¹³å‡), æ˜¯å¦æœ‰è¶³å¤Ÿç°é‡‘æµ. ä¸‹é¢æ˜¯ä¸€äº›åœ¨yahoo financeä¸Šçš„è´¢æŠ¥å…³æ³¨æŒ‡æ ‡, èµ„äº§è´Ÿå€ºè¡¨, income statement items feature æ€»ç°é‡‘ Cash Equivalents &amp;amp; Short Term Investments é•¿æœŸè´Ÿå€º Long Term Debt ä¿ç•™ç›ˆåˆ© ä»å…¬å¸åˆ›ç«‹ä»¥æ¥è‡³ä»Šçš„ç´¯è®¡åˆ©æ¶¦ æ€»èµ„äº§ - æ€»è´Ÿå€º æ•°å€¼è¶Šå°‘, æµåŠ¨æ€§è¶Šå·® æŸç›Šè¡¨, balance sheet items feature æ€»æ”¶ç›Š çœ‹å…¬å¸æ˜¯å¦åœ¨æˆé•¿ ç»è¥æ”¶å…¥æˆ–äºæŸ çœ‹ç®¡ç†å±‚çš„å·¥ä½œæ•ˆæœ å‡€æ”¶ç›Š çœ‹å…¬å¸æ˜¯å¦åœ¨æŒç»­èµšé’± ç°é‡‘æµé‡è¡¨, cash flow items feature è‡ªç”±ç°é‡‘æµé‡ å…¬å¸å¯ä»¥è‡ªç”±çµæ´»è¿ç”¨çš„èµ„é‡‘ Referene Curtis Joseph Ma The Intelligent Investor</summary></entry><entry><title type="html">piano learning</title><link href="http://localhost:4000/2020/06/07/00_piano.html" rel="alternate" type="text/html" title="piano learning" /><published>2020-06-07T00:00:00+08:00</published><updated>2020-06-07T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/07/00_piano</id><content type="html" xml:base="http://localhost:4000/2020/06/07/00_piano.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;ç´æ¥äº†, å“ˆå“ˆ.&lt;/p&gt;

&lt;p&gt;å¶ç„¶randomåˆ°ä¸€é¦–é’¢ç´æ›²&lt;sup&gt;2&lt;/sup&gt;, çœ‹ç€è§†é¢‘å‘å‘†äº†, å¬ç€æ—‹å¾‹ä¹Ÿå‘å‘†äº†. æ‰€ä»¥è¯•ç€è®©è‡ªå·±ä¹Ÿå­¦ä¸€å­¦, å¸Œæœ›æœ‰æœä¸€æ—¥æˆ‘ä¹Ÿèƒ½ç®€å•è¿ç»­å¼¹å‡ºä¸€äº›å–œæ¬¢çš„æ›²å­.&lt;/p&gt;

&lt;h1 id=&quot;è®¤è¯†é”®ç›˜&quot;&gt;è®¤è¯†é”®ç›˜&lt;/h1&gt;
&lt;p&gt;88ä¸ªé”® = 52ä¸ªç™½é”® + 36ä¸ªé»‘é”®, ä¸€å…±åˆ†ä¸º7ä¸ªåŒº(octaves),&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84173554-04388380-aab0-11ea-8f3b-1d58f9ef0ff5.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;åˆ†åŒº(C1-C7)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;è®¤è¯†äº”çº¿è°±&quot;&gt;è®¤è¯†äº”çº¿è°±&lt;/h1&gt;
&lt;p&gt;ä¸»è¦è®°å½•ç€,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;è°±å·clef
    &lt;ul&gt;
      &lt;li&gt;é«˜éŸ³è°±å·treble
  &lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84250542-c0d92600-ab3e-11ea-803d-3f777f534d7a.png&quot; alt=&quot;image&quot; /&gt;
        &lt;blockquote&gt;
          &lt;p&gt;EGBDF(Every Great Band Draws Fans), FACE&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
      &lt;li&gt;ä½éŸ³è°±å·bass
  &lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84250553-c46cad00-ab3e-11ea-8419-43cb8b04aae5.png&quot; alt=&quot;image&quot; /&gt;
        &lt;blockquote&gt;
          &lt;p&gt;GBDFA(Good Boy Does Fine Always), ACEG(All Cows Eat Grass)&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
      &lt;li&gt;ä¸­éŸ³è°±å·alto&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;çº¿line
    &lt;ul&gt;
      &lt;li&gt;åŠ çº¿ledger&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é—´space
    &lt;ul&gt;
      &lt;li&gt;åŠ é—´&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ‹å·time signature
    &lt;ul&gt;
      &lt;li&gt;å®šä¹‰å°èŠ‚ä¸­çš„èŠ‚æ‹æ•°é‡ä»¥åŠéŸ³ç¬¦æ—¶å€¼çš„å…·ä½“æ‹æ•°&lt;/li&gt;
      &lt;li&gt;e.g., 3/8æ‰€ä»£è¡¨çš„å«ä¹‰ä¸ºâ€ä»¥8åˆ†éŸ³ç¬¦ä¸º1æ‹, æ¯å°èŠ‚æœ‰3æ‹â€&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;å¼ºå¼±è§„å¾‹&lt;/p&gt;

        &lt;table&gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;th&gt;æ‹å·&lt;/th&gt;
              &lt;th&gt;feature&lt;/th&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;4/4æ‹&lt;/td&gt;
              &lt;td&gt;å¼º -&amp;gt; å¼± -&amp;gt; æ¬¡å¼º -&amp;gt; å¼±&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;3/4æ‹&lt;/td&gt;
              &lt;td&gt;å¼º -&amp;gt; å¼± -&amp;gt; å¼±&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;2/4æ‹&lt;/td&gt;
              &lt;td&gt;å¼º -&amp;gt; å¼±&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;åˆ‡åˆ†èŠ‚å¥(è¿›é˜¶å¿…å¤‡?)
        &lt;ul&gt;
          &lt;li&gt;æ²¡æœ‰æŒ‰ç…§4/4æ‹çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å¼º -&amp;gt; å¼± -&amp;gt; æ¬¡å¼º -&amp;gt; å¼±&lt;/code&gt;æ¥èµ°, è€Œæ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å¼± -&amp;gt; å¼º -&amp;gt; å¼±&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;éŸ³ç¬¦note
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;æ—¶å€¼duration, å°±æ˜¯å‡»é”®ä¸åœé¡¿çš„æ—¶é—´(èŠ‚å¥)&lt;/p&gt;

        &lt;table&gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;th&gt;note&lt;/th&gt;
              &lt;th&gt;feature&lt;/th&gt;
              &lt;th&gt;duration&lt;/th&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;å…¨éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;ç©ºå¿ƒç¬¦å¤´&lt;/td&gt;
              &lt;td&gt;4æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;äºŒåˆ†éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;ç©ºå¿ƒç¬¦å¤´ + ç¬¦å¹²&lt;/td&gt;
              &lt;td&gt;2æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;å››åˆ†éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;å®å¿ƒç¬¦å¤´ + ç¬¦å¹²&lt;/td&gt;
              &lt;td&gt;1æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;å…«åˆ†éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;å®å¿ƒç¬¦å¤´ + ç¬¦å¹² + ç¬¦å°¾&lt;/td&gt;
              &lt;td&gt;1/2æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;åå…­åˆ†éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;å®å¿ƒç¬¦å¤´ + ç¬¦å¹² + 2ç¬¦å°¾&lt;/td&gt;
              &lt;td&gt;1/4æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;é™„ç‚¹äºŒåˆ†éŸ³ç¬¦&lt;/td&gt;
              &lt;td&gt;äºŒåˆ†éŸ³ç¬¦+ é™„ç‚¹&lt;/td&gt;
              &lt;td&gt;(2 + é™„ç‚¹çš„æ—¶å€¼æ˜¯å‰é¢éŸ³ç¬¦çš„1/2)=3æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;ä¼‘æ­¢ç¬¦&lt;/td&gt;
              &lt;td&gt;å€’æŒ‚äºç¬¬4çº¿&lt;/td&gt;
              &lt;td&gt;æ•´å°èŠ‚&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;äºŒåˆ†ä¼‘æ­¢ç¬¦&lt;/td&gt;
              &lt;td&gt;æ”¾åœ¨ç¬¬3çº¿&lt;/td&gt;
              &lt;td&gt;2æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;å››åˆ†ä¼‘æ­¢ç¬¦&lt;/td&gt;
              &lt;td&gt;äººå½¢&lt;/td&gt;
              &lt;td&gt;1æ‹&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;è¿éŸ³çº¿&lt;/td&gt;
              &lt;td&gt;æ‹±å½¢x-x, åª&lt;strong&gt;æŠ¬æ‰‹&lt;/strong&gt;ä¸€æ¬¡, ä¸­é—´çš„æ‰€æœ‰éŸ³ç¬¦éƒ½æ˜¯&lt;strong&gt;æŠ¬æŒ‡&lt;/strong&gt;&lt;/td&gt;
              &lt;td&gt;æ—¶å€¼æ˜¯ä¸¤è€…ç›¸åŠ &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;é™è®°å·&lt;/td&gt;
              &lt;td&gt;å°–b&lt;/td&gt;
              &lt;td&gt;å‡»å…¶å·¦è¾¹çš„1é”®(é™åŠéŸ³)&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;å‡è®°å·&lt;/td&gt;
              &lt;td&gt;å°–#&lt;/td&gt;
              &lt;td&gt;å‡»å…¶å³è¾¹çš„1é”®(å‡åŠéŸ³)&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;éŸ³ç¬¦è½é”®&quot;&gt;éŸ³ç¬¦è½é”®&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84173235-968c5780-aaaf-11ea-921a-b84686c60681.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;éŸ³ç¬¦åœ¨äº”çº¿è°±staffçš„ä½ç½® vs é”®ç›˜ä½ç½®(!)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84168033-85404c80-aaa9-11ea-89db-e1d1bf09235e.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;éŸ³ç¬¦noteåœ¨äº”çº¿è°±staffçš„ä½ç½® vs é”®ç›˜ä½ç½®(!!)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84181262-3dc2bc00-aabb-11ea-9765-36a463999b74.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;éŸ³ç¬¦åœ¨äº”çº¿è°±çš„ä½ç½® vs é”®ç›˜ä½ç½®(!!!)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;æ‰‹æŒ‡ä½ç½®&quot;&gt;æ‰‹æŒ‡ä½ç½®&lt;/h1&gt;
&lt;p&gt;æ‰¾åˆ°å½“å‰éŸ³ç¬¦çš„è½é”®ä½ç½®ä¹‹å, å°±è¦åˆ¤æ–­ç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å“ªåªæ‰‹&lt;/code&gt;çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å“ªæ ¹æŒ‡å¤´&lt;/code&gt;å»æ•²å‡»,&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84169507-4612fb00-aaab-11ea-9a92-a15ceb8a2151.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Cå¤§èª¿ä¸‹çš„æ‰‹æŒ‡æ‘†æ”¾layout. å·¦æ‰‹å°¾æŒ‡åœ¨C3, å³æ‰‹æ‹‡æŒ‡åœ¨C4&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84170002-db15f400-aaab-11ea-8f0f-b385ff6f59fd.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;å„ç§è°ƒå·key signatureæ‰€å¯¹åº”çš„æ‰‹æŒ‡æ‘†æ”¾(æ‹‡æŒ‡æ°¸è¿œæ˜¯1, å°¾æŒ‡æ°¸è¿œæ˜¯5)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸Šå›¾å¯ä»¥çœ‹åˆ°, &lt;strong&gt;è½¬æŒ‡&lt;/strong&gt;,&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªåˆ†åŒºæ˜¯7ä¸ªéŸ³,&lt;/p&gt;

&lt;p&gt;C -&amp;gt; D -&amp;gt; E -&amp;gt; F -&amp;gt; G -&amp;gt; A -&amp;gt; B -&amp;gt; C ä¸€å…±8ä¸ªéŸ³, å³&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;direction&lt;/th&gt;
      &lt;th&gt;action&lt;/th&gt;
      &lt;th&gt;sequence&lt;/th&gt;
      &lt;th&gt;combine&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;å¾€å³(ä¸Šè¡Œ)&lt;/td&gt;
      &lt;td&gt;ä¸­æŒ‡å›ºå®š(ç¬¬3ä½), æ‹‡æŒ‡ç©¿è¶Š&lt;/td&gt;
      &lt;td&gt;1 -&amp;gt; 2 -&amp;gt; 3(å›ºå®š) -&amp;gt; 1(ç©¿è¶Š) -&amp;gt; 2 -&amp;gt; 3 -&amp;gt; 4 -&amp;gt; 5&lt;/td&gt;
      &lt;td&gt;3+5çš„æŒ‡æ³•ç»„åˆ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å¾€å·¦(ä¸‹è¡Œ)&lt;/td&gt;
      &lt;td&gt;æ‹‡æŒ‡å›ºå®š(ç¬¬5ä½), ä¸­æŒ‡ç©¿è¶Š&lt;/td&gt;
      &lt;td&gt;5 -&amp;gt; 4 -&amp;gt; 3 -&amp;gt; 2 -&amp;gt; 1(å›ºå®š) -&amp;gt; 3(ç©¿è¶Š) -&amp;gt; 2 -&amp;gt; 1&lt;/td&gt;
      &lt;td&gt;5+3çš„æŒ‡æ³•ç»„åˆ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/84171275-372d4800-aaad-11ea-9aba-01aea84ac718.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;æ‰‹å‹è®­ç»ƒ, è„‘æµ·é‡Œæƒ³è±¡ç€æ‰‹æ¡ä½ç½‘çƒ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;è®­ç»ƒç´ æ&quot;&gt;è®­ç»ƒç´ æ&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://apps.apple.com/us/app/notes-sight-reading-trainer/id874386416&quot;&gt;è®¤è¯†éŸ³ç¬¦çš„è½é”®&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/1493350/&quot;&gt;æŒ‡æ³•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;ç®€å•å³æ‰‹ç»ƒä¹ æ›²&lt;/li&gt;
  &lt;li&gt;ç®€å•å·¦æ‰‹ç»ƒä¹ æ›²&lt;/li&gt;
  &lt;li&gt;ç®€å•åŒæ‰‹ç»ƒä¹ æ›²&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;reference&quot;&gt;Reference&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/playlist?list=PLB8nOR4NbaKCsi6bo0OEaJcVqRjgrcxFV&quot;&gt;é›¶åŸºç¤å­¸é‹¼ç´&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://youtu.be/P9OhFXuWOVg&quot;&gt;å›ã ã£ãŸã‚‰ piano&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E8%B0%83%E5%8F%B7&quot;&gt;è°ƒå·&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/19754814/answer/62393028&quot;&gt;æ€æ ·è‡ªå­¦é’¢ç´ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/Piano-Keyboard-All-One-Dummies-ebook/dp/B00H7JE9FO&quot;&gt;Piano and Keyboard All-in-One For Dummies&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="piano" /><summary type="html">Overview ç´æ¥äº†, å“ˆå“ˆ. å¶ç„¶randomåˆ°ä¸€é¦–é’¢ç´æ›²2, çœ‹ç€è§†é¢‘å‘å‘†äº†, å¬ç€æ—‹å¾‹ä¹Ÿå‘å‘†äº†. æ‰€ä»¥è¯•ç€è®©è‡ªå·±ä¹Ÿå­¦ä¸€å­¦, å¸Œæœ›æœ‰æœä¸€æ—¥æˆ‘ä¹Ÿèƒ½ç®€å•è¿ç»­å¼¹å‡ºä¸€äº›å–œæ¬¢çš„æ›²å­. è®¤è¯†é”®ç›˜ 88ä¸ªé”® = 52ä¸ªç™½é”® + 36ä¸ªé»‘é”®, ä¸€å…±åˆ†ä¸º7ä¸ªåŒº(octaves), åˆ†åŒº(C1-C7) è®¤è¯†äº”çº¿è°± ä¸»è¦è®°å½•ç€, è°±å·clef é«˜éŸ³è°±å·treble EGBDF(Every Great Band Draws Fans), FACE ä½éŸ³è°±å·bass GBDFA(Good Boy Does Fine Always), ACEG(All Cows Eat Grass) ä¸­éŸ³è°±å·alto çº¿line åŠ çº¿ledger é—´space åŠ é—´ æ‹å·time signature å®šä¹‰å°èŠ‚ä¸­çš„èŠ‚æ‹æ•°é‡ä»¥åŠéŸ³ç¬¦æ—¶å€¼çš„å…·ä½“æ‹æ•° e.g., 3/8æ‰€ä»£è¡¨çš„å«ä¹‰ä¸ºâ€ä»¥8åˆ†éŸ³ç¬¦ä¸º1æ‹, æ¯å°èŠ‚æœ‰3æ‹â€ å¼ºå¼±è§„å¾‹ æ‹å· feature 4/4æ‹ å¼º -&amp;gt; å¼± -&amp;gt; æ¬¡å¼º -&amp;gt; å¼± 3/4æ‹ å¼º -&amp;gt; å¼± -&amp;gt; å¼± 2/4æ‹ å¼º -&amp;gt; å¼± åˆ‡åˆ†èŠ‚å¥(è¿›é˜¶å¿…å¤‡?) æ²¡æœ‰æŒ‰ç…§4/4æ‹çš„å¼º -&amp;gt; å¼± -&amp;gt; æ¬¡å¼º -&amp;gt; å¼±æ¥èµ°, è€Œæ˜¯å¼± -&amp;gt; å¼º -&amp;gt; å¼± éŸ³ç¬¦note æ—¶å€¼duration, å°±æ˜¯å‡»é”®ä¸åœé¡¿çš„æ—¶é—´(èŠ‚å¥) note feature duration å…¨éŸ³ç¬¦ ç©ºå¿ƒç¬¦å¤´ 4æ‹ äºŒåˆ†éŸ³ç¬¦ ç©ºå¿ƒç¬¦å¤´ + ç¬¦å¹² 2æ‹ å››åˆ†éŸ³ç¬¦ å®å¿ƒç¬¦å¤´ + ç¬¦å¹² 1æ‹ å…«åˆ†éŸ³ç¬¦ å®å¿ƒç¬¦å¤´ + ç¬¦å¹² + ç¬¦å°¾ 1/2æ‹ åå…­åˆ†éŸ³ç¬¦ å®å¿ƒç¬¦å¤´ + ç¬¦å¹² + 2ç¬¦å°¾ 1/4æ‹ é™„ç‚¹äºŒåˆ†éŸ³ç¬¦ äºŒåˆ†éŸ³ç¬¦+ é™„ç‚¹ (2 + é™„ç‚¹çš„æ—¶å€¼æ˜¯å‰é¢éŸ³ç¬¦çš„1/2)=3æ‹ ä¼‘æ­¢ç¬¦ å€’æŒ‚äºç¬¬4çº¿ æ•´å°èŠ‚ äºŒåˆ†ä¼‘æ­¢ç¬¦ æ”¾åœ¨ç¬¬3çº¿ 2æ‹ å››åˆ†ä¼‘æ­¢ç¬¦ äººå½¢ 1æ‹ è¿éŸ³çº¿ æ‹±å½¢x-x, åªæŠ¬æ‰‹ä¸€æ¬¡, ä¸­é—´çš„æ‰€æœ‰éŸ³ç¬¦éƒ½æ˜¯æŠ¬æŒ‡ æ—¶å€¼æ˜¯ä¸¤è€…ç›¸åŠ  é™è®°å· å°–b å‡»å…¶å·¦è¾¹çš„1é”®(é™åŠéŸ³) å‡è®°å· å°–# å‡»å…¶å³è¾¹çš„1é”®(å‡åŠéŸ³) éŸ³ç¬¦è½é”® éŸ³ç¬¦åœ¨äº”çº¿è°±staffçš„ä½ç½® vs é”®ç›˜ä½ç½®(!) éŸ³ç¬¦noteåœ¨äº”çº¿è°±staffçš„ä½ç½® vs é”®ç›˜ä½ç½®(!!) éŸ³ç¬¦åœ¨äº”çº¿è°±çš„ä½ç½® vs é”®ç›˜ä½ç½®(!!!) æ‰‹æŒ‡ä½ç½® æ‰¾åˆ°å½“å‰éŸ³ç¬¦çš„è½é”®ä½ç½®ä¹‹å, å°±è¦åˆ¤æ–­ç”¨å“ªåªæ‰‹çš„å“ªæ ¹æŒ‡å¤´å»æ•²å‡», Cå¤§èª¿ä¸‹çš„æ‰‹æŒ‡æ‘†æ”¾layout. å·¦æ‰‹å°¾æŒ‡åœ¨C3, å³æ‰‹æ‹‡æŒ‡åœ¨C4 å„ç§è°ƒå·key signatureæ‰€å¯¹åº”çš„æ‰‹æŒ‡æ‘†æ”¾(æ‹‡æŒ‡æ°¸è¿œæ˜¯1, å°¾æŒ‡æ°¸è¿œæ˜¯5) ä¸Šå›¾å¯ä»¥çœ‹åˆ°, è½¬æŒ‡, ä¸€ä¸ªåˆ†åŒºæ˜¯7ä¸ªéŸ³, C -&amp;gt; D -&amp;gt; E -&amp;gt; F -&amp;gt; G -&amp;gt; A -&amp;gt; B -&amp;gt; C ä¸€å…±8ä¸ªéŸ³, å³ direction action sequence combine å¾€å³(ä¸Šè¡Œ) ä¸­æŒ‡å›ºå®š(ç¬¬3ä½), æ‹‡æŒ‡ç©¿è¶Š 1 -&amp;gt; 2 -&amp;gt; 3(å›ºå®š) -&amp;gt; 1(ç©¿è¶Š) -&amp;gt; 2 -&amp;gt; 3 -&amp;gt; 4 -&amp;gt; 5 3+5çš„æŒ‡æ³•ç»„åˆ å¾€å·¦(ä¸‹è¡Œ) æ‹‡æŒ‡å›ºå®š(ç¬¬5ä½), ä¸­æŒ‡ç©¿è¶Š 5 -&amp;gt; 4 -&amp;gt; 3 -&amp;gt; 2 -&amp;gt; 1(å›ºå®š) -&amp;gt; 3(ç©¿è¶Š) -&amp;gt; 2 -&amp;gt; 1 5+3çš„æŒ‡æ³•ç»„åˆ æ‰‹å‹è®­ç»ƒ, è„‘æµ·é‡Œæƒ³è±¡ç€æ‰‹æ¡ä½ç½‘çƒ è®­ç»ƒç´ æ è®¤è¯†éŸ³ç¬¦çš„è½é”® æŒ‡æ³• ç®€å•å³æ‰‹ç»ƒä¹ æ›² ç®€å•å·¦æ‰‹ç»ƒä¹ æ›² ç®€å•åŒæ‰‹ç»ƒä¹ æ›² Reference é›¶åŸºç¤å­¸é‹¼ç´ å›ã ã£ãŸã‚‰ piano è°ƒå· æ€æ ·è‡ªå­¦é’¢ç´ï¼Ÿ Piano and Keyboard All-in-One For Dummies</summary></entry><entry><title type="html">A simple book recommender</title><link href="http://localhost:4000/2020/05/28/00_book-recommender.html" rel="alternate" type="text/html" title="A simple book recommender" /><published>2020-05-28T00:00:00+08:00</published><updated>2020-05-28T00:00:00+08:00</updated><id>http://localhost:4000/2020/05/28/00_book-recommender</id><content type="html" xml:base="http://localhost:4000/2020/05/28/00_book-recommender.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘èµ·ç‚¹åˆåŒé—®é¢˜çº·çº·æ‰°æ‰°, ä¸æ­¤åŒæ—¶åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°åˆ«äººæ¨ä¹¦çš„post, å…¶ä¸­&lt;a href=&quot;https://www.tuishujun.com/&quot;&gt;æ¨ä¹¦å›ä½œè€…&lt;/a&gt;å›ç­”äº†ä¸€æ³¢, ç„¶åä¸‹é¢æœ‰ç½‘å‹æå‡ºä¸€äº›å»ºè®®, å½“ç„¶è¿˜æœ‰å…¶ä»–ç½‘å‹åŸºäºtaçš„è§è§£æ¥æ¨è.&lt;/p&gt;

&lt;p&gt;åœ¨å¤§æ•°æ®æ—¶ä»£, ä¿¡æ¯çˆ†ç‚¸, æˆ‘ä»¬è·å–ä¿¡æ¯çš„æ¸ é“ä¸»è¦é›†ä¸­äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä¸»åŠ¨æœç´¢(ç±»ä¼¼Google)&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;è¢«åŠ¨æ¨è(ç±»ä¼¼AD)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;æƒ³ç€æœ€è¿‘WFH, çœ‹çœ‹å¦‚æœè‡ªå·±æ¥å®ç°ä¸€ä¸ªbook/novelçš„æ¨èç³»ç»Ÿ, ä¼šæ˜¯æ€æ ·çš„ä¸€ä¸ªè¿‡ç¨‹. ä¸‹é¢è®°å½•ä¸€ä¸‹æœ¬æ¬¡æ¢ç´¢.&lt;/p&gt;

&lt;h1 id=&quot;ç´ æå‡†å¤‡&quot;&gt;ç´ æå‡†å¤‡&lt;/h1&gt;
&lt;p&gt;å…³äºæ¨è, è®°å¾—åˆšåˆšæ¯•ä¸šçš„æ—¶å€™çœ‹è¿‡ä¸€ç‚¹&lt;a href=&quot;https://blog.csdn.net/qq_35082030/article/details/75646595&quot;&gt;ååŒè¿‡æ»¤&lt;/a&gt;, ä¸»è¦æ˜¯ä¸¤å¤§ç±», ä¸€ç±»æ˜¯åŸºäºäºº, ä¸€ç±»æ˜¯åŸºäºç‰©,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;åŸºäºäºº, ç”²ä¹™ä¸¤äºº, ç°åœ¨å·²çŸ¥ç”²å–œæ¬¢ç‰©å“Aå’ŒB, è€Œä¹™å–œæ¬¢ç‰©å“A, ç”±æ­¤å¯ä»¥å¾—å‡º, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢ç‰©å“B(similar withç”², å¯èƒ½è¿™é‡Œç‰©å“æ ·æœ¬åªæœ‰2ä¸ª, å¶ç„¶æ€§ä¼šæ¯”è¾ƒå¤§; å¦‚æœç”²å–œæ¬¢1000ä¸ª, è€Œä¹™å–œæ¬¢äº†å…¶ä¸­çš„999ä¸ª, åªå‰©ä¸‹1ä¸ªæ²¡æœ‰è¢«ä¹™å–œæ¬¢, é‚£ä¹ˆå°†è¿™ä¸ªå‰©ä½™çš„1æ¨èç»™ä¹™, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢)&lt;/li&gt;
  &lt;li&gt;åŸºäºç‰©, å·²çŸ¥ç‰©å“Aå’ŒBè¢«ç»å¤§éƒ¨åˆ†äººå–œæ¬¢, è€Œç”²ç›®å‰åªæ˜¯å–œæ¬¢äº†ç‰©å“A(å¯èƒ½æ²¡æœ‰å‘ç°B), ç”±æ­¤å¯ä»¥å¾—å‡º, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢ç‰©å“B(similar with A, ç±»ä¼¼é”€é‡æ’åº, æ’è¡Œæ¦œ)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦‚æœåœ¨æ ·æœ¬è¶³å¤Ÿå¤šçš„æƒ…å†µ, æ„Ÿè§‰åŸºäºäººçš„recommendä¼šæ›´é è°±, è€Œå¯¹äºbook/novelè¿™ç§ç±»å‹, ä¹¦å•bookListæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ–æ˜æ–¹å¼. æ¯”å¦‚è¯´&lt;a href=&quot;https://book.douban.com/people/chenfh5/collect&quot;&gt;è±†ç“£æˆ‘è¯»è¿‡çš„ä¹¦å•&lt;/a&gt;, &lt;a href=&quot;https://book.qidian.com/booklist/&quot;&gt;èµ·ç‚¹ä¹¦å•&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;å½“æœ‰äº†è¿™äº›ç´ æä¹‹å, å°±å¯ä»¥ç€æ‰‹å®ç°ç®—æ³•.&lt;/p&gt;

&lt;h1 id=&quot;architect&quot;&gt;Architect&lt;/h1&gt;
&lt;p&gt;å…ˆæ¥çœ‹çœ‹æ€»ä½“ç»“æ„,
&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83434117-71bf3100-a46c-11ea-8c84-4d2f0764dc4e.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;a simple book recommender system&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ ¹æ®ç”¨æˆ·ç»™å®šçš„books, æ‰¾åˆ°è¿™äº›booksæ‰€å±çš„booklists, ç„¶åé€šè¿‡ç®—æ³•æ§åˆ¶è¿™äº›booklistsé‡Œé¢æ‰€æœ‰booksçš„weight, ä¹‹åå–TopKè¿”å›.&lt;/p&gt;

&lt;h2 id=&quot;fetcher&quot;&gt;Fetcher&lt;/h2&gt;
&lt;p&gt;ç½‘ç»œçˆ¬è™«, å› ä¸ºbooklistséƒ½æ˜¯å­˜åœ¨äºç½‘ä¸Š, æ‰€ä»¥éœ€è¦æ ¹æ®ç”¨æˆ·queryå®æ—¶çˆ¬å–web, ç„¶åè§£ææ‰€æœ‰booklists, ä¹‹åæŠ“å–å‡ºæ‰€æœ‰books. è¿™é‡Œæ ¹æ®ä¸ªäººç¼–ç¨‹å–œå¥½, é€‰æ‹©äº†&lt;a href=&quot;https://jsoup.org/&quot;&gt;jsoup&lt;/a&gt;è¿™ä¸ªHTML Parser, å› ä¸ºå…¶ä¸­çš„selectorsèƒ½å¤Ÿå¿«é€ŸæŠ“å–åˆ°æƒ³è¦çš„å…ƒç´ .&lt;/p&gt;

&lt;h3 id=&quot;promo&quot;&gt;Promo&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;å› ä¸ºbooklistsé‡Œé¢åŒ…æ‹¬äº†å¤§é‡çš„books(M), å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯å¤§é‡ç”¨æˆ·åˆ›å»ºäº†booklistè€Œå…¶bookliståˆšå¥½åŒ…å«å…¶ä¸­(N), è¿™æ ·ä¸€è†¨èƒ€å°±æ˜¯O(M*N)äº†. éå¸¸å®¹æ˜“é€ æˆhotspot. è¿™é‡Œé‡‡ç”¨äº†éšæœºæˆªæ–­å™¨(maxBookListSize and maxBookListContentSize). å°†è¿™ç§è†¨èƒ€åšäº†ä¸€äº›é™åˆ¶, å½“ç„¶ä¸èƒ½è·ŸDL-poolingç›¸æ¯”, ä½†æ˜¯å¤§æ¦‚æ˜¯ä¸€ç§æ–¹å‘, é˜²æ­¢è†¨èƒ€ä¸é˜²æ­¢è¿‡æ‹Ÿåˆè€Œé‡‡å–çš„å‰ªæ&lt;/li&gt;
  &lt;li&gt;å¤šçº¿ç¨‹ä¸é˜²çˆ¬proxy&lt;/li&gt;
  &lt;li&gt;å®šæœŸçˆ¬å–booklistsç„¶åå…¥localåº“, é¿å…ç½‘ç»œæ¶ˆè€—, å¢åŠ ååé‡, ç¨³å®šæ€§, å¯æ§æ€§&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;merger&quot;&gt;Merger&lt;/h2&gt;
&lt;p&gt;å½“æ‰€éœ€booklistséƒ½æŠ“å–è¿‡æ¥ä¹‹å, æ¥ä¸‹æ¥å°±æ˜¯merge, è¿™ä¸€æ­¥ç±»ä¼¼esçš„queryè¿‡ç¨‹, &lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#coordinating-node&quot;&gt;coordinator&lt;/a&gt;å°†queryè·¯ç”±åˆ°å¯¹åº”data-node, ç„¶ådata-nodeè¿”å›hitåˆ°coordinator, ç„¶åcoordinatorä½œæ±‡æ€»æ’åº.&lt;/p&gt;

&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯mergeçš„case class unboxing, ä¹Ÿå«&lt;a href=&quot;https://chenfh5.github.io/2019/05/07/01_scala-ADT.html&quot;&gt;ADT&lt;/a&gt;. å°†å„ä¸ªbooklistsçš„book assign weightä¹‹å, ç„¶åmerge.&lt;/p&gt;

&lt;p&gt;è¿™é‡Œassign weightæ˜¯å…¨ç³»ç»Ÿæœ€å…³é”®ç‚¹, å…³ç³»ç€æ¨èè´¨é‡, ç›®å‰é‡‡ç”¨äº†å…¨è¦†ç›–çš„æ–¹å¼, å³booklistä¸­åŒ…å«äº†ç”¨æˆ·æ‰€æœ‰è¾“å…¥bookçš„è¯, é‚£ä¹ˆè¯¥booklistä¸­æ‰€æœ‰bookséƒ½å‡æƒ. åä¹‹ç»´æŒåŸæ ·. (åˆ†é…)&lt;/p&gt;

&lt;p&gt;åˆ†é…å¥½ä¹‹åå°±æ˜¯åˆå¹¶, ç›®å‰åˆå¹¶æ˜¯bookä¸bookçš„weightç›´æ¥ç›¸åŠ . (åˆå¹¶)&lt;/p&gt;

&lt;h3 id=&quot;promo-1&quot;&gt;Promo&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;æƒé‡åˆ†é…ç®—æ³•&lt;/li&gt;
  &lt;li&gt;æƒé‡åˆå¹¶ç®—æ³•&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ranker&quot;&gt;Ranker&lt;/h2&gt;
&lt;p&gt;å½“åˆ†é…ä¸åˆå¹¶å¥½æ¯æœ¬ä¹¦ä¸åŸä¹¦çš„ç›¸ä¼¼åº¦weightä¹‹å, ç›´æ¥è¿”å›topK.&lt;/p&gt;

&lt;h2 id=&quot;http-server&quot;&gt;Http Server&lt;/h2&gt;
&lt;p&gt;åŸºäº&lt;a href=&quot;https://javaee.github.io/grizzly/httpserverframework.html&quot;&gt;Grizzly&lt;/a&gt;æ­å»ºäº†http server.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83148380-795c9e00-a12b-11ea-86ad-9e7a0298a2a5.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;http call (70s, too slow)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;promo-2&quot;&gt;Promo&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/59116615&quot;&gt;LRUCache&lt;/a&gt;
  &lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83148518-a610b580-a12b-11ea-9a85-340a96963041.png&quot; alt=&quot;image&quot; /&gt;
    &lt;blockquote&gt;
      &lt;p&gt;cache&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;other&quot;&gt;Other&lt;/h2&gt;
&lt;p&gt;è‡³æ­¤, jaråŒ…å·²ç»æ‰“å¥½, åç»­å°±æ˜¯&lt;a href=&quot;https://blog.csdn.net/Xuesong_2015/article/details/79021659&quot;&gt;å‘å¸ƒéƒ¨ç½²&lt;/a&gt;, æš´éœ²æ¥å£ä¾›ç”¨æˆ·è¿›è¡Œè°ƒç”¨.
&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83148026-03f0cd80-a12b-11ea-96aa-c322799e1bbc.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;promo-3&quot;&gt;Promo&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;å¼€å‘å‰ç«¯å±•ç¤ºä¸äº¤äº’, html, css, js&lt;/li&gt;
  &lt;li&gt;load balance&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;åè®°&quot;&gt;åè®°&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;ç½‘ç»œä¸–ç•Œå¾ˆä¸°é¥¶, å½“ç„¶è¿™ä¹ŸåŸ‹æ²¡äº†ä¸€å®šé‡çš„å¥½ä½œå“, è‡ªå·±ä¸€ä¸ªäººçš„åŠ›é‡æ˜¯éå¸¸æœ‰é™çš„, å³ä¾¿Googleçš„rankå·²ç»å°†æœ€é«˜ç›¸ä¼¼åº¦è¿”å›äº†, ä½†è¿™ä¸ªç›¸è¯†åº¦æ›´ç±»ä¼¼ä¸tf/idfå’Œå‡ºå…¥åº¦, ä¸»è¦é›†ä¸­åœ¨keywordçš„å‘½ä¸­å’Œç½‘é¡µçš„æƒé‡&lt;/li&gt;
  &lt;li&gt;é€šè¿‡crawler, ä¸ªäººå¯ä»¥å°†å½¼æ­¤çš„å¤§é‡ç½‘ç»œæ•°æ®çˆ¬å–å‡ºæ¥, åŠ ä¹‹åˆ©ç”¨å³å¯å®šåˆ¶åŒ–è‡ªå·±çš„æŸ¥æ‰¾ç­–ç•¥å’Œä¾§é‡, æ¯”å¦‚ä¹¦å•, å½±å•, æ­Œå•, stockList(è¿‡äº†:bowtie:, æŠ•èµ„æœ‰é£é™©)&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;reference&quot;&gt;Reference&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://jsoup.org/&quot;&gt;jsoup: Java HTML Parser&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.lihaoyi.com/post/ScrapingWebsitesusingScalaandJsoup.html&quot;&gt;Scraping Websites using Scala and Jsoup&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/wtog/web-crawler&quot;&gt;wtog-web-crawler&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/chenfh5/a-simple-book-recommender&quot;&gt;source code&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="architect" /><category term="recommender-systems" /><summary type="html">Overview æœ€è¿‘èµ·ç‚¹åˆåŒé—®é¢˜çº·çº·æ‰°æ‰°, ä¸æ­¤åŒæ—¶åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°åˆ«äººæ¨ä¹¦çš„post, å…¶ä¸­æ¨ä¹¦å›ä½œè€…å›ç­”äº†ä¸€æ³¢, ç„¶åä¸‹é¢æœ‰ç½‘å‹æå‡ºä¸€äº›å»ºè®®, å½“ç„¶è¿˜æœ‰å…¶ä»–ç½‘å‹åŸºäºtaçš„è§è§£æ¥æ¨è. åœ¨å¤§æ•°æ®æ—¶ä»£, ä¿¡æ¯çˆ†ç‚¸, æˆ‘ä»¬è·å–ä¿¡æ¯çš„æ¸ é“ä¸»è¦é›†ä¸­äºä¸»åŠ¨æœç´¢(ç±»ä¼¼Google)å’Œè¢«åŠ¨æ¨è(ç±»ä¼¼AD). æƒ³ç€æœ€è¿‘WFH, çœ‹çœ‹å¦‚æœè‡ªå·±æ¥å®ç°ä¸€ä¸ªbook/novelçš„æ¨èç³»ç»Ÿ, ä¼šæ˜¯æ€æ ·çš„ä¸€ä¸ªè¿‡ç¨‹. ä¸‹é¢è®°å½•ä¸€ä¸‹æœ¬æ¬¡æ¢ç´¢. ç´ æå‡†å¤‡ å…³äºæ¨è, è®°å¾—åˆšåˆšæ¯•ä¸šçš„æ—¶å€™çœ‹è¿‡ä¸€ç‚¹ååŒè¿‡æ»¤, ä¸»è¦æ˜¯ä¸¤å¤§ç±», ä¸€ç±»æ˜¯åŸºäºäºº, ä¸€ç±»æ˜¯åŸºäºç‰©, åŸºäºäºº, ç”²ä¹™ä¸¤äºº, ç°åœ¨å·²çŸ¥ç”²å–œæ¬¢ç‰©å“Aå’ŒB, è€Œä¹™å–œæ¬¢ç‰©å“A, ç”±æ­¤å¯ä»¥å¾—å‡º, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢ç‰©å“B(similar withç”², å¯èƒ½è¿™é‡Œç‰©å“æ ·æœ¬åªæœ‰2ä¸ª, å¶ç„¶æ€§ä¼šæ¯”è¾ƒå¤§; å¦‚æœç”²å–œæ¬¢1000ä¸ª, è€Œä¹™å–œæ¬¢äº†å…¶ä¸­çš„999ä¸ª, åªå‰©ä¸‹1ä¸ªæ²¡æœ‰è¢«ä¹™å–œæ¬¢, é‚£ä¹ˆå°†è¿™ä¸ªå‰©ä½™çš„1æ¨èç»™ä¹™, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢) åŸºäºç‰©, å·²çŸ¥ç‰©å“Aå’ŒBè¢«ç»å¤§éƒ¨åˆ†äººå–œæ¬¢, è€Œç”²ç›®å‰åªæ˜¯å–œæ¬¢äº†ç‰©å“A(å¯èƒ½æ²¡æœ‰å‘ç°B), ç”±æ­¤å¯ä»¥å¾—å‡º, ä¹™å¤§æ¦‚ç‡ä¼šå–œæ¬¢ç‰©å“B(similar with A, ç±»ä¼¼é”€é‡æ’åº, æ’è¡Œæ¦œ) å¦‚æœåœ¨æ ·æœ¬è¶³å¤Ÿå¤šçš„æƒ…å†µ, æ„Ÿè§‰åŸºäºäººçš„recommendä¼šæ›´é è°±, è€Œå¯¹äºbook/novelè¿™ç§ç±»å‹, ä¹¦å•bookListæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ–æ˜æ–¹å¼. æ¯”å¦‚è¯´è±†ç“£æˆ‘è¯»è¿‡çš„ä¹¦å•, èµ·ç‚¹ä¹¦å•. å½“æœ‰äº†è¿™äº›ç´ æä¹‹å, å°±å¯ä»¥ç€æ‰‹å®ç°ç®—æ³•. Architect å…ˆæ¥çœ‹çœ‹æ€»ä½“ç»“æ„, a simple book recommender system æ ¹æ®ç”¨æˆ·ç»™å®šçš„books, æ‰¾åˆ°è¿™äº›booksæ‰€å±çš„booklists, ç„¶åé€šè¿‡ç®—æ³•æ§åˆ¶è¿™äº›booklistsé‡Œé¢æ‰€æœ‰booksçš„weight, ä¹‹åå–TopKè¿”å›. Fetcher ç½‘ç»œçˆ¬è™«, å› ä¸ºbooklistséƒ½æ˜¯å­˜åœ¨äºç½‘ä¸Š, æ‰€ä»¥éœ€è¦æ ¹æ®ç”¨æˆ·queryå®æ—¶çˆ¬å–web, ç„¶åè§£ææ‰€æœ‰booklists, ä¹‹åæŠ“å–å‡ºæ‰€æœ‰books. è¿™é‡Œæ ¹æ®ä¸ªäººç¼–ç¨‹å–œå¥½, é€‰æ‹©äº†jsoupè¿™ä¸ªHTML Parser, å› ä¸ºå…¶ä¸­çš„selectorsèƒ½å¤Ÿå¿«é€ŸæŠ“å–åˆ°æƒ³è¦çš„å…ƒç´ . Promo å› ä¸ºbooklistsé‡Œé¢åŒ…æ‹¬äº†å¤§é‡çš„books(M), å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯å¤§é‡ç”¨æˆ·åˆ›å»ºäº†booklistè€Œå…¶bookliståˆšå¥½åŒ…å«å…¶ä¸­(N), è¿™æ ·ä¸€è†¨èƒ€å°±æ˜¯O(M*N)äº†. éå¸¸å®¹æ˜“é€ æˆhotspot. è¿™é‡Œé‡‡ç”¨äº†éšæœºæˆªæ–­å™¨(maxBookListSize and maxBookListContentSize). å°†è¿™ç§è†¨èƒ€åšäº†ä¸€äº›é™åˆ¶, å½“ç„¶ä¸èƒ½è·ŸDL-poolingç›¸æ¯”, ä½†æ˜¯å¤§æ¦‚æ˜¯ä¸€ç§æ–¹å‘, é˜²æ­¢è†¨èƒ€ä¸é˜²æ­¢è¿‡æ‹Ÿåˆè€Œé‡‡å–çš„å‰ªæ å¤šçº¿ç¨‹ä¸é˜²çˆ¬proxy å®šæœŸçˆ¬å–booklistsç„¶åå…¥localåº“, é¿å…ç½‘ç»œæ¶ˆè€—, å¢åŠ ååé‡, ç¨³å®šæ€§, å¯æ§æ€§ Merger å½“æ‰€éœ€booklistséƒ½æŠ“å–è¿‡æ¥ä¹‹å, æ¥ä¸‹æ¥å°±æ˜¯merge, è¿™ä¸€æ­¥ç±»ä¼¼esçš„queryè¿‡ç¨‹, coordinatorå°†queryè·¯ç”±åˆ°å¯¹åº”data-node, ç„¶ådata-nodeè¿”å›hitåˆ°coordinator, ç„¶åcoordinatorä½œæ±‡æ€»æ’åº. è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯mergeçš„case class unboxing, ä¹Ÿå«ADT. å°†å„ä¸ªbooklistsçš„book assign weightä¹‹å, ç„¶åmerge. è¿™é‡Œassign weightæ˜¯å…¨ç³»ç»Ÿæœ€å…³é”®ç‚¹, å…³ç³»ç€æ¨èè´¨é‡, ç›®å‰é‡‡ç”¨äº†å…¨è¦†ç›–çš„æ–¹å¼, å³booklistä¸­åŒ…å«äº†ç”¨æˆ·æ‰€æœ‰è¾“å…¥bookçš„è¯, é‚£ä¹ˆè¯¥booklistä¸­æ‰€æœ‰bookséƒ½å‡æƒ. åä¹‹ç»´æŒåŸæ ·. (åˆ†é…) åˆ†é…å¥½ä¹‹åå°±æ˜¯åˆå¹¶, ç›®å‰åˆå¹¶æ˜¯bookä¸bookçš„weightç›´æ¥ç›¸åŠ . (åˆå¹¶) Promo æƒé‡åˆ†é…ç®—æ³• æƒé‡åˆå¹¶ç®—æ³• Ranker å½“åˆ†é…ä¸åˆå¹¶å¥½æ¯æœ¬ä¹¦ä¸åŸä¹¦çš„ç›¸ä¼¼åº¦weightä¹‹å, ç›´æ¥è¿”å›topK. Http Server åŸºäºGrizzlyæ­å»ºäº†http server. http call (70s, too slow) Promo LRUCache cache Other è‡³æ­¤, jaråŒ…å·²ç»æ‰“å¥½, åç»­å°±æ˜¯å‘å¸ƒéƒ¨ç½², æš´éœ²æ¥å£ä¾›ç”¨æˆ·è¿›è¡Œè°ƒç”¨. Promo å¼€å‘å‰ç«¯å±•ç¤ºä¸äº¤äº’, html, css, js load balance åè®° ç½‘ç»œä¸–ç•Œå¾ˆä¸°é¥¶, å½“ç„¶è¿™ä¹ŸåŸ‹æ²¡äº†ä¸€å®šé‡çš„å¥½ä½œå“, è‡ªå·±ä¸€ä¸ªäººçš„åŠ›é‡æ˜¯éå¸¸æœ‰é™çš„, å³ä¾¿Googleçš„rankå·²ç»å°†æœ€é«˜ç›¸ä¼¼åº¦è¿”å›äº†, ä½†è¿™ä¸ªç›¸è¯†åº¦æ›´ç±»ä¼¼ä¸tf/idfå’Œå‡ºå…¥åº¦, ä¸»è¦é›†ä¸­åœ¨keywordçš„å‘½ä¸­å’Œç½‘é¡µçš„æƒé‡ é€šè¿‡crawler, ä¸ªäººå¯ä»¥å°†å½¼æ­¤çš„å¤§é‡ç½‘ç»œæ•°æ®çˆ¬å–å‡ºæ¥, åŠ ä¹‹åˆ©ç”¨å³å¯å®šåˆ¶åŒ–è‡ªå·±çš„æŸ¥æ‰¾ç­–ç•¥å’Œä¾§é‡, æ¯”å¦‚ä¹¦å•, å½±å•, æ­Œå•, stockList(è¿‡äº†:bowtie:, æŠ•èµ„æœ‰é£é™©) Reference jsoup: Java HTML Parser Scraping Websites using Scala and Jsoup wtog-web-crawler source code</summary></entry><entry><title type="html">One Stack Big Data Platform</title><link href="http://localhost:4000/2020/05/02/00_big-data-one-stack.html" rel="alternate" type="text/html" title="One Stack Big Data Platform" /><published>2020-05-02T00:00:00+08:00</published><updated>2020-05-02T00:00:00+08:00</updated><id>http://localhost:4000/2020/05/02/00_big-data-one-stack</id><content type="html" xml:base="http://localhost:4000/2020/05/02/00_big-data-one-stack.html">&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;
&lt;p&gt;åˆ†å¸ƒå¼æœ¬è´¨è®º: é«˜åå(high throughput), é«˜å¯ç”¨(high available), ä½å»¶è¿Ÿ(low latency), å¯æ‰©å±•(high scalability).&lt;/p&gt;

&lt;p&gt;æ•´åˆä¸€ä¸‹ä¸ªäººå¯¹äºå¤§æ•°æ®å¹³å°, æ•°æ®ä¸­å°, æ•°æ®ä»“åº“çš„æŠ€æœ¯æ ˆ, è¿™é‡Œæœ‰ä¸€ä¸ªå®ƒä»¬ä¹‹é—´å·®å¼‚çš„&lt;a href=&quot;https://www.zhihu.com/question/282421879&quot;&gt;å›ç­”&lt;/a&gt;,&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;æ•°æ®åº“é˜¶æ®µ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ä¸»è¦æ˜¯OLTP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;è”æœºäº‹åŠ¡å¤„ç†&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;çš„éœ€æ±‚&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;æ•°æ®ä»“åº“é˜¶æ®µ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OLAP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;è”æœºåˆ†æå¤„ç†&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;æˆä¸ºä¸»è¦éœ€æ±‚&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;æ•°æ®å¹³å°é˜¶æ®µ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ä¸»è¦è§£å†³BIå’ŒæŠ¥è¡¨éœ€æ±‚çš„æŠ€æœ¯é—®é¢˜&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;æ•°æ®ä¸­å°é˜¶æ®µ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;é€šè¿‡ç³»ç»Ÿæ¥å¯¹æ¥OLTPå’ŒOLAPçš„éœ€æ±‚&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;å¼ºè°ƒæ•°æ®ä¸šåŠ¡åŒ–çš„èƒ½åŠ›&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶, ä¸»è¦çœ‹å…·ä½“ä¸šåŠ¡éœ€æ±‚, ä¸€åˆ‡è„±ç¦»ä¸šåŠ¡çš„æ¶æ„éƒ½æ˜¯è€æµæ°“. ä¸šåŠ¡å¼€å±•åˆ°å“ªé‡Œ, æ¶æ„ä¹Ÿè¦è·Ÿç€å¹¶å»¶å±•äº›.&lt;/p&gt;

&lt;p&gt;å¦å¤–, æœ‰äº›æ¡†æ¶ç»è¿‡å¤šå¹´çš„å‘å±•, å·²ç»è„±ç¦»äº†å•ä¸€çš„æŠ€æœ¯èŒƒç•´, å‘ç€å¤šå…ƒåŒ–çš„ç”Ÿæ€åœˆå‘å±•. å½“ç„¶è¿™ä¹Ÿæ˜¯å›´åŸå’Œå£å’.&lt;/p&gt;

&lt;h1 id=&quot;structure&quot;&gt;Structure&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªä¸å¤§å®Œå–„çš„æ•°æ®æ ˆå›¾, ä¸­å°å¯ä»¥åœ¨æ­¤ä¹‹ä¸Šåšæ‰©å±•. 
&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/83434218-9f0bdf00-a46c-11ea-94a4-5459487f65cd.png&quot; alt=&quot;db Arch&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;data-collection&quot;&gt;data collection&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80909688-bf0c8d80-8d5c-11ea-94d4-8201c9142540.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;flume(2011): é‡‡ç”¨äº‹åŠ¡æ¥ç¡®ä¿eventå¯é æ€§, ç”±sinkæ¥ç¡®è®¤æ˜¯å¦remove channelé‡Œçš„event, via apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80910187-5c1cf580-8d60-11ea-825e-567cbf8f68e7.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;libbeat(2015): é€šè¿‡Scan()æ¥ç¡®è®¤æ–°å¢file, ç„¶åä¸ºå…¶newä¸€ä¸ªharvesterå‘é€åˆ°libbeatåšèšåˆ, via elastic&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;reference&quot;&gt;Reference&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://flume.apache.org/FlumeUserGuide.html#reliability&quot;&gt;apache flume reliability&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-overview.html&quot;&gt;filebeat-overview&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.jianshu.com/p/6282b04fe06a&quot;&gt;filebeatå·¥ä½œåŸç†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;data-storageraw&quot;&gt;data storage(raw)&lt;/h2&gt;
&lt;h3 id=&quot;batch&quot;&gt;batch&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80858795-4b9c4a80-8c8e-11ea-8460-b8757875979c.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;hdfs(2006): åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, é€šè¿‡master-slaveå’Œreplicaæœºåˆ¶æ¥ä½æˆæœ¬é«˜å¯é åœ°å­˜å‚¨æ•°æ®. via bigintellects&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;stream&quot;&gt;stream&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80914484-74037200-8d7e-11ea-9834-8be306c7777d.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;kafka(2011): file system cache, &lt;a href=&quot;https://zhuanlan.zhihu.com/p/78335525&quot;&gt;zero copy&lt;/a&gt;(å†…æ ¸æ€), é¡ºåºå†™ç£ç›˜. via dataflair&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80863711-b199c980-8cb0-11ea-92f0-e89715b259f1.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;pulsar(2016): å°†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;æ— çŠ¶æ€çš„æ¶ˆæ¯æœåŠ¡å±‚broker&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;æœ‰çŠ¶æ€çš„æ¶ˆæ¯æŒä¹…å±‚bookkeeper&lt;/code&gt;åˆ†ç¦», æ— çŠ¶æ€å¯ä»¥éšæ—¶å¢åˆ , è€Œæœ‰çŠ¶æ€å´é€šè¿‡replica segmentæ¥åšHAï¼›å½“ç„¶è¿˜æœ‰scale out. via streamthoughts&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;reference-1&quot;&gt;Reference&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jouypub.com/2019/8b02bd00f40ccf93019a317ee7d34081/&quot;&gt;æŠ€æœ¯æ¶æ„åŠé€‰å‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.allthingsdistributed.com/2007/10/amazons_dynamo.html&quot;&gt;Dynamo: Amazonâ€™s Highly Available Key-value Store&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://lxkaka.wang/2019/03/25/pulsar/&quot;&gt;Pulsar(æ–°ä¸€ä»£é«˜æ€§èƒ½æ¶ˆæ¯ç³»ç»Ÿ)æ ¸å¿ƒæ€»ç»“&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://matt33.com/2019/01/28/bk-store-realize/&quot;&gt;BookKeeper åŸç†æµ…è°ˆ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.splunk.com/en_us/blog/it/comparing-pulsar-and-kafka-how-a-segment-based-architecture-delivers-better-performance-scalability-and-resilience.html&quot;&gt;Comparing Pulsar and Kafka&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jack-vanlightly.com/blog/2018/10/2/understanding-how-apache-pulsar-works&quot;&gt;Understanding How Apache Pulsar Works&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;data-compute&quot;&gt;data compute&lt;/h2&gt;
&lt;h3 id=&quot;batch-1&quot;&gt;batch&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80911284-f2084e80-8d67-11ea-9423-b077913c1f31.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;spark(2014): lambda(batch-streamåˆ†ç¦»), master-slave, rdd, lineage, persist, via 0x0fff&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81182974-20449300-8fe1-11ea-9a7d-0e54c121f19a.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;airflow(2015): high scalability, HA, UI manage, via clairvoyantsoft&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80914120-27b73280-8d7c-11ea-917d-2562d18a8fa1.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;oozie(2011): serverä¸computeåˆ†ç¦», multilayer(bundle), HA, via devstacks&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿™é‡Œscheduleréƒ½æ˜¯é€šè¿‡å¤šserveræ¥é¿å…SPOF, è€Œå¤šserverä¹‹é—´çš„çŠ¶æ€åŒæ­¥æ˜¯é€šè¿‡DB(ZK)æ¥ä¼ é€’.&lt;/p&gt;

&lt;p&gt;æœ‰åˆ«äºå¸¸è§„çš„å¤šserver leader-standbyæ¨¡å¼(eg., kafka broker, DBä¸»ä»å¤åˆ¶)&lt;/p&gt;

&lt;h3 id=&quot;stream-1&quot;&gt;stream&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80914587-fbe97c00-8d7e-11ea-8ed2-ac19aaab9eb7.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;flink(2011): kappa, master-slave, &lt;a href=&quot;https://juejin.im/post/5c87dbdbe51d45494c77d607&quot;&gt;state&lt;/a&gt;, window, cp, via apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;reference-2&quot;&gt;Reference&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://site.clairvoyantsoft.com/tag/high-availability/&quot;&gt;Making Apache Airflow Highly Available&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://devstacks.wordpress.com/2017/02/16/oozie-architecture-and-job-scheduling/&quot;&gt;Oozie Architecture and Job Scheduling&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://ask.hellobi.com/blog/Beckham/12290&quot;&gt;Lambdaæ¶æ„ vs Kappaæ¶æ„&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.jianshu.com/p/4d31d6cddc99&quot;&gt;Flinkâ€“Checkpointæœºåˆ¶åŸç†&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.jianshu.com/p/8d6569361999&quot;&gt;ä¸€æ–‡ææ‡‚Flinkå†…éƒ¨çš„Exactly Onceå’ŒAt Least Once&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;data-storage&quot;&gt;data storage&lt;/h2&gt;
&lt;h3 id=&quot;in-memory&quot;&gt;in-memory&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80949680-0cedc800-8e27-11ea-9340-5d5640e84fa1.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;redis(2009): mem-base, éé˜»å¡å¤šè·¯IOå¤ç”¨, äº‹åŠ¡, proactive expire, HA(sentinel), throughput(cluster), via redislabs&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80974537-6ff55400-8e53-11ea-9e19-5f1882af7044.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ignite(2015): åˆ†å¸ƒå¼, KV, mem-disk SQL, 2PCäº‹åŠ¡, æ•°æ®æœ¬åœ°æ€§, via apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;timeseries&quot;&gt;timeseries&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81039960-e0948300-8edc-11ea-9f48-bd0edb27089d.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;influxdb(2013): TSM, TSI, WAL/cache, rp, via hbasefly&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;full-text&quot;&gt;full-text&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81048644-4be75080-8eef-11ea-8363-0944312525da.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;es(2010): master-data, zen discovery , replica, LSM, full text&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;molap&quot;&gt;MOLAP&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81054993-64109d00-8efa-11ea-977b-32b0b3403bbe.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;kylin(2013): é¢„è®¡ç®—cube, SQL, high scalability, MR, via apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81068339-cb3a4b80-8f12-11ea-83d5-f9e8dd91b3ed.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;druid(2011), role separate(master-query-data), LSM, via apache&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;rolap&quot;&gt;ROLAP&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81143961-aa6f0600-8fa5-11ea-8249-29919a76d3e6.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;clickhouse(2016): russia, column oriented, SQL, ä¸»å¤‡å¤åˆ¶, index(primary key sort), table engine, via altinity&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81159496-99c98a80-8fbb-11ea-88d6-0bc23c94aaa5.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;greenplum(2015): master-slave, &lt;a href=&quot;https://github.com/digoal/blog/blob/master/201708/20170818_02.md&quot;&gt;append-optimized&lt;/a&gt;, SQL, resource queue, via researchgate&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80951231-0f9dec80-8e2a-11ea-9091-f2c9ea3ef920.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;tidb(2017): åˆ†å¸ƒå¼, SQL, raft, LSM, mysql alternative, via pingcap&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;query-engine&quot;&gt;query engine&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81101961-78c45380-8f41-11ea-83c9-1c6e73bde07f.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;presto(2013): master-slave, mem-base MPP, SQL, connector, via slideshare&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/80785361-96e12b00-8bb2-11ea-9f20-a1e9cc526dae.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;sparksql(2014): catalyst, cost base, rdd, via dataflair&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81178389-b0cba500-8fda-11ea-9bbc-c1b8542701f6.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;hive(2010): SQL, MR, metadata, via andr83&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81178977-97772880-8fdb-11ea-9707-97b4f25c3f1b.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;pig(2008): pig latin, MR, via dezyre&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;graph&quot;&gt;graph&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/8369671/81493837-6f870e00-92d6-11ea-8407-65ad14a2426f.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;neo4j(2007): å®šé•¿è®°å½•ç»“æ„, cypher, HA, via slideshare&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;reference-3&quot;&gt;Reference&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/28594409&quot;&gt;IOå¤šè·¯å¤ç”¨æŠ€æœ¯(multiplexing)æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/37271342&quot;&gt;ä¸ºä»€ä¹ˆIOå¤šè·¯å¤ç”¨è¦æ­é…éé˜»å¡ IO?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/tgzhu/p/9984170.html&quot;&gt;Ignite(äºŒ): æ¶æ„åŠå·¥å…·&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/24900322&quot;&gt;æ•°æ®åº“å¦‚ä½•ç”¨ WAL ä¿è¯äº‹åŠ¡ä¸€è‡´æ€§ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.elastic.co/blog/every-shard-deserves-a-home&quot;&gt;Every shard deserves a home&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://qbox.io/blog/refresh-flush-operations-elasticsearch-guide&quot;&gt;Guide to Refresh and Flush Operations in Elasticsearch&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://juejin.im/post/5bc4979a5188255c451ed5a0&quot;&gt;Apache Kylin å…¥é—¨ 2 - åŸç†ä¸æ¶æ„&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/lihaozong2013/p/11655594.html&quot;&gt;apache druidæ¶æ„ã€åŸç†ã€æ‰§è¡Œæµç¨‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/67068975&quot;&gt;æ•°æ®ç»“æ„ç¯‡â€”-B+æ ‘ä¸LSMæ ‘æµ…æ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.aliyun.com/article/739801&quot;&gt;ClickHouseè¡¨å¼•æ“åˆ°åº•æ€ä¹ˆé€‰&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pingcap.com/docs-cn/stable/architecture/&quot;&gt;TiDBæ•´ä½“æ¶æ„&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://prestosql.io/Presto_SQL_on_Everything.pdf&quot;&gt;Presto: SQL on Everything&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://my.oschina.net/hblt147/blog/3006435#h3_13&quot;&gt;Prestoæ¶æ„åŠåŸç†ã€å®‰è£…åŠéƒ¨ç½²&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://chenfh5.github.io/2018/03/11/spark-sql-catalyst.html&quot;&gt;Spark SQL Catalystä¼˜åŒ–å™¨&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.quora.com/What-is-Hive-Metastore&quot;&gt;What is Hive Metastore?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/Regan_Hoo/article/details/78772479&quot;&gt;Neo4j_é«˜å±‚æ¶æ„å’Œåº”ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;data-analytics&quot;&gt;data analytics&lt;/h2&gt;
&lt;h3 id=&quot;bi&quot;&gt;BI&lt;/h3&gt;
&lt;p&gt;TODO&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;TODO&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="architect" /><summary type="html">Overview åˆ†å¸ƒå¼æœ¬è´¨è®º: é«˜åå(high throughput), é«˜å¯ç”¨(high available), ä½å»¶è¿Ÿ(low latency), å¯æ‰©å±•(high scalability). æ•´åˆä¸€ä¸‹ä¸ªäººå¯¹äºå¤§æ•°æ®å¹³å°, æ•°æ®ä¸­å°, æ•°æ®ä»“åº“çš„æŠ€æœ¯æ ˆ, è¿™é‡Œæœ‰ä¸€ä¸ªå®ƒä»¬ä¹‹é—´å·®å¼‚çš„å›ç­”, - æ•°æ®åº“é˜¶æ®µ, ä¸»è¦æ˜¯OLTP(è”æœºäº‹åŠ¡å¤„ç†)çš„éœ€æ±‚ - æ•°æ®ä»“åº“é˜¶æ®µ, OLAP(è”æœºåˆ†æå¤„ç†)æˆä¸ºä¸»è¦éœ€æ±‚ - æ•°æ®å¹³å°é˜¶æ®µ, ä¸»è¦è§£å†³BIå’ŒæŠ¥è¡¨éœ€æ±‚çš„æŠ€æœ¯é—®é¢˜ - æ•°æ®ä¸­å°é˜¶æ®µ, é€šè¿‡ç³»ç»Ÿæ¥å¯¹æ¥OLTPå’ŒOLAPçš„éœ€æ±‚, å¼ºè°ƒæ•°æ®ä¸šåŠ¡åŒ–çš„èƒ½åŠ› å½“ç„¶, ä¸»è¦çœ‹å…·ä½“ä¸šåŠ¡éœ€æ±‚, ä¸€åˆ‡è„±ç¦»ä¸šåŠ¡çš„æ¶æ„éƒ½æ˜¯è€æµæ°“. ä¸šåŠ¡å¼€å±•åˆ°å“ªé‡Œ, æ¶æ„ä¹Ÿè¦è·Ÿç€å¹¶å»¶å±•äº›. å¦å¤–, æœ‰äº›æ¡†æ¶ç»è¿‡å¤šå¹´çš„å‘å±•, å·²ç»è„±ç¦»äº†å•ä¸€çš„æŠ€æœ¯èŒƒç•´, å‘ç€å¤šå…ƒåŒ–çš„ç”Ÿæ€åœˆå‘å±•. å½“ç„¶è¿™ä¹Ÿæ˜¯å›´åŸå’Œå£å’. Structure ä¸‹é¢æ˜¯ä¸€ä¸ªä¸å¤§å®Œå–„çš„æ•°æ®æ ˆå›¾, ä¸­å°å¯ä»¥åœ¨æ­¤ä¹‹ä¸Šåšæ‰©å±•. data collection flume(2011): é‡‡ç”¨äº‹åŠ¡æ¥ç¡®ä¿eventå¯é æ€§, ç”±sinkæ¥ç¡®è®¤æ˜¯å¦remove channelé‡Œçš„event, via apache libbeat(2015): é€šè¿‡Scan()æ¥ç¡®è®¤æ–°å¢file, ç„¶åä¸ºå…¶newä¸€ä¸ªharvesterå‘é€åˆ°libbeatåšèšåˆ, via elastic Reference apache flume reliability filebeat-overview filebeatå·¥ä½œåŸç† data storage(raw) batch hdfs(2006): åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, é€šè¿‡master-slaveå’Œreplicaæœºåˆ¶æ¥ä½æˆæœ¬é«˜å¯é åœ°å­˜å‚¨æ•°æ®. via bigintellects stream kafka(2011): file system cache, zero copy(å†…æ ¸æ€), é¡ºåºå†™ç£ç›˜. via dataflair pulsar(2016): å°†æ— çŠ¶æ€çš„æ¶ˆæ¯æœåŠ¡å±‚brokerå’Œæœ‰çŠ¶æ€çš„æ¶ˆæ¯æŒä¹…å±‚bookkeeperåˆ†ç¦», æ— çŠ¶æ€å¯ä»¥éšæ—¶å¢åˆ , è€Œæœ‰çŠ¶æ€å´é€šè¿‡replica segmentæ¥åšHAï¼›å½“ç„¶è¿˜æœ‰scale out. via streamthoughts Reference æŠ€æœ¯æ¶æ„åŠé€‰å‹ Dynamo: Amazonâ€™s Highly Available Key-value Store Pulsar(æ–°ä¸€ä»£é«˜æ€§èƒ½æ¶ˆæ¯ç³»ç»Ÿ)æ ¸å¿ƒæ€»ç»“ BookKeeper åŸç†æµ…è°ˆ Comparing Pulsar and Kafka Understanding How Apache Pulsar Works data compute batch spark(2014): lambda(batch-streamåˆ†ç¦»), master-slave, rdd, lineage, persist, via 0x0fff airflow(2015): high scalability, HA, UI manage, via clairvoyantsoft oozie(2011): serverä¸computeåˆ†ç¦», multilayer(bundle), HA, via devstacks è¿™é‡Œscheduleréƒ½æ˜¯é€šè¿‡å¤šserveræ¥é¿å…SPOF, è€Œå¤šserverä¹‹é—´çš„çŠ¶æ€åŒæ­¥æ˜¯é€šè¿‡DB(ZK)æ¥ä¼ é€’. æœ‰åˆ«äºå¸¸è§„çš„å¤šserver leader-standbyæ¨¡å¼(eg., kafka broker, DBä¸»ä»å¤åˆ¶) stream flink(2011): kappa, master-slave, state, window, cp, via apache Reference Making Apache Airflow Highly Available Oozie Architecture and Job Scheduling Lambdaæ¶æ„ vs Kappaæ¶æ„ Flinkâ€“Checkpointæœºåˆ¶åŸç† ä¸€æ–‡ææ‡‚Flinkå†…éƒ¨çš„Exactly Onceå’ŒAt Least Once data storage in-memory redis(2009): mem-base, éé˜»å¡å¤šè·¯IOå¤ç”¨, äº‹åŠ¡, proactive expire, HA(sentinel), throughput(cluster), via redislabs ignite(2015): åˆ†å¸ƒå¼, KV, mem-disk SQL, 2PCäº‹åŠ¡, æ•°æ®æœ¬åœ°æ€§, via apache timeseries influxdb(2013): TSM, TSI, WAL/cache, rp, via hbasefly full-text es(2010): master-data, zen discovery , replica, LSM, full text MOLAP kylin(2013): é¢„è®¡ç®—cube, SQL, high scalability, MR, via apache druid(2011), role separate(master-query-data), LSM, via apache ROLAP clickhouse(2016): russia, column oriented, SQL, ä¸»å¤‡å¤åˆ¶, index(primary key sort), table engine, via altinity greenplum(2015): master-slave, append-optimized, SQL, resource queue, via researchgate tidb(2017): åˆ†å¸ƒå¼, SQL, raft, LSM, mysql alternative, via pingcap query engine presto(2013): master-slave, mem-base MPP, SQL, connector, via slideshare sparksql(2014): catalyst, cost base, rdd, via dataflair hive(2010): SQL, MR, metadata, via andr83 pig(2008): pig latin, MR, via dezyre graph neo4j(2007): å®šé•¿è®°å½•ç»“æ„, cypher, HA, via slideshare Reference IOå¤šè·¯å¤ç”¨æŠ€æœ¯(multiplexing)æ˜¯ä»€ä¹ˆï¼Ÿ ä¸ºä»€ä¹ˆIOå¤šè·¯å¤ç”¨è¦æ­é…éé˜»å¡ IO? Ignite(äºŒ): æ¶æ„åŠå·¥å…· æ•°æ®åº“å¦‚ä½•ç”¨ WAL ä¿è¯äº‹åŠ¡ä¸€è‡´æ€§ï¼Ÿ Every shard deserves a home Guide to Refresh and Flush Operations in Elasticsearch Apache Kylin å…¥é—¨ 2 - åŸç†ä¸æ¶æ„ apache druidæ¶æ„ã€åŸç†ã€æ‰§è¡Œæµç¨‹ æ•°æ®ç»“æ„ç¯‡â€”-B+æ ‘ä¸LSMæ ‘æµ…æ ClickHouseè¡¨å¼•æ“åˆ°åº•æ€ä¹ˆé€‰ TiDBæ•´ä½“æ¶æ„ Presto: SQL on Everything Prestoæ¶æ„åŠåŸç†ã€å®‰è£…åŠéƒ¨ç½² Spark SQL Catalystä¼˜åŒ–å™¨ What is Hive Metastore? Neo4j_é«˜å±‚æ¶æ„å’Œåº”ç”¨ data analytics BI TODO TODO</summary></entry></feed>