<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="en" /><updated>2023-01-04T20:17:17+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">harryâ€™s blog</title><subtitle>harry's technology blog 
</subtitle><author><name>harry</name><email>harry_c2016@163.com</email></author><entry><title type="html">iOSè‡ªæ—‹é”ä¸äº’æ–¥é”</title><link href="http://localhost:4000/2023/01/04/00_iOS%E4%B8%AD%E8%87%AA%E6%97%8B%E9%94%81%E5%92%8C%E4%BA%92%E6%96%A5%E9%94%81.html" rel="alternate" type="text/html" title="iOSè‡ªæ—‹é”ä¸äº’æ–¥é”" /><published>2023-01-04T00:00:00+08:00</published><updated>2023-01-04T00:00:00+08:00</updated><id>http://localhost:4000/2023/01/04/00_iOS%E4%B8%AD%E8%87%AA%E6%97%8B%E9%94%81%E5%92%8C%E4%BA%92%E6%96%A5%E9%94%81</id><content type="html" xml:base="http://localhost:4000/2023/01/04/00_iOS%E4%B8%AD%E8%87%AA%E6%97%8B%E9%94%81%E5%92%8C%E4%BA%92%E6%96%A5%E9%94%81.html">&lt;h4 id=&quot;iosä¸­è‡ªæ—‹é”å’Œäº’æ–¥é”&quot;&gt;iOSä¸­è‡ªæ—‹é”å’Œäº’æ–¥é”&lt;/h4&gt;

&lt;hr /&gt;

&lt;h5 id=&quot;èµ·å› &quot;&gt;èµ·å› &lt;/h5&gt;

&lt;p&gt;å±æ€§ä¿®é¥°ç¬¦atomicï¼Œæ˜¯å¦æ˜¯ç»å¯¹çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å½“ç„¶ä¹ä¸€çœ‹ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜å¥½åƒæ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œä½†æ˜¯äº†è§£atomicçš„å†…éƒ¨å®ç°ï¼Œå°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘èƒ½è·¨åº¦åˆ°è‡ªæ—‹é”å’Œäº’æ–¥é”ã€‚ï¼ˆå› ä¸ºatomicå…¶å®å†…éƒ¨æ˜¯å¯¹äºsetterå’ŒgetteråŠ é”å®ç°çš„ï¼‰&lt;/p&gt;

&lt;p&gt;åè¾¹æˆ‘ä»¬å†çœ‹atomicåˆ°åº•æ˜¯å¦å®‰å…¨çš„é—®é¢˜&lt;/p&gt;

&lt;h5 id=&quot;å®šä¹‰&quot;&gt;å®šä¹‰&lt;/h5&gt;

&lt;p&gt;é”ï¼šåœ¨&lt;a href=&quot;https://zh.wikipedia.org/wiki/è®¡ç®—æœºç§‘å­¦&quot;&gt;è®¡ç®—æœºç§‘å­¦&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;é”&lt;/strong&gt;æ˜¯åœ¨æ‰§è¡Œ&lt;a href=&quot;https://zh.wikipedia.org/wiki/å¤šçº¿ç¨‹&quot;&gt;å¤šçº¿ç¨‹&lt;/a&gt;æ—¶ç”¨äºå¼ºè¡Œé™åˆ¶èµ„æºè®¿é—®çš„&lt;a href=&quot;https://zh.wikipedia.org/wiki/åŒæ­¥&quot;&gt;åŒæ­¥&lt;/a&gt;æœºåˆ¶ï¼Œå³ç”¨äºåœ¨&lt;a href=&quot;https://zh.wikipedia.org/wiki/å¹¶å‘æ§åˆ¶&quot;&gt;å¹¶å‘æ§åˆ¶&lt;/a&gt;ä¸­ä¿è¯å¯¹&lt;a href=&quot;https://zh.wikipedia.org/wiki/äº’æ–¥&quot;&gt;äº’æ–¥&lt;/a&gt;è¦æ±‚çš„æ»¡è¶³ã€‚(ç»´åŸºç™¾ç§‘ä¸­çš„å®šä¹‰)&lt;/p&gt;

&lt;p&gt;è‡ªæ—‹é”ï¼š è‡ªæ—‹é”å…¶å®å°±æ˜¯çº¿ç¨‹å†æœªè·å¾—é”çš„æ—¶å€™å¤„äºå¿™ç­‰çš„çŠ¶æ€ï¼Œä¸€ç›´æ¶ˆè€—cpuï¼Œè€Œä¸ä¼šè¿›å…¥å†…æ ¸æ€ã€‚&lt;/p&gt;

&lt;p&gt;äº’æ–¥é”ï¼šäº’æ–¥é”åˆ™æ˜¯å½“æœªè·å¾—é”æ—¶ï¼Œçº¿ç¨‹è¿›å…¥å†…æ ¸æ€ï¼Œé‡Šæ”¾cpuçš„æ¶ˆè€—ï¼Œç›´åˆ°é”èµ„æºè¢«é‡Šæ”¾ï¼Œé‡æ–°å”¤èµ·ä¼‘çœ çš„çº¿ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;å…¶å®ä»å®šä¹‰ä¸­æˆ‘ä»¬ä¹Ÿèƒ½å¾ˆæ˜ç¡®çš„çœ‹åˆ°äº†ä»–ä»¬çš„ä¼˜ç¼ºç‚¹ï¼šè‡ªæ—‹é”ä¸€ç›´å¤„äºå¿™ç­‰çš„çŠ¶æ€ï¼Œä¼šæŒç»­æ¶ˆè€—cpuï¼Œè€Œäº’æ–¥é”åˆ™ä¸ä¼šï¼Œä½†æ˜¯äº’æ–¥é”ä¼šé¢‘ç¹çš„åˆ‡æ¢çº¿ç¨‹çš„çŠ¶æ€ï¼Œæ¯”è¾ƒæ•ˆç‡ä¸Šä¼šæ¯”è‡ªæ—‹é”ä½å¾ˆå¤šã€‚&lt;/p&gt;

&lt;h5 id=&quot;ios-ä¸­çš„é”&quot;&gt;iOS ä¸­çš„é”&lt;/h5&gt;

&lt;ol&gt;
  &lt;li&gt;NSLock éé€’å½’äº’æ–¥é”ã€‚æ˜¯å¯¹äºpthread_mutex_tçš„å°è£…ã€‚éµå¾ªäº†NSLockingåè®®ã€‚-lockä¸unlockå¿…é¡»åœ¨åŒä¸€çº¿ç¨‹è°ƒç”¨ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé—®é¢˜ã€‚&lt;/li&gt;
  &lt;li&gt;NSConditionï¼Œ ä¸NSLockç±»ä¼¼éƒ½æ˜¯å¯¹äºpthread_mutex_tçš„å°è£…ï¼ŒåŒºåˆ«åœ¨äºï¼Œä»–è¿˜å¯¹äºpthread_cond_tçš„å°è£…ï¼Œæ‰€ä»¥NSLockåªèƒ½ç­‰å¾…é”èµ„æºé‡Šæ”¾ï¼Œç„¶åå”¤èµ·ç­‰å¾…çš„çº¿ç¨‹ï¼Œè€ŒNSConditionåˆ™å¯ä»¥ç”±æˆ‘ä»¬ä¸»åŠ¨å”¤èµ·çº¿ç¨‹&lt;/li&gt;
  &lt;li&gt;NSConditionLock, æ¡ä»¶äº’æ–¥é”ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†æ­£å¸¸çš„é”èµ„æºé‡Šæ”¾æˆ‘ä»¬è·å¾—é”ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ»¡è¶³è®¾ç½®çš„å¦å¤–ä¸€ä¸ªæ¡ä»¶ï¼Œæ‰èƒ½è·å¾—é”ã€‚é‡Šæ”¾é”ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/li&gt;
  &lt;li&gt;NSRecursiveLock, é€’å½’é”ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäº’æ–¥é”ã€‚ä¸å…¶ä»–é”ä¸åŒçš„æ˜¯ï¼Œé€’å½’é”å¯ä»¥å…¶ä»–é”å¦‚æœåŒä¸€ä¸ªçº¿ç¨‹è·å¾—é”å¹¶ä¸”æ²¡æœ‰é‡Šæ”¾ï¼Œè¿™ä¸ªçº¿ç¨‹å†æ¬¡è·å–é”å°±ä¼šé€ æˆæ­»é”ï¼Œäº’æ–¥é”åˆ™å¯ä»¥è¿è¡ŒåŒä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ä¹‹åä¾ç„¶å¯ä»¥å†æ¬¡è·å¾—é”ã€‚&lt;/li&gt;
  &lt;li&gt;@synchronizeï¼Œå¯¹è±¡é”ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€’å½’äº’æ–¥é”ã€‚&lt;/li&gt;
  &lt;li&gt;Dispatch_semaphore,  ä¿¡å·é‡ï¼Œæ›´é«˜çº§çš„äº’æ–¥é”ï¼Œåˆå§‹å€¼å¯ä»¥æ§åˆ¶å¹¶å‘è®¿é—®çš„æœ€å¤§é‡&lt;/li&gt;
  &lt;li&gt;OSSpinLock, iOS 10 åºŸå¼ƒçš„è‡ªæ—‹é”ï¼ŒåŸå› æ˜¯10ä¹‹åå¢åŠ äº†è®¸å¤šçš„çº¿ç¨‹é»˜è®¤ä¼˜å…ˆçº§ï¼Œè‡ªæ—‹é”å¯èƒ½ä¼šé€ æˆçº¿ç¨‹ä¼˜å…ˆçº§åè½¬ï¼Œå¯¼è‡´æ­»é”&lt;/li&gt;
  &lt;li&gt;os_unfair_lock, ç”¨æ¥å–ä»£OSSpinLockçš„äº’æ–¥é”&lt;/li&gt;
  &lt;li&gt;pthread_mutex, åº•å±‚pthreadäº’æ–¥é”&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&quot;æ€§èƒ½&quot;&gt;æ€§èƒ½&lt;/h5&gt;

&lt;p&gt;ä»&lt;a href=&quot;https://blog.ibireme.com/author/ibireme/&quot;&gt;ibireme&lt;/a&gt;çš„åšå®¢ä¸­å›¾æ¥çœ‹æ€§èƒ½å¯¹æ¯”å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://blog.ibireme.com/wp-content/uploads/2016/01/lock_benchmark.png&quot; alt=&quot;lock_benchmark&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å½“ç„¶ä½œè€…åªæ˜¯å•çº¿ç¨‹çš„ä¸€ä¸ªæ—¶é—´æ¶ˆè€—æ•°æ®ã€‚ä¸èƒ½ååº”å¤šçº¿ç¨‹çš„å®é™…æ€§èƒ½ï¼Œåªèƒ½ä½œä¸ºä¸€ä¸ªå®šæ€§åˆ†æã€‚&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="iOS" /><summary type="html">iOSä¸­è‡ªæ—‹é”å’Œäº’æ–¥é” èµ·å›  å±æ€§ä¿®é¥°ç¬¦atomicï¼Œæ˜¯å¦æ˜¯ç»å¯¹çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ å½“ç„¶ä¹ä¸€çœ‹ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜å¥½åƒæ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œä½†æ˜¯äº†è§£atomicçš„å†…éƒ¨å®ç°ï¼Œå°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘èƒ½è·¨åº¦åˆ°è‡ªæ—‹é”å’Œäº’æ–¥é”ã€‚ï¼ˆå› ä¸ºatomicå…¶å®å†…éƒ¨æ˜¯å¯¹äºsetterå’ŒgetteråŠ é”å®ç°çš„ï¼‰ åè¾¹æˆ‘ä»¬å†çœ‹atomicåˆ°åº•æ˜¯å¦å®‰å…¨çš„é—®é¢˜ å®šä¹‰ é”ï¼šåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé”æ˜¯åœ¨æ‰§è¡Œå¤šçº¿ç¨‹æ—¶ç”¨äºå¼ºè¡Œé™åˆ¶èµ„æºè®¿é—®çš„åŒæ­¥æœºåˆ¶ï¼Œå³ç”¨äºåœ¨å¹¶å‘æ§åˆ¶ä¸­ä¿è¯å¯¹äº’æ–¥è¦æ±‚çš„æ»¡è¶³ã€‚(ç»´åŸºç™¾ç§‘ä¸­çš„å®šä¹‰) è‡ªæ—‹é”ï¼š è‡ªæ—‹é”å…¶å®å°±æ˜¯çº¿ç¨‹å†æœªè·å¾—é”çš„æ—¶å€™å¤„äºå¿™ç­‰çš„çŠ¶æ€ï¼Œä¸€ç›´æ¶ˆè€—cpuï¼Œè€Œä¸ä¼šè¿›å…¥å†…æ ¸æ€ã€‚ äº’æ–¥é”ï¼šäº’æ–¥é”åˆ™æ˜¯å½“æœªè·å¾—é”æ—¶ï¼Œçº¿ç¨‹è¿›å…¥å†…æ ¸æ€ï¼Œé‡Šæ”¾cpuçš„æ¶ˆè€—ï¼Œç›´åˆ°é”èµ„æºè¢«é‡Šæ”¾ï¼Œé‡æ–°å”¤èµ·ä¼‘çœ çš„çº¿ç¨‹ã€‚ å…¶å®ä»å®šä¹‰ä¸­æˆ‘ä»¬ä¹Ÿèƒ½å¾ˆæ˜ç¡®çš„çœ‹åˆ°äº†ä»–ä»¬çš„ä¼˜ç¼ºç‚¹ï¼šè‡ªæ—‹é”ä¸€ç›´å¤„äºå¿™ç­‰çš„çŠ¶æ€ï¼Œä¼šæŒç»­æ¶ˆè€—cpuï¼Œè€Œäº’æ–¥é”åˆ™ä¸ä¼šï¼Œä½†æ˜¯äº’æ–¥é”ä¼šé¢‘ç¹çš„åˆ‡æ¢çº¿ç¨‹çš„çŠ¶æ€ï¼Œæ¯”è¾ƒæ•ˆç‡ä¸Šä¼šæ¯”è‡ªæ—‹é”ä½å¾ˆå¤šã€‚ iOS ä¸­çš„é” NSLock éé€’å½’äº’æ–¥é”ã€‚æ˜¯å¯¹äºpthread_mutex_tçš„å°è£…ã€‚éµå¾ªäº†NSLockingåè®®ã€‚-lockä¸unlockå¿…é¡»åœ¨åŒä¸€çº¿ç¨‹è°ƒç”¨ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé—®é¢˜ã€‚ NSConditionï¼Œ ä¸NSLockç±»ä¼¼éƒ½æ˜¯å¯¹äºpthread_mutex_tçš„å°è£…ï¼ŒåŒºåˆ«åœ¨äºï¼Œä»–è¿˜å¯¹äºpthread_cond_tçš„å°è£…ï¼Œæ‰€ä»¥NSLockåªèƒ½ç­‰å¾…é”èµ„æºé‡Šæ”¾ï¼Œç„¶åå”¤èµ·ç­‰å¾…çš„çº¿ç¨‹ï¼Œè€ŒNSConditionåˆ™å¯ä»¥ç”±æˆ‘ä»¬ä¸»åŠ¨å”¤èµ·çº¿ç¨‹ NSConditionLock, æ¡ä»¶äº’æ–¥é”ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†æ­£å¸¸çš„é”èµ„æºé‡Šæ”¾æˆ‘ä»¬è·å¾—é”ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ»¡è¶³è®¾ç½®çš„å¦å¤–ä¸€ä¸ªæ¡ä»¶ï¼Œæ‰èƒ½è·å¾—é”ã€‚é‡Šæ”¾é”ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ NSRecursiveLock, é€’å½’é”ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäº’æ–¥é”ã€‚ä¸å…¶ä»–é”ä¸åŒçš„æ˜¯ï¼Œé€’å½’é”å¯ä»¥å…¶ä»–é”å¦‚æœåŒä¸€ä¸ªçº¿ç¨‹è·å¾—é”å¹¶ä¸”æ²¡æœ‰é‡Šæ”¾ï¼Œè¿™ä¸ªçº¿ç¨‹å†æ¬¡è·å–é”å°±ä¼šé€ æˆæ­»é”ï¼Œäº’æ–¥é”åˆ™å¯ä»¥è¿è¡ŒåŒä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ä¹‹åä¾ç„¶å¯ä»¥å†æ¬¡è·å¾—é”ã€‚ @synchronizeï¼Œå¯¹è±¡é”ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€’å½’äº’æ–¥é”ã€‚ Dispatch_semaphore, ä¿¡å·é‡ï¼Œæ›´é«˜çº§çš„äº’æ–¥é”ï¼Œåˆå§‹å€¼å¯ä»¥æ§åˆ¶å¹¶å‘è®¿é—®çš„æœ€å¤§é‡ OSSpinLock, iOS 10 åºŸå¼ƒçš„è‡ªæ—‹é”ï¼ŒåŸå› æ˜¯10ä¹‹åå¢åŠ äº†è®¸å¤šçš„çº¿ç¨‹é»˜è®¤ä¼˜å…ˆçº§ï¼Œè‡ªæ—‹é”å¯èƒ½ä¼šé€ æˆçº¿ç¨‹ä¼˜å…ˆçº§åè½¬ï¼Œå¯¼è‡´æ­»é” os_unfair_lock, ç”¨æ¥å–ä»£OSSpinLockçš„äº’æ–¥é” pthread_mutex, åº•å±‚pthreadäº’æ–¥é” æ€§èƒ½ ä»ibiremeçš„åšå®¢ä¸­å›¾æ¥çœ‹æ€§èƒ½å¯¹æ¯”å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š å½“ç„¶ä½œè€…åªæ˜¯å•çº¿ç¨‹çš„ä¸€ä¸ªæ—¶é—´æ¶ˆè€—æ•°æ®ã€‚ä¸èƒ½ååº”å¤šçº¿ç¨‹çš„å®é™…æ€§èƒ½ï¼Œåªèƒ½ä½œä¸ºä¸€ä¸ªå®šæ€§åˆ†æã€‚</summary></entry><entry><title type="html">Objective-CLintï¼ˆåˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„ã€æ”¯æŒpre-commitçš„Objective-C çš„é™æ€æ£€æŸ¥ï¼‰</title><link href="http://localhost:4000/2022/09/14/Objective_CLint.html" rel="alternate" type="text/html" title="Objective-CLintï¼ˆåˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„ã€æ”¯æŒpre-commitçš„Objective-C çš„é™æ€æ£€æŸ¥ï¼‰" /><published>2022-09-14T00:00:00+08:00</published><updated>2022-09-14T00:00:00+08:00</updated><id>http://localhost:4000/2022/09/14/Objective_CLint</id><content type="html" xml:base="http://localhost:4000/2022/09/14/Objective_CLint.html">&lt;h1 id=&quot;objective-clint&quot;&gt;Objective-CLint&lt;/h1&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„ã€æ”¯æŒpre-commitçš„Objective-C çš„é™æ€æ£€æŸ¥&lt;/p&gt;

&lt;h3 id=&quot;æ„Ÿè°¢&quot;&gt;æ„Ÿè°¢&lt;/h3&gt;
&lt;p&gt;æ„Ÿè°¢ &lt;a href=&quot;https://github.com/square/spacecommander&quot;&gt;spacecommander&lt;/a&gt;ä½œè€…æä¾›çš„Objective-C lintçš„æ€è·¯ä»¥åŠopen source
æœ¬æ–‡å¤§éƒ¨åˆ†æ˜¯åŸºäº &lt;a href=&quot;https://github.com/square/spacecommander&quot;&gt;spacecommander&lt;/a&gt;ç´¯åŠ çš„ä¸€äº›æ–°åŠŸèƒ½ã€‚å†æ¬¡æ„Ÿè°¢å¼€æºä½œè€…ï¼Œéå¸¸æ£’ğŸ‘ğŸ»&lt;/p&gt;

&lt;h3 id=&quot;æ¶æ„æ„æ€&quot;&gt;æ¶æ„/æ„æ€&lt;/h3&gt;
&lt;h4 id=&quot;1å‰å› &quot;&gt;1.å‰å› &lt;/h4&gt;
&lt;p&gt;å› ä¸ºOC-Lintçš„é‡é‡å‹æ£€æŸ¥ï¼Œå¯¼è‡´å¦‚æœä½¿ç”¨OCLint é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…OCLint ä»¥åŠ è¿˜éœ€è¦ç¼–è¯‘å·¥ç¨‹ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨&lt;a href=&quot;https://pre-commit.com/&quot;&gt;pre-commit&lt;/a&gt;é‚£ä¹ˆ
å°±ä¼šå¯¼è‡´æˆ‘ä»¬æ¯æ¬¡ git commit æ—¶é—´ä¼šå¢åŠ å¾ˆå¤šï¼Œæ¯æ¬¡ commitå¯èƒ½å¯¹äºæˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸€ç§ç…ç†¬ã€‚oké‚£ä¹ˆå°±éœ€è¦æˆ‘ä»¬ä½¿ç”¨å¦å¤–çš„æ–¹å¼è§£å†³ã€‚&lt;/p&gt;

&lt;p&gt;OKï¼Œè§£å†³æ–¹æ³•ä¹‹ä¸€å°±æ˜¯æˆ‘ä»¬ä¹‹é—´ä½¿ç”¨Clang-formatï¼Œæˆ‘ä»¬çŸ¥é“å…¶å®OCLintä¹Ÿæ˜¯åŸºäºClang-formatåšçš„ï¼Œé‚£ä¹ˆåœ¨å¯»æ‰¾çš„è¿‡ç¨‹ä¸­å‘ç°äº†æœ‰ä¼Ÿå¤§çš„ spacecommander ä½œè€…å·²ç»å¸®åŠ©æˆ‘ä»¬é›†æˆäº†Clang-format
ä½œè€…é™¤æ­¤ä¹‹å¤–è¿˜è§£å†³äº†å¯èƒ½ä¼šå¼•èµ·Clang-formatæœ‰æ­§ä¹‰çš„ä»£ç ä¿®æ”¹ã€ä»¥åŠClang-format æ‰«ä¸åˆ°çš„ä¸€äº›è§„åˆ™ä¿®æ”¹ã€‚&lt;/p&gt;

&lt;p&gt;é‚£ä¹ˆæœ‰äº†ä¼Ÿå¤§çš„ spacecommander ä½œä¸ºåŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä»–åšä¸€ä¸ªpre-commit hookï¼Œç”¨æ¥OClint&lt;/p&gt;

&lt;h4 id=&quot;2ç›¸å…³å®ç°æ”¹åŠ¨&quot;&gt;2.ç›¸å…³å®ç°ã€æ”¹åŠ¨&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;åœ¨spacecommander çš„åŸºç¡€ä¸Šï¼Œå®ç°äº†æ”¯æŒpre-commitï¼Œæ›´æ–¹ä¾¿é›†æˆ&lt;/li&gt;
  &lt;li&gt;spacecommander åªæ˜¯å¯¹æ¯”äº†formatä¹‹åè¡Œæ•°ï¼Œä»¥ç”¨æ¥æ¯”è¾ƒæ˜¯å¦æœ‰ä¸å¦å’Œè§„åˆ™çš„ä»£ç å‡ºç°ï¼Œä¸å¤Ÿæ˜æ˜¾ï¼Œæˆ‘ä»¬é‡‡ç”¨diffçš„æ–¹å¼å¯¹æ¯”äº†
 formatä¹‹å‰å’Œä¹‹åçš„ä»£ç ï¼Œä½¿å¾—å¼€å‘è€…èƒ½æ›´æ¸…æ¥šï¼Œè‡ªå·±å“ªäº›åœ°æ–¹ä»£ç ä¸è§„èŒƒ&lt;/li&gt;
  &lt;li&gt;spacecommander æä¾›äº†api ä¸€é”®formatä»£ç ï¼Œæˆ‘ä»¬ä¸æä¾›æ­¤åŠŸèƒ½ï¼Œå› ä¸ºæˆ‘æ€»è§‰å¾—åªæœ‰å¤šæ¬¡çš„è®¤è¯†åˆ°ä¸è§„èŒƒçš„ä»£ç ï¼Œæ‰èƒ½ä¿è¯ä¸‹æ¬¡å†™å‡ºè§„èŒƒçš„ä»£ç &lt;/li&gt;
  &lt;li&gt;æä¾›äº†diffä¹‹åå¯è§†åŒ–è¾“å‡ºï¼Œæ‰“å¼€htmlï¼Œä¸€çœ¼å³å¯çœ‹åˆ°ä¸è§„èŒƒçš„ä»£ç &lt;/li&gt;
  &lt;li&gt;ä¿®æ”¹äº†éƒ¨åˆ†è‡ªå®šä¹‰è§„åˆ™ä»£ç ï¼Œä»¥é€‚åº”çµæ´»çš„ä»£ç ä¸è§„èŒƒ&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/HaoXianSen/Objective-CLint/blob/main/.clang-format&quot;&gt;.clang-format&lt;/a&gt; é…ç½®äº†æ›´å¤šçš„clang è§„åˆ™&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ä½¿ç”¨&quot;&gt;ä½¿ç”¨&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å®‰è£… pre-commit , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install pre-commit&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨å·¥ç¨‹æ ¹ç›®å½•æ·»åŠ (å³.gitåŒçº§ç›®å½•)æ·»åŠ  &lt;a href=&quot;https://github.com/HaoXianSen/Objective-CLint/blob/main/.pre-commit-config.yaml&quot;&gt;.pre-commit-config.yaml&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;å¹¶é…ç½®ä¸ºï¼š&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;fail_fast: false
repos:
  - repo: https://github.com/HaoXianSen/Objective-CLint.git
    rev: v0.0.2
    hooks:
      - id: objc-lint
        name: objc-format
        entry: format-objc-hook
        language: script
        require_serial: true
        verbose: true
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;é«˜é˜¶ä½¿ç”¨&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;fork å·¥ç¨‹ï¼Œå¯ä¿®æ”¹ã€å¢åŠ è‡ªå®šä¹‰è§„åˆ™ï¼Œä»¥åŠ.clang è§„åˆ™&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ç›¸å…³æˆªå›¾&quot;&gt;ç›¸å…³æˆªå›¾&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220914145908image-20220914145906934.png&quot; alt=&quot;image-20220914145906934&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220914145930image-20220914145930603.png&quot; alt=&quot;image-20220914145930603&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220914150033image-20220914150033308.png&quot; alt=&quot;image-20220914150033308&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;github&quot;&gt;github&lt;/h3&gt;

&lt;p&gt;https://github.com/HaoXianSen/Objective-CLint&lt;/p&gt;

&lt;h4 id=&quot;è”ç³»æ–¹å¼&quot;&gt;è”ç³»æ–¹å¼&lt;/h4&gt;

&lt;p&gt;harry_c2016@163.com&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="iOS" /><category term="pre-commit" /><category term="hooks" /><summary type="html">Objective-CLint åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„ã€æ”¯æŒpre-commitçš„Objective-C çš„é™æ€æ£€æŸ¥ æ„Ÿè°¢ æ„Ÿè°¢ spacecommanderä½œè€…æä¾›çš„Objective-C lintçš„æ€è·¯ä»¥åŠopen source æœ¬æ–‡å¤§éƒ¨åˆ†æ˜¯åŸºäº spacecommanderç´¯åŠ çš„ä¸€äº›æ–°åŠŸèƒ½ã€‚å†æ¬¡æ„Ÿè°¢å¼€æºä½œè€…ï¼Œéå¸¸æ£’ğŸ‘ğŸ» æ¶æ„/æ„æ€ 1.å‰å›  å› ä¸ºOC-Lintçš„é‡é‡å‹æ£€æŸ¥ï¼Œå¯¼è‡´å¦‚æœä½¿ç”¨OCLint é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…OCLint ä»¥åŠ è¿˜éœ€è¦ç¼–è¯‘å·¥ç¨‹ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨pre-commité‚£ä¹ˆ å°±ä¼šå¯¼è‡´æˆ‘ä»¬æ¯æ¬¡ git commit æ—¶é—´ä¼šå¢åŠ å¾ˆå¤šï¼Œæ¯æ¬¡ commitå¯èƒ½å¯¹äºæˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸€ç§ç…ç†¬ã€‚oké‚£ä¹ˆå°±éœ€è¦æˆ‘ä»¬ä½¿ç”¨å¦å¤–çš„æ–¹å¼è§£å†³ã€‚ OKï¼Œè§£å†³æ–¹æ³•ä¹‹ä¸€å°±æ˜¯æˆ‘ä»¬ä¹‹é—´ä½¿ç”¨Clang-formatï¼Œæˆ‘ä»¬çŸ¥é“å…¶å®OCLintä¹Ÿæ˜¯åŸºäºClang-formatåšçš„ï¼Œé‚£ä¹ˆåœ¨å¯»æ‰¾çš„è¿‡ç¨‹ä¸­å‘ç°äº†æœ‰ä¼Ÿå¤§çš„ spacecommander ä½œè€…å·²ç»å¸®åŠ©æˆ‘ä»¬é›†æˆäº†Clang-format ä½œè€…é™¤æ­¤ä¹‹å¤–è¿˜è§£å†³äº†å¯èƒ½ä¼šå¼•èµ·Clang-formatæœ‰æ­§ä¹‰çš„ä»£ç ä¿®æ”¹ã€ä»¥åŠClang-format æ‰«ä¸åˆ°çš„ä¸€äº›è§„åˆ™ä¿®æ”¹ã€‚ é‚£ä¹ˆæœ‰äº†ä¼Ÿå¤§çš„ spacecommander ä½œä¸ºåŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä»–åšä¸€ä¸ªpre-commit hookï¼Œç”¨æ¥OClint 2.ç›¸å…³å®ç°ã€æ”¹åŠ¨ åœ¨spacecommander çš„åŸºç¡€ä¸Šï¼Œå®ç°äº†æ”¯æŒpre-commitï¼Œæ›´æ–¹ä¾¿é›†æˆ spacecommander åªæ˜¯å¯¹æ¯”äº†formatä¹‹åè¡Œæ•°ï¼Œä»¥ç”¨æ¥æ¯”è¾ƒæ˜¯å¦æœ‰ä¸å¦å’Œè§„åˆ™çš„ä»£ç å‡ºç°ï¼Œä¸å¤Ÿæ˜æ˜¾ï¼Œæˆ‘ä»¬é‡‡ç”¨diffçš„æ–¹å¼å¯¹æ¯”äº† formatä¹‹å‰å’Œä¹‹åçš„ä»£ç ï¼Œä½¿å¾—å¼€å‘è€…èƒ½æ›´æ¸…æ¥šï¼Œè‡ªå·±å“ªäº›åœ°æ–¹ä»£ç ä¸è§„èŒƒ spacecommander æä¾›äº†api ä¸€é”®formatä»£ç ï¼Œæˆ‘ä»¬ä¸æä¾›æ­¤åŠŸèƒ½ï¼Œå› ä¸ºæˆ‘æ€»è§‰å¾—åªæœ‰å¤šæ¬¡çš„è®¤è¯†åˆ°ä¸è§„èŒƒçš„ä»£ç ï¼Œæ‰èƒ½ä¿è¯ä¸‹æ¬¡å†™å‡ºè§„èŒƒçš„ä»£ç  æä¾›äº†diffä¹‹åå¯è§†åŒ–è¾“å‡ºï¼Œæ‰“å¼€htmlï¼Œä¸€çœ¼å³å¯çœ‹åˆ°ä¸è§„èŒƒçš„ä»£ç  ä¿®æ”¹äº†éƒ¨åˆ†è‡ªå®šä¹‰è§„åˆ™ä»£ç ï¼Œä»¥é€‚åº”çµæ´»çš„ä»£ç ä¸è§„èŒƒ .clang-format é…ç½®äº†æ›´å¤šçš„clang è§„åˆ™ ä½¿ç”¨ å®‰è£… pre-commit , brew install pre-commit åœ¨å·¥ç¨‹æ ¹ç›®å½•æ·»åŠ (å³.gitåŒçº§ç›®å½•)æ·»åŠ  .pre-commit-config.yaml å¹¶é…ç½®ä¸ºï¼š fail_fast: false repos: - repo: https://github.com/HaoXianSen/Objective-CLint.git rev: v0.0.2 hooks: - id: objc-lint name: objc-format entry: format-objc-hook language: script require_serial: true verbose: true é«˜é˜¶ä½¿ç”¨ fork å·¥ç¨‹ï¼Œå¯ä¿®æ”¹ã€å¢åŠ è‡ªå®šä¹‰è§„åˆ™ï¼Œä»¥åŠ.clang è§„åˆ™ ç›¸å…³æˆªå›¾ github https://github.com/HaoXianSen/Objective-CLint è”ç³»æ–¹å¼ harry_c2016@163.com</summary></entry><entry><title type="html">å…³äºiOS ä»£ç è´¨é‡æŠŠæ§ç ”ç©¶</title><link href="http://localhost:4000/2022/08/29/%E5%85%B3%E4%BA%8EiOS-%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E6%8A%8A%E6%8E%A7%E7%A0%94%E7%A9%B6.html" rel="alternate" type="text/html" title="å…³äºiOS ä»£ç è´¨é‡æŠŠæ§ç ”ç©¶" /><published>2022-08-29T00:00:00+08:00</published><updated>2022-08-29T00:00:00+08:00</updated><id>http://localhost:4000/2022/08/29/%E5%85%B3%E4%BA%8EiOS%20%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E6%8A%8A%E6%8E%A7%E7%A0%94%E7%A9%B6</id><content type="html" xml:base="http://localhost:4000/2022/08/29/%E5%85%B3%E4%BA%8EiOS-%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E6%8A%8A%E6%8E%A7%E7%A0%94%E7%A9%B6.html">&lt;h3 id=&quot;å‰æ&quot;&gt;å‰æ&lt;/h3&gt;

&lt;p&gt;code review æ˜¯æˆ‘ä»¬å·¥ä½œä¸­å¯ä»¥è¯´å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œä¸€æ–¹é¢èƒ½å¤Ÿææ—©çš„å‘ç°ä»£ç ä¸­ä¸åˆç†çš„éƒ¨åˆ†ã€æˆ–è€…ä¸ç¨³å®šã€æ¶æ„ä¸åˆç†çš„éƒ¨åˆ†ï¼Œæé«˜ä»£ç çš„è´¨é‡ï¼›å¦å¤–ä¸€æ–¹é¢èƒ½ï¼Œæ›´å¤Ÿè®©å›¢é˜Ÿçš„çŸ¥è¯†å…±äº«ï¼Œäº’ç›¸ç†Ÿæ‚‰ä¸šåŠ¡éœ€æ±‚ï¼Œä»¥åŠå›¢é˜Ÿå†™çš„å¥½çš„éƒ¨åˆ†ã€‚OKï¼Œä½œä¸ºcode reviewæœ€æ—©æœ€åŸºç¡€çš„ä¸€ç¯ï¼Œå¯ä»¥è¯´æ˜¯ä»£ç è§„èŒƒã€‚å¦‚æœäººå·¥è¿›è¡Œä»£ç è§„èŒƒçš„ç»´æŠ¤ï¼Œéš¾å…ä¼šé—æ¼ï¼Œè€Œä¸”ä¼šèŠ±è´¹æ—¶é—´åœ¨è¿™éƒ¨åˆ†ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åšçš„æ˜¯ï¼Œåšä¸€ä¸ªlintå¸®åŠ©æˆ‘ä»¬æ£€æµ‹ä¸è§„èŒƒçš„ä»£ç ï¼ŒOKï¼Œä¸‹é¢å°±lintï¼Œå¼€å§‹ç ”ç©¶ï¼&lt;/p&gt;

&lt;h3 id=&quot;lint-æ—¶æœº&quot;&gt;Lint æ—¶æœº&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬ç†ŸçŸ¥çš„Objective-C lintï¼Œæœ‰&lt;a href=&quot;https://docs.oclint.org/en/stable/index.html#usage&quot;&gt;OClint&lt;/a&gt;ã€&lt;a href=&quot;https://fbinfer.com/&quot;&gt;Infer&lt;/a&gt;; swift æœ‰&lt;a href=&quot;https://github.com/realm/SwiftLint&quot;&gt;swiftLint&lt;/a&gt;ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆä¸è€ƒè™‘è¿™ä¸ªå‡ ä¸ªlintçš„é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼Œlintåº”è¯¥æ”¾åˆ°ä»€ä¹ˆé˜¶æ®µï¼Ÿ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æ”¾åˆ°buildæ—¶æœŸï¼Ÿ&lt;/p&gt;

    &lt;p&gt;è¿™ç§æ–¹æ¡ˆè¢«æˆ‘ä»¬passæ‰äº†ï¼Œé¦–å…ˆæ”¾åˆ°buildæ—¶æœŸä¼šå¢åŠ æˆ‘ä»¬çš„buildæ—¶é—´ï¼Œç¬¬äºŒäº‹å®ä¸Šæˆ‘ä»¬éœ€è¦åµŒå…¥è„šæœ¬åˆ°é¡¹ç›®é‡Œï¼Œå¯èƒ½ä¼šå½±å“åˆ°æ‰“åŒ…ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ”¾åˆ°git push ä¹‹ågitlab pipelineæ—¶æœŸï¼Ÿ&lt;/p&gt;

    &lt;p&gt;è¿™ç§æ–¹æ¡ˆä¸å‡ºæ„å¤–ä¹Ÿè¢«passäº†ï¼Œé¦–å…ˆå¦‚æœçŸ¥é“pipeline jobçš„äººéƒ½çŸ¥é“ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®runner, æœ¬èº«æ¥è¯´é…ç½®åŠ é›†æˆï¼Œå¯èƒ½å°±ä¸æ˜¯ä¸€ä¸ªå®¹æ˜“çš„äº‹æƒ…ï¼Œè€Œä¸”å¯¹äºæˆ‘æ¥è¯´æˆ‘è§‰å¾—è¿™ä¸ªäº‹æƒ…ï¼Œå¤ªæ™šäº†ï¼Œlint æœ‰é—®é¢˜ï¼Œè¿˜ç­‰å†æ¬¡pushâ€¦.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ”¾åˆ°pre commitæ—¶æœŸï¼Ÿ&lt;/p&gt;

    &lt;p&gt;Ok, å¯¹äºæ¯”è¾ƒåˆé€‚çš„äº‹æƒ…ï¼Œæˆ‘è§‰å¾—å°±æ˜¯åœ¨precommitæ—¶æœŸï¼Œå› ä¸ºåŸºäºgit ç®¡ç†ï¼Œæˆ‘ä»¬ä»£ç æ¯æ¬¡æ”¹åŠ¨ä¹‹åéƒ½éœ€è¦commitï¼Œé‚£ä¹ˆcommitäº‹æƒ…å»åšlintè¿™ä»¶äº‹æƒ…ï¼Œæ˜¯éå¸¸åˆé€‚çš„ï¼Œå¦‚æœå­˜åœ¨é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¿®æ”¹ä¹‹åï¼Œå†æ¬¡commitã€‚æ—¶é—´ä¸Šï¼Œæ—¶æœºä¸Šæˆ‘è§‰å¾—éƒ½å¾ˆåˆé€‚&lt;/p&gt;

    &lt;p&gt;okï¼Œ å¯¹äº lint æ”¾åˆ°å“ªä¸ªæ—¶æœºçš„é—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»ç¡®å®šâ€“pre commitæ—¶æœŸ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;pre-commit&quot;&gt;&lt;a href=&quot;https://pre-commit.com/#install&quot;&gt;pre-commit&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;git å…¶å®ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šç§çš„hookæ–¹å¼ï¼Œéšä¾¿æ‰“å¼€ä¸€ä¸ª.gitæ–‡ä»¶å¤¹å°±å¯ä»¥çœ‹åˆ°ä¸€å †çš„hooks exampleæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220915152238image-20220915152237340.png&quot; alt=&quot;image-20220915152237340&quot; /&gt;&lt;/p&gt;

&lt;p&gt;OKï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬æƒ³è¦hookï¼Œå°±å˜å¾—éå¸¸å®¹æ˜“ï¼Œåªè¦æˆ‘ä»¬ä¿®æ”¹pre-commitä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶åœ¨é‡Œè¾¹æŒ‰ç…§exampleåµŒå…¥æ‰§è¡Œä»£ç å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸€æ­¥ï¼Œæ—©å°±æœ‰äººå¸®æˆ‘ä»¬åšäº†ï¼Œé‚£å°±æ˜¯&lt;a href=&quot;https://pre-commit.com/#install&quot;&gt;pre-commit&lt;/a&gt; ä»–ä¸ä»…ç®€å•äº†æˆ‘ä»¬çš„æ“ä½œï¼Œå¹¶ä¸”èµ·åˆ°äº†è„šæœ¬lintä»£ç åˆ†ç¦»çš„æ•ˆæœï¼Œä»–é€šè¿‡.pre-commit-config.yaml æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œåœ¨æ‰§è¡Œgit commitæ—¶å€™æ‰§è¡Œ&lt;a href=&quot;https://pre-commit.com/#install&quot;&gt;pre-commit&lt;/a&gt; è„šæœ¬ï¼Œå†è€Œæ‰§è¡Œåˆ°å®‰è£…çš„pre-commitä»£ç é‡Œï¼Œè¿›è¡Œclone .pre-commit-config.yamlé‡Œé…ç½®çš„repoï¼Œä»¥åŠåˆ†æï¼Œæ‰§è¡Œå¯¹åº”çš„hookä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥ç®€å•çš„ä»‹ç»ä¸€ä¸‹&lt;a href=&quot;https://pre-commit.com/#install&quot;&gt;pre-commit&lt;/a&gt; ç›¸å…³çš„ä¸œè¥¿ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å®‰è£…&lt;/p&gt;

    &lt;p&gt;Mac æ¨èä½¿ç”¨ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install pre-commit&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;å…¶ä»–å®‰è£…ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pip install pre-commit&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;conda install -c conda-forge pre-commit&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é…ç½®&lt;/p&gt;

    &lt;p&gt;å®‰è£…å®Œpre-commitä¹‹åï¼Œåœ¨.git åŒçº§ç›®å½•ï¼Œæ·»åŠ .pre-commit-config.yaml æ–‡ä»¶ï¼Œåˆ™å¯æ”¯æŒpre-commit&lt;/p&gt;

    &lt;p&gt;.pre-commit-config.yamlçš„ç›¸å…³é…ç½®ï¼š&lt;/p&gt;

    &lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;repos&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://github.com/pre-commit/pre-commit-hooks&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v2.3.0&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;check-yaml&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;end-of-file-fixer&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;trailing-whitespace&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://github.com/psf/black&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;21.12b0&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;black&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;æ³¨æ„ç‚¹ï¼šrev: ä¸å†æ”¯æŒcommit hash idï¼Œ åªæ”¯æŒtag&lt;/p&gt;

    &lt;p&gt;å…·ä½“å‚è€ƒï¼šhttps://pre-commit.com/#plugins&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„hook&lt;/p&gt;

    &lt;p&gt;ä¸€ä¸ªhookå¿…é¡»è¦åŒ…å«a .pre-commit-hooks.yaml æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å‘Šè¯‰pre-commitï¼Œè¿™ä¸ªhookåº“é‡ŒåŒ…å«çš„hook idç­‰ä¿¡æ¯â€¦&lt;/p&gt;

    &lt;p&gt;å¤§æ¦‚å¼ è¿™ä¸ªæ ·å­â€¦&lt;/p&gt;

    &lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt;   &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;trailing-whitespace&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Trim Trailing Whitespace&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;This hook trims trailing whitespace.&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;trailing-whitespace-fixer&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;â€‹		hooks ä»“åº“ï¼Œæ”¯æŒå¾ˆå¤šç§è¯­è¨€ï¼Œæ¯ç§è¯­è¨€åŒ…å«çš„æ–‡ä»¶ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œæ¯”å¦‚script ï¼ˆshellè„šæœ¬ï¼‰å¿…é¡»entryå‚		æ•°ç»™ä¸€ä¸ªç›¸å¯¹è·¯å¾„çš„shellè„šæœ¬ï¼›æ¯”å¦‚pythonï¼Œå¿…é¡»è¦æ‰§è¡Œpip install .ï¼ˆåŠåŒ…æ‹¬setup.pyæˆ–è€…		pyproject.tomlï¼‰ä»¥åŠentryä¸€èˆ¬åœ¨setup.py é‡Œçš„console_scriptsæˆ–è€…scriptsé…ç½®çš„ã€‚&lt;/p&gt;

&lt;p&gt;â€‹	&lt;a href=&quot;https://pre-commit.com/#script&quot;&gt;äº†è§£æ›´å¤š&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;objective-c-lint&quot;&gt;Objective-C Lint&lt;/h3&gt;

&lt;p&gt;ä¸Šé¢æåˆ°ç°å­˜åœ¨ä¸¤ç§lintï¼Œ&lt;a href=&quot;https://oclint.org/&quot;&gt;oc-lint&lt;/a&gt;/ inferã€‚&lt;/p&gt;

&lt;h4 id=&quot;oc-lint&quot;&gt;&lt;a href=&quot;https://oclint.org/&quot;&gt;oc-lint&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;å®‰è£…ï¼š &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew tap oclint/formulae&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;â€‹			&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;	 brew install oclint&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;â€‹			&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*// å®‰è£…xcpretty* gem install xcpretty&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å…ˆç®€å•ä»‹ç»ä¸€ä¸‹OC lintï¼šOC lint æ˜¯é€šè¿‡ç¼–è¯‘ä¹‹åçš„äº§ç‰© compile_commands.json å»åˆ†æçš„ï¼Œæ‰€ä»¥å¿…è¦çš„æ˜¯æˆ‘ä»¬æ‰§è¡Œoc-lintå¿…é¡»è¦buildã€‚ç„¶ååœ¨å®Œæˆä¹‹åä¼šä»¥è‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªhtmlåˆ†æç»“æœã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å…ˆè¯´è¯´ä»–çš„ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¿…é¡»è¦ç¼–è¯‘ï¼Œé¦–å…ˆè¿™æ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼Œè€Œä¸”å¯¹äºæˆ‘ä»¬ä¸€ä¸ªä¸æ”¯æŒæ¨¡æ‹Ÿå™¨çš„appï¼ˆå®³ï¼å› ä¸ºå†…éƒ¨ç›´æ’­çš„frameworkæ²¡æŠŠx86æ‰“è¿›å»ï¼‰è¿™æ˜¯æ¯”è¾ƒè‡´å‘½çš„å¯ä»¥è¯´&lt;/li&gt;
  &lt;li&gt;ä»–ä¸æ”¯æŒå¢é‡æŸ¥ï¼Œè¿™æ ·ä¼šå¸¦å‡ºæ¥å¾ˆå¤šå†å²é—ç•™é—®é¢˜ï¼Œå¯¹äºé›†æˆæ¥è¯´ï¼Œåˆæˆäº†ä¸€ä¸ªæ¯”è¾ƒçª˜å›°çš„é—®é¢˜ï¼ˆä½ æƒ³æƒ³ï¼Œä»¥å‰å¤šå°‘å¯èƒ½æœ‰é—®é¢˜çš„ä»£ç ï¼Œè¿™é›†æˆéƒ½å¾—æ”¹ï¼Œä¸å¾—æ”¹ä¸ªä¸‰å¤©ä¸‰å¤œçš„ğŸ˜ï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬è¯´è¯´ä»–çš„ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. oc-lint ä¸ä»…æŸ¥äº†ä¸è§„èŒƒçš„ä»£ç ï¼Œè€Œä¸”æŸ¥äº†å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜çš„åå‘³é“ä»£ç 
1. oc-lint å¯¹äºä»£ç ä¸¥é‡ç¨‹åº¦åšäº†ç­‰çº§åˆ†åŒ–ï¼Œå¹¶ä¸”ä»¥htmlçš„æ–¹å¼æ‰“å¼€ï¼Œæ›´åŠ çš„ç›´è§‚
1. oc-lintæ”¯æŒè‡ªå®šä¹‰è§„åˆ™ï¼Œå’Œä¿®æ”¹è§„åˆ™
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶ï¼Œå¯¹äº1.2çš„ç¼ºç‚¹ï¼Œå·²ç»æœ‰äº†ä¸€äº›æ–¹æ¡ˆè§£å†³ï¼Œ&lt;a href=&quot;https://github.com/shulong-apple/fast-oclint&quot;&gt;äº†è§£æ›´å¤š&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åé¢ä¼šå°è¯•é›†æˆåˆ°pre-commit hook, æ•¬è¯·æœŸå¾…â€¦&lt;/p&gt;

&lt;h4 id=&quot;infer&quot;&gt;&lt;a href=&quot;https://infer.liaohuqiu.net/docs/getting-started.html&quot;&gt;infer&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;å®‰è£…: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install infer&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;â€‹			å¯ä»¥é€‰æ‹©ä¸‹è½½å®‰è£…åŒ…å®‰è£…ï¼Œ&lt;a href=&quot;https://infer.liaohuqiu.net/docs/getting-started.html&quot;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Infer æ˜¯facebookæä¾›çš„ä¸€ä¸ªlint åº“&lt;/p&gt;

&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;	1. è²Œä¼¼infer ä¹Ÿéœ€è¦ç¼–è¯‘å·¥ç¨‹
	1. ä¸æ”¯æŒè‡ªå®šä¹‰è§„åˆ™
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. æ”¯æŒå¤šç§æ£€æµ‹ï¼ŒåŒ…æ‹¬ç©ºæŒ‡é’ˆã€å†…å­˜æ³„æ¼ç­‰ç­‰çš„æ£€æµ‹
1. æ”¯æŒå¢é‡æ£€æµ‹
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…·ä½“æˆ‘ä¹Ÿæ²¡æœ‰å¤ªå¤šç ”ç©¶ï¼Œéœ€è¦æ·±å…¥ç ”ç©¶çš„ï¼Œ&lt;a href=&quot;https://fbinfer.com/docs/analyzing-apps-or-projects&quot;&gt;è¯·å‚è€ƒ&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;objective-clint-è‡ªåˆ¶hook-&quot;&gt;&lt;a href=&quot;https://github.com/HaoXianSen/Objective-CLint&quot;&gt;Objective-CLint è‡ªåˆ¶hook &lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;è¿™ä¸ªåº“æ˜¯æˆ‘åŸºäºSpaceCommandä¸‰æ–¹åº“ï¼Œåšçš„pre-commit hookï¼Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;SpaceCommandæ˜¯åŸºäºclang-format åˆ¶ä½œçš„ä»£ç è§„èŒƒå·¥å…·ï¼Œè€Œä¸”å†™äº†ä¸€äº›è‡ªå®šä¹‰è§„åˆ™ï¼Œç”¨æ¥æ£€æµ‹clang-formatå¿½ç•¥æˆ–è€…æœ‰æ­§ä¹‰çš„éƒ¨åˆ†ã€‚å®ƒæ”¯æŒäº†æ£€æµ‹ä¸è§„èŒƒä»£ç ï¼Œå¹¶ç»™å‡ºç»ˆç«¯æç¤ºï¼›è€Œä¸”æä¾›äº†ä¸€é”®æ ¼å¼åŒ–æ‰€æœ‰æœ‰é—®é¢˜çš„ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;é‚£ä¹ˆObjective-CLint åœ¨å®ƒçš„åŸºç¡€ä¸Šï¼Œ1. æˆ‘æ˜¾ç¤ºäº†å°†å®ƒé…ç½®æˆä¸€ä¸ªå¯ä»¥pre-commité›†æˆçš„hookï¼Œ2. å¢åŠ äº†å¯è§†åŒ–diff åˆ°htmlï¼Œè‡ªåŠ¨æ‰“å¼€ 3. å»æ‰äº†ä¸€é”®æ ¼å¼åŒ– 5. ä¿®æ”¹è‡ªå®šä¹‰è§„åˆ™ï¼Œä½¿å¾—é€‚ç”¨æ›´åŠ å¹¿æ³›ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“å†…å®¹ä»‹ç»ï¼Œè¯·ç§»æ­¥åˆ°&lt;a href=&quot;https://haoxiansen.github.io/2022/09/14/Objective_CLint.html&quot;&gt;ä¸ªäººåšå®¢Objective-CLint&lt;/a&gt; æˆ–è€…ç§»æ­¥åˆ°&lt;a href=&quot;https://github.com/HaoXianSen/Objective-CLint&quot;&gt;github&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åˆ°æ­¤ï¼Œæˆ‘ä»¬å¯¹äºOCä»£ç å·²ç»æœ‰äº†å¥½å‡ ç§æ–¹æ¡ˆï¼Œæˆ‘é€‰æ‹©äº†å®¹æ˜“é›†æˆä¸”è½»é‡çº§çš„è‡ªåˆ¶hookã€‚&lt;/p&gt;

&lt;h3 id=&quot;swift-lint&quot;&gt;Swift Lint&lt;/h3&gt;

&lt;h4 id=&quot;swiftlint&quot;&gt;&lt;a href=&quot;https://github.com/realm/SwiftLint&quot;&gt;swiftLint&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;â€‹	Swift ä»£ç æ¯«æ— ç–‘é—®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨SwiftLintå»é›†æˆã€‚swiftLint å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†pre-commit hookï¼Œæˆ‘	ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥forkï¼Œä¿®æ”¹è§„åˆ™ä½¿ç”¨&lt;/p&gt;

&lt;p&gt;â€‹	å…·ä½“è¯·æŸ¥çœ‹githubï¼šhttps://github.com/realm/SwiftLint&lt;/p&gt;

&lt;h3 id=&quot;é›†æˆ&quot;&gt;é›†æˆ&lt;/h3&gt;

&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„lint å·¥å…· ä»¥åŠhook å·¥å…·å·²ç»é½å…¨ï¼Œå³ pre-commit + Objective-CLint + SwiftLint!&lt;/p&gt;

&lt;p&gt;Ok, å½“ç„¶æˆ‘ä»¬è¿˜æœ‰ä¸€äº›å·¥ä½œé‡éœ€è¦åšï¼Œä¸ºäº†å›¢é˜Ÿæ›´å¥½çš„é›†æˆï¼Œæˆ‘ä»¬æ·»åŠ æ£€æµ‹å®‰è£…è„šæœ¬ä½äºpod pre_install, ç›®çš„åœ¨äºè‡ªåŠ¨æ£€æµ‹æ˜¯å¦å®‰è£…äº†pre-commitï¼Œä»¥åŠè‡ªåŠ¨å®‰è£…pre-commitã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æ˜¯æ£€æµ‹è„šæœ¬ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ­£åœ¨æ£€æŸ¥å®‰è£…å¿…è¦å·¥å…·...&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# æ£€æµ‹æ˜¯å¦å®‰è£…äº†homebrew&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; brew &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;âœ…homebrew å·²ç»å®‰è£…&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else 
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ­£åœ¨å®‰è£…brew...&quot;&lt;/span&gt;
    /bin/bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
   &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'âœ…å®‰è£…å®Œæˆhomebrew ğŸºğŸºğŸº /n'&lt;/span&gt;
   
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# æ£€æµ‹æ˜¯å¦å®‰è£…äº†pre-commit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; pre-commit&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;âœ…pre-commit å·²ç»å®‰è£…&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ­£åœ¨å®‰è£…pre-commit...&quot;&lt;/span&gt;
    brew &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;pre-commit
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'âœ…å®‰è£…å®Œæˆpre-commit ğŸºğŸºğŸº/n'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi


if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.pre-commit-config.yaml&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[31mâæ–‡ä»¶ &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.pre-commit-config.yaml&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ä¸å­˜åœ¨ï¼Œ è¯·æ·»åŠ .pre-commit-config.yaml&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[0m&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;pre-commit &lt;span class=&quot;nb&quot;&gt;install
echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[36m ...................æ‰€æœ‰å·¥å…·éƒ½å®‰è£…æˆåŠŸğŸ˜ğŸ˜ğŸ˜ &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[0m&quot;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ok, æˆ‘ä»¬æŠŠå®ƒé›†æˆåˆ°podä¸­ï¼Œå½“ç„¶æ²¡æœ‰ä½¿ç”¨podç®¡ç†çš„ï¼Œç›´æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬å³å¯ã€‚æŠŠä¸‹é¢çš„è„šæœ¬åµŒå…¥åˆ°podfileä¸­&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;pre_install&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;installer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`sh check_tools.sh`&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;Pod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ·»åŠ .pre-commit-config.yaml&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;fail_fast&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;repos&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://github.com/HaoXianSen/Objective-CLint.git&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v0.0.4&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;objc-lint&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;objc-format&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;format-objc-hook&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;script&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;require_serial&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://github.com/realm/SwiftLint&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0.49.1&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;swiftlint&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;OKï¼Œè¿™æ ·æˆ‘ä»¬æ•´ä¸ªé›†æˆå°±å®Œæˆäº†ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶swiftLintçš„é…ç½®ä¸ä¸€å®šæ˜¯é€‚ç”¨äºæˆ‘ä»¬çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³reportä¸ºhtmlã€æˆ–è€…æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„è§„åˆ™ç­‰ç­‰ï¼Œå°±éœ€è¦æˆ‘ä»¬forkä¸€ä»½swiftLintï¼Œåšä¸€äº›è‡ªå·±çš„é€‚é…ã€‚ä¸Šé¢çš„swiftLintå°±ä½¿ç”¨è‡ªå·±çš„repoä»¥åŠè‡ªå·±tagå°±å¥½äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥è¯´æ•´iOS æ··åˆå‘å¼€çš„ä»£ç è§„èŒƒlintå°±é›†æˆå®Œäº‹äº†ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶æˆ‘ä»¬è¿˜æœ‰ä¼˜åŒ–çš„éƒ¨åˆ†ï¼Œé¦–å…ˆè‡ªå·±çš„lint åªæ˜¯è§„èŒƒæ£€æµ‹ï¼Œä¸æƒ³OCLint é‚£æ ·é¢ç§¯å¤§ï¼Œå¹¶ä¸”è¾“å‡ºä¹Ÿä¸æ˜¯å¾ˆå“‡å¡ã€‚åç»­æˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨fast-oclintçš„æ–¹æ¡ˆï¼Œæ—¢èƒ½ä½¿ç”¨OCLintçš„å¼ºå¤§ï¼Œåˆèƒ½ä¸ç”¨ç¼–è¯‘è¿˜æ”¯æŒå¢é‡ç¼–è¯‘ã€‚&lt;/p&gt;

&lt;p&gt;â€‹&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="iOS" /><summary type="html">å‰æ code review æ˜¯æˆ‘ä»¬å·¥ä½œä¸­å¯ä»¥è¯´å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œä¸€æ–¹é¢èƒ½å¤Ÿææ—©çš„å‘ç°ä»£ç ä¸­ä¸åˆç†çš„éƒ¨åˆ†ã€æˆ–è€…ä¸ç¨³å®šã€æ¶æ„ä¸åˆç†çš„éƒ¨åˆ†ï¼Œæé«˜ä»£ç çš„è´¨é‡ï¼›å¦å¤–ä¸€æ–¹é¢èƒ½ï¼Œæ›´å¤Ÿè®©å›¢é˜Ÿçš„çŸ¥è¯†å…±äº«ï¼Œäº’ç›¸ç†Ÿæ‚‰ä¸šåŠ¡éœ€æ±‚ï¼Œä»¥åŠå›¢é˜Ÿå†™çš„å¥½çš„éƒ¨åˆ†ã€‚OKï¼Œä½œä¸ºcode reviewæœ€æ—©æœ€åŸºç¡€çš„ä¸€ç¯ï¼Œå¯ä»¥è¯´æ˜¯ä»£ç è§„èŒƒã€‚å¦‚æœäººå·¥è¿›è¡Œä»£ç è§„èŒƒçš„ç»´æŠ¤ï¼Œéš¾å…ä¼šé—æ¼ï¼Œè€Œä¸”ä¼šèŠ±è´¹æ—¶é—´åœ¨è¿™éƒ¨åˆ†ã€‚ æ‰€ä»¥ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åšçš„æ˜¯ï¼Œåšä¸€ä¸ªlintå¸®åŠ©æˆ‘ä»¬æ£€æµ‹ä¸è§„èŒƒçš„ä»£ç ï¼ŒOKï¼Œä¸‹é¢å°±lintï¼Œå¼€å§‹ç ”ç©¶ï¼ Lint æ—¶æœº æˆ‘ä»¬ç†ŸçŸ¥çš„Objective-C lintï¼Œæœ‰OClintã€Infer; swift æœ‰swiftLintï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆä¸è€ƒè™‘è¿™ä¸ªå‡ ä¸ªlintçš„é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼Œlintåº”è¯¥æ”¾åˆ°ä»€ä¹ˆé˜¶æ®µï¼Ÿ æ”¾åˆ°buildæ—¶æœŸï¼Ÿ è¿™ç§æ–¹æ¡ˆè¢«æˆ‘ä»¬passæ‰äº†ï¼Œé¦–å…ˆæ”¾åˆ°buildæ—¶æœŸä¼šå¢åŠ æˆ‘ä»¬çš„buildæ—¶é—´ï¼Œç¬¬äºŒäº‹å®ä¸Šæˆ‘ä»¬éœ€è¦åµŒå…¥è„šæœ¬åˆ°é¡¹ç›®é‡Œï¼Œå¯èƒ½ä¼šå½±å“åˆ°æ‰“åŒ…ã€‚ æ”¾åˆ°git push ä¹‹ågitlab pipelineæ—¶æœŸï¼Ÿ è¿™ç§æ–¹æ¡ˆä¸å‡ºæ„å¤–ä¹Ÿè¢«passäº†ï¼Œé¦–å…ˆå¦‚æœçŸ¥é“pipeline jobçš„äººéƒ½çŸ¥é“ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®runner, æœ¬èº«æ¥è¯´é…ç½®åŠ é›†æˆï¼Œå¯èƒ½å°±ä¸æ˜¯ä¸€ä¸ªå®¹æ˜“çš„äº‹æƒ…ï¼Œè€Œä¸”å¯¹äºæˆ‘æ¥è¯´æˆ‘è§‰å¾—è¿™ä¸ªäº‹æƒ…ï¼Œå¤ªæ™šäº†ï¼Œlint æœ‰é—®é¢˜ï¼Œè¿˜ç­‰å†æ¬¡pushâ€¦. æ”¾åˆ°pre commitæ—¶æœŸï¼Ÿ Ok, å¯¹äºæ¯”è¾ƒåˆé€‚çš„äº‹æƒ…ï¼Œæˆ‘è§‰å¾—å°±æ˜¯åœ¨precommitæ—¶æœŸï¼Œå› ä¸ºåŸºäºgit ç®¡ç†ï¼Œæˆ‘ä»¬ä»£ç æ¯æ¬¡æ”¹åŠ¨ä¹‹åéƒ½éœ€è¦commitï¼Œé‚£ä¹ˆcommitäº‹æƒ…å»åšlintè¿™ä»¶äº‹æƒ…ï¼Œæ˜¯éå¸¸åˆé€‚çš„ï¼Œå¦‚æœå­˜åœ¨é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¿®æ”¹ä¹‹åï¼Œå†æ¬¡commitã€‚æ—¶é—´ä¸Šï¼Œæ—¶æœºä¸Šæˆ‘è§‰å¾—éƒ½å¾ˆåˆé€‚ okï¼Œ å¯¹äº lint æ”¾åˆ°å“ªä¸ªæ—¶æœºçš„é—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»ç¡®å®šâ€“pre commitæ—¶æœŸ pre-commit git å…¶å®ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šç§çš„hookæ–¹å¼ï¼Œéšä¾¿æ‰“å¼€ä¸€ä¸ª.gitæ–‡ä»¶å¤¹å°±å¯ä»¥çœ‹åˆ°ä¸€å †çš„hooks exampleæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š OKï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬æƒ³è¦hookï¼Œå°±å˜å¾—éå¸¸å®¹æ˜“ï¼Œåªè¦æˆ‘ä»¬ä¿®æ”¹pre-commitä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶åœ¨é‡Œè¾¹æŒ‰ç…§exampleåµŒå…¥æ‰§è¡Œä»£ç å³å¯ã€‚ è¿™ä¸€æ­¥ï¼Œæ—©å°±æœ‰äººå¸®æˆ‘ä»¬åšäº†ï¼Œé‚£å°±æ˜¯pre-commit ä»–ä¸ä»…ç®€å•äº†æˆ‘ä»¬çš„æ“ä½œï¼Œå¹¶ä¸”èµ·åˆ°äº†è„šæœ¬lintä»£ç åˆ†ç¦»çš„æ•ˆæœï¼Œä»–é€šè¿‡.pre-commit-config.yaml æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œåœ¨æ‰§è¡Œgit commitæ—¶å€™æ‰§è¡Œpre-commit è„šæœ¬ï¼Œå†è€Œæ‰§è¡Œåˆ°å®‰è£…çš„pre-commitä»£ç é‡Œï¼Œè¿›è¡Œclone .pre-commit-config.yamlé‡Œé…ç½®çš„repoï¼Œä»¥åŠåˆ†æï¼Œæ‰§è¡Œå¯¹åº”çš„hookä»£ç ã€‚ æ¥ä¸‹æ¥ç®€å•çš„ä»‹ç»ä¸€ä¸‹pre-commit ç›¸å…³çš„ä¸œè¥¿ï¼š å®‰è£… Mac æ¨èä½¿ç”¨ï¼šbrew install pre-commit å…¶ä»–å®‰è£…ï¼špip install pre-commit conda install -c conda-forge pre-commit é…ç½® å®‰è£…å®Œpre-commitä¹‹åï¼Œåœ¨.git åŒçº§ç›®å½•ï¼Œæ·»åŠ .pre-commit-config.yaml æ–‡ä»¶ï¼Œåˆ™å¯æ”¯æŒpre-commit .pre-commit-config.yamlçš„ç›¸å…³é…ç½®ï¼š repos: - repo: https://github.com/pre-commit/pre-commit-hooks rev: v2.3.0 hooks: - id: check-yaml - id: end-of-file-fixer - id: trailing-whitespace - repo: https://github.com/psf/black rev: 21.12b0 hooks: - id: black æ³¨æ„ç‚¹ï¼šrev: ä¸å†æ”¯æŒcommit hash idï¼Œ åªæ”¯æŒtag å…·ä½“å‚è€ƒï¼šhttps://pre-commit.com/#plugins åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„hook ä¸€ä¸ªhookå¿…é¡»è¦åŒ…å«a .pre-commit-hooks.yaml æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å‘Šè¯‰pre-commitï¼Œè¿™ä¸ªhookåº“é‡ŒåŒ…å«çš„hook idç­‰ä¿¡æ¯â€¦ å¤§æ¦‚å¼ è¿™ä¸ªæ ·å­â€¦ - id: trailing-whitespace name: Trim Trailing Whitespace description: This hook trims trailing whitespace. entry: trailing-whitespace-fixer language: python types: [text] â€‹ hooks ä»“åº“ï¼Œæ”¯æŒå¾ˆå¤šç§è¯­è¨€ï¼Œæ¯ç§è¯­è¨€åŒ…å«çš„æ–‡ä»¶ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œæ¯”å¦‚script ï¼ˆshellè„šæœ¬ï¼‰å¿…é¡»entryå‚ æ•°ç»™ä¸€ä¸ªç›¸å¯¹è·¯å¾„çš„shellè„šæœ¬ï¼›æ¯”å¦‚pythonï¼Œå¿…é¡»è¦æ‰§è¡Œpip install .ï¼ˆåŠåŒ…æ‹¬setup.pyæˆ–è€… pyproject.tomlï¼‰ä»¥åŠentryä¸€èˆ¬åœ¨setup.py é‡Œçš„console_scriptsæˆ–è€…scriptsé…ç½®çš„ã€‚ â€‹ äº†è§£æ›´å¤š Objective-C Lint ä¸Šé¢æåˆ°ç°å­˜åœ¨ä¸¤ç§lintï¼Œoc-lint/ inferã€‚ oc-lint å®‰è£…ï¼š brew tap oclint/formulae â€‹ brew install oclint â€‹ *// å®‰è£…xcpretty* gem install xcpretty å…ˆç®€å•ä»‹ç»ä¸€ä¸‹OC lintï¼šOC lint æ˜¯é€šè¿‡ç¼–è¯‘ä¹‹åçš„äº§ç‰© compile_commands.json å»åˆ†æçš„ï¼Œæ‰€ä»¥å¿…è¦çš„æ˜¯æˆ‘ä»¬æ‰§è¡Œoc-lintå¿…é¡»è¦buildã€‚ç„¶ååœ¨å®Œæˆä¹‹åä¼šä»¥è‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªhtmlåˆ†æç»“æœã€‚ æˆ‘ä»¬å…ˆè¯´è¯´ä»–çš„ç¼ºç‚¹ï¼š å¿…é¡»è¦ç¼–è¯‘ï¼Œé¦–å…ˆè¿™æ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼Œè€Œä¸”å¯¹äºæˆ‘ä»¬ä¸€ä¸ªä¸æ”¯æŒæ¨¡æ‹Ÿå™¨çš„appï¼ˆå®³ï¼å› ä¸ºå†…éƒ¨ç›´æ’­çš„frameworkæ²¡æŠŠx86æ‰“è¿›å»ï¼‰è¿™æ˜¯æ¯”è¾ƒè‡´å‘½çš„å¯ä»¥è¯´ ä»–ä¸æ”¯æŒå¢é‡æŸ¥ï¼Œè¿™æ ·ä¼šå¸¦å‡ºæ¥å¾ˆå¤šå†å²é—ç•™é—®é¢˜ï¼Œå¯¹äºé›†æˆæ¥è¯´ï¼Œåˆæˆäº†ä¸€ä¸ªæ¯”è¾ƒçª˜å›°çš„é—®é¢˜ï¼ˆä½ æƒ³æƒ³ï¼Œä»¥å‰å¤šå°‘å¯èƒ½æœ‰é—®é¢˜çš„ä»£ç ï¼Œè¿™é›†æˆéƒ½å¾—æ”¹ï¼Œä¸å¾—æ”¹ä¸ªä¸‰å¤©ä¸‰å¤œçš„ğŸ˜ï¼‰ æ¥ä¸‹æ¥æˆ‘ä»¬è¯´è¯´ä»–çš„ä¼˜ç‚¹ï¼š 1. oc-lint ä¸ä»…æŸ¥äº†ä¸è§„èŒƒçš„ä»£ç ï¼Œè€Œä¸”æŸ¥äº†å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜çš„åå‘³é“ä»£ç  1. oc-lint å¯¹äºä»£ç ä¸¥é‡ç¨‹åº¦åšäº†ç­‰çº§åˆ†åŒ–ï¼Œå¹¶ä¸”ä»¥htmlçš„æ–¹å¼æ‰“å¼€ï¼Œæ›´åŠ çš„ç›´è§‚ 1. oc-lintæ”¯æŒè‡ªå®šä¹‰è§„åˆ™ï¼Œå’Œä¿®æ”¹è§„åˆ™ å½“ç„¶ï¼Œå¯¹äº1.2çš„ç¼ºç‚¹ï¼Œå·²ç»æœ‰äº†ä¸€äº›æ–¹æ¡ˆè§£å†³ï¼Œäº†è§£æ›´å¤š åé¢ä¼šå°è¯•é›†æˆåˆ°pre-commit hook, æ•¬è¯·æœŸå¾…â€¦ infer å®‰è£…: brew install infer â€‹ å¯ä»¥é€‰æ‹©ä¸‹è½½å®‰è£…åŒ…å®‰è£…ï¼Œä¸‹è½½åœ°å€ Infer æ˜¯facebookæä¾›çš„ä¸€ä¸ªlint åº“ ç¼ºç‚¹ï¼š 1. è²Œä¼¼infer ä¹Ÿéœ€è¦ç¼–è¯‘å·¥ç¨‹ 1. ä¸æ”¯æŒè‡ªå®šä¹‰è§„åˆ™ ä¼˜ç‚¹ï¼š 1. æ”¯æŒå¤šç§æ£€æµ‹ï¼ŒåŒ…æ‹¬ç©ºæŒ‡é’ˆã€å†…å­˜æ³„æ¼ç­‰ç­‰çš„æ£€æµ‹ 1. æ”¯æŒå¢é‡æ£€æµ‹ å…·ä½“æˆ‘ä¹Ÿæ²¡æœ‰å¤ªå¤šç ”ç©¶ï¼Œéœ€è¦æ·±å…¥ç ”ç©¶çš„ï¼Œè¯·å‚è€ƒ Objective-CLint è‡ªåˆ¶hook è¿™ä¸ªåº“æ˜¯æˆ‘åŸºäºSpaceCommandä¸‰æ–¹åº“ï¼Œåšçš„pre-commit hookï¼Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š SpaceCommandæ˜¯åŸºäºclang-format åˆ¶ä½œçš„ä»£ç è§„èŒƒå·¥å…·ï¼Œè€Œä¸”å†™äº†ä¸€äº›è‡ªå®šä¹‰è§„åˆ™ï¼Œç”¨æ¥æ£€æµ‹clang-formatå¿½ç•¥æˆ–è€…æœ‰æ­§ä¹‰çš„éƒ¨åˆ†ã€‚å®ƒæ”¯æŒäº†æ£€æµ‹ä¸è§„èŒƒä»£ç ï¼Œå¹¶ç»™å‡ºç»ˆç«¯æç¤ºï¼›è€Œä¸”æä¾›äº†ä¸€é”®æ ¼å¼åŒ–æ‰€æœ‰æœ‰é—®é¢˜çš„ä»£ç ã€‚ é‚£ä¹ˆObjective-CLint åœ¨å®ƒçš„åŸºç¡€ä¸Šï¼Œ1. æˆ‘æ˜¾ç¤ºäº†å°†å®ƒé…ç½®æˆä¸€ä¸ªå¯ä»¥pre-commité›†æˆçš„hookï¼Œ2. å¢åŠ äº†å¯è§†åŒ–diff åˆ°htmlï¼Œè‡ªåŠ¨æ‰“å¼€ 3. å»æ‰äº†ä¸€é”®æ ¼å¼åŒ– 5. ä¿®æ”¹è‡ªå®šä¹‰è§„åˆ™ï¼Œä½¿å¾—é€‚ç”¨æ›´åŠ å¹¿æ³›ã€‚ å…·ä½“å†…å®¹ä»‹ç»ï¼Œè¯·ç§»æ­¥åˆ°ä¸ªäººåšå®¢Objective-CLint æˆ–è€…ç§»æ­¥åˆ°github åˆ°æ­¤ï¼Œæˆ‘ä»¬å¯¹äºOCä»£ç å·²ç»æœ‰äº†å¥½å‡ ç§æ–¹æ¡ˆï¼Œæˆ‘é€‰æ‹©äº†å®¹æ˜“é›†æˆä¸”è½»é‡çº§çš„è‡ªåˆ¶hookã€‚ Swift Lint swiftLint â€‹ Swift ä»£ç æ¯«æ— ç–‘é—®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨SwiftLintå»é›†æˆã€‚swiftLint å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†pre-commit hookï¼Œæˆ‘ ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥forkï¼Œä¿®æ”¹è§„åˆ™ä½¿ç”¨ â€‹ å…·ä½“è¯·æŸ¥çœ‹githubï¼šhttps://github.com/realm/SwiftLint é›†æˆ åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„lint å·¥å…· ä»¥åŠhook å·¥å…·å·²ç»é½å…¨ï¼Œå³ pre-commit + Objective-CLint + SwiftLint! Ok, å½“ç„¶æˆ‘ä»¬è¿˜æœ‰ä¸€äº›å·¥ä½œé‡éœ€è¦åšï¼Œä¸ºäº†å›¢é˜Ÿæ›´å¥½çš„é›†æˆï¼Œæˆ‘ä»¬æ·»åŠ æ£€æµ‹å®‰è£…è„šæœ¬ä½äºpod pre_install, ç›®çš„åœ¨äºè‡ªåŠ¨æ£€æµ‹æ˜¯å¦å®‰è£…äº†pre-commitï¼Œä»¥åŠè‡ªåŠ¨å®‰è£…pre-commitã€‚ ä¸‹é¢æ˜¯æ£€æµ‹è„šæœ¬ï¼š #!/bin/bash echo &quot;æ­£åœ¨æ£€æŸ¥å®‰è£…å¿…è¦å·¥å…·...&quot; # æ£€æµ‹æ˜¯å¦å®‰è£…äº†homebrew if [ &quot;$(command -v brew -v)&quot; ]; then echo &quot;âœ…homebrew å·²ç»å®‰è£…&quot; else echo &quot;æ­£åœ¨å®‰è£…brew...&quot; /bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot; echo 'âœ…å®‰è£…å®Œæˆhomebrew ğŸºğŸºğŸº /n' fi # æ£€æµ‹æ˜¯å¦å®‰è£…äº†pre-commit if [ &quot;$(command -v pre-commit)&quot; ]; then echo &quot;âœ…pre-commit å·²ç»å®‰è£…&quot; else echo &quot;æ­£åœ¨å®‰è£…pre-commit...&quot; brew install pre-commit echo 'âœ…å®‰è£…å®Œæˆpre-commit ğŸºğŸºğŸº/n' fi if [ ! -f &quot;.pre-commit-config.yaml&quot; ]; then echo &quot;\033[31mâæ–‡ä»¶ \&quot;.pre-commit-config.yaml\&quot; ä¸å­˜åœ¨ï¼Œ è¯·æ·»åŠ .pre-commit-config.yaml\033[0m&quot; exit 1 fi pre-commit install echo &quot;\033[36m ...................æ‰€æœ‰å·¥å…·éƒ½å®‰è£…æˆåŠŸğŸ˜ğŸ˜ğŸ˜ \033[0m&quot; Ok, æˆ‘ä»¬æŠŠå®ƒé›†æˆåˆ°podä¸­ï¼Œå½“ç„¶æ²¡æœ‰ä½¿ç”¨podç®¡ç†çš„ï¼Œç›´æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬å³å¯ã€‚æŠŠä¸‹é¢çš„è„šæœ¬åµŒå…¥åˆ°podfileä¸­ pre_install do |installer| flag = `sh check_tools.sh` Pod::UI.puts flag end æ·»åŠ .pre-commit-config.yaml fail_fast: false repos: - repo: https://github.com/HaoXianSen/Objective-CLint.git rev: v0.0.4 hooks: - id: objc-lint name: objc-format entry: format-objc-hook language: script require_serial: true verbose: true - repo: https://github.com/realm/SwiftLint rev: 0.49.1 hooks: - id: swiftlint OKï¼Œè¿™æ ·æˆ‘ä»¬æ•´ä¸ªé›†æˆå°±å®Œæˆäº†ã€‚ å½“ç„¶swiftLintçš„é…ç½®ä¸ä¸€å®šæ˜¯é€‚ç”¨äºæˆ‘ä»¬çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³reportä¸ºhtmlã€æˆ–è€…æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„è§„åˆ™ç­‰ç­‰ï¼Œå°±éœ€è¦æˆ‘ä»¬forkä¸€ä»½swiftLintï¼Œåšä¸€äº›è‡ªå·±çš„é€‚é…ã€‚ä¸Šé¢çš„swiftLintå°±ä½¿ç”¨è‡ªå·±çš„repoä»¥åŠè‡ªå·±tagå°±å¥½äº†ã€‚ æ€»ç»“ åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥è¯´æ•´iOS æ··åˆå‘å¼€çš„ä»£ç è§„èŒƒlintå°±é›†æˆå®Œäº‹äº†ã€‚ å½“ç„¶æˆ‘ä»¬è¿˜æœ‰ä¼˜åŒ–çš„éƒ¨åˆ†ï¼Œé¦–å…ˆè‡ªå·±çš„lint åªæ˜¯è§„èŒƒæ£€æµ‹ï¼Œä¸æƒ³OCLint é‚£æ ·é¢ç§¯å¤§ï¼Œå¹¶ä¸”è¾“å‡ºä¹Ÿä¸æ˜¯å¾ˆå“‡å¡ã€‚åç»­æˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨fast-oclintçš„æ–¹æ¡ˆï¼Œæ—¢èƒ½ä½¿ç”¨OCLintçš„å¼ºå¤§ï¼Œåˆèƒ½ä¸ç”¨ç¼–è¯‘è¿˜æ”¯æŒå¢é‡ç¼–è¯‘ã€‚ â€‹</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220914182001fengjingpic.png" /><media:content medium="image" url="https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/20220914182001fengjingpic.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">æˆ‘æƒ³æä¸ªmac app æ’ä»¶ï¼Œä»…ä»…ä¸ºäº†Typroaæ’å…¥å‡ è¡Œé¢„ç½®æ–‡å­—</title><link href="http://localhost:4000/2022/08/26/%E6%88%91%E6%83%B3%E6%90%9E%E4%B8%AATyproa%E7%9A%84%E6%8F%92%E4%BB%B6-%E4%BB%85%E4%BB%85%E4%B8%BA%E4%BA%86%E6%8F%92%E5%85%A5%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81.html" rel="alternate" type="text/html" title="æˆ‘æƒ³æä¸ªmac app æ’ä»¶ï¼Œä»…ä»…ä¸ºäº†Typroaæ’å…¥å‡ è¡Œé¢„ç½®æ–‡å­—" /><published>2022-08-26T00:00:00+08:00</published><updated>2022-08-26T00:00:00+08:00</updated><id>http://localhost:4000/2022/08/26/%E6%88%91%E6%83%B3%E6%90%9E%E4%B8%AATyproa%E7%9A%84%E6%8F%92%E4%BB%B6,%E4%BB%85%E4%BB%85%E4%B8%BA%E4%BA%86%E6%8F%92%E5%85%A5%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81</id><content type="html" xml:base="http://localhost:4000/2022/08/26/%E6%88%91%E6%83%B3%E6%90%9E%E4%B8%AATyproa%E7%9A%84%E6%8F%92%E4%BB%B6-%E4%BB%85%E4%BB%85%E4%B8%BA%E4%BA%86%E6%8F%92%E5%85%A5%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81.html">&lt;h2 id=&quot;å‰æ&quot;&gt;å‰æ&lt;/h2&gt;

&lt;p&gt;ä¸ºäº†æ›´å¥½çš„ç»´æŒæˆ‘çš„åšå®¢ç³»ç»Ÿï¼Œæƒ³ç€ä¹‹åçš„åšå®¢éƒ½å‘å¸ƒäºgithub.ioï¼Œ é‚£ä¹ˆå¦‚æœä½ æœ‰æ­å»ºè¿‡github.io é‚£ä¹ˆç›¸æ¯”éƒ½çŸ¥é“YAML, é€šè¿‡MARK down ä¸­æ’å…¥YAML FORMAT è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åšå®¢çš„æ ‡é¢˜ã€è¯„è®ºç­‰ç­‰ã€‚ã€‚é‚£ä¹ˆç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä¸æƒ³ç”¨Typoraæ¯æ¬¡å»ºç«‹ä¸€ä¸ªæ–°blogï¼Œéƒ½éœ€è¦ç¹ççš„æ’å…¥é‚£ä¸€å †YAMLï¼Œæ¯”å¦‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;title: positionã€anchorPointã€frameç†è§£

tags: iOS

key: 107

# article_header:

# type: cover

# image:

# src: https://user-images.githubusercontent.com/8369671/80915045-153ff780-8d82-11ea-9acf-6ccbf2b05d9d.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;OKï¼Œæ‰€ä»¥é¦–å…ˆå‘¢æˆ‘æŠŠTyporaçš„æ‰€æœ‰æ–‡æ¡£çœ‹äº†ä¸€éï¼Œæ²¡æœ‰å…¥å£å¯é…ç½®ã€‚é‚£å’‹åŠï¼Ÿ&lt;/p&gt;

&lt;p&gt;æƒ³æ³•ä¹Ÿå°±ä»è¿™è¯ç”Ÿäº†ï¼Œæˆ‘èƒ½ä¸èƒ½å†™ä¸ªæ’ä»¶ï¼Œåœ¨Typora æ–°å»ºæ–‡ä»¶çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ’å…¥é¢„ç½®æ–‡å­—ï¼Œæ¥ä¸‹æ¥è®°å½•æ’ä»¶å¼€å‘è¿‡ç¨‹ï¼ŒæˆåŠŸä¸æˆåŠŸæœ€åè§åˆ†æ™“ï¼&lt;/p&gt;

&lt;h2 id=&quot;ç€æ‰‹å¹²æŸ¥èµ„æ–™&quot;&gt;ç€æ‰‹å¹²ï¼ˆæŸ¥èµ„æ–™ï¼‰&lt;/h2&gt;

&lt;p&gt;é€šè¿‡æŸ¥çœ‹èµ„æ–™ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸œè¥¿è¾…åŠ©ï¼Œ1.&lt;a href=&quot;https://www.jianshu.com/p/1e3fe0a8c048&quot;&gt;class-dump)&lt;/a&gt; 2. &lt;a href=&quot;https://github.com/Tyilo/insert_dylib&quot;&gt;insert_dylib&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â åŸºæœ¬åŸç†å°±æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;Mach-O äºŒè¿›åˆ¶æ–‡ä»¶Load Commandsä¸­çš„ LC_LOAD_DYLIB æ ‡å¤´å‘Šè¯‰ macOSåœ¨æ‰§è¡ŒæœŸé—´è¦åŠ è½½å“ªäº›åŠ¨æ€åº“ (dylib)ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡LC_LOAD_DYLIBå°±å¯ä»¥ã€‚è€Œ&lt;a href=&quot;https://github.com/Tyilo/insert_dylib&quot;&gt;insert_dylib&lt;/a&gt;å·¥å…·å·²ç»ä¸ºæˆ‘ä»¬å®ç°äº†æ·»åŠ çš„åŠŸèƒ½&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥ä¸€ä¸ªä¸€ä¸ªè§£é‡Šï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;class-dump&lt;/p&gt;

    &lt;p&gt;é€šè¿‡åå­—æˆ‘ä»¬å¤§æ¦‚èƒ½çŒœåˆ°è¿™æ˜¯ä¸€ä¸ªä»€ä¹ˆå·¥å…·ï¼Œç±»ä¼¼ä¸€ä¸ªè§£é‡Šç±»çš„å·¥å…·ï¼Œç¡®å®ä»–ä¹Ÿæ˜¯å¹²è¿™ä¸ªçš„ï¼Œæ­£ç¡®å®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡class-dump [option] Mach-oæ–‡ä»¶ï¼Œè¾“å‡ºmac appçš„æš´éœ²ç±»çš„ç›¸å…³å±æ€§ï¼ŒOKï¼Œæˆ‘ä»¬ç”¨çš„å°±æ˜¯class-dump -H Mach-oæ–‡ä»¶ è¾“å‡ºå¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šè¿‡å¤´æ–‡ä»¶æŸ¥çœ‹mac appæºå¤´æ–‡ä»¶ï¼Œç„¶åæ‰¾åˆ°éœ€è¦hookçš„ç±»è¿›è¡Œhookï¼ˆå…·ä½“çš„å®‰è£…å¯ä»¥ç‚¹å‡»è¶…é“¾æ¥æŸ¥çœ‹ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;insert_dylib&lt;/p&gt;

    &lt;p&gt;è¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ’å…¥ä¸€ä¸ªdylib åˆ°Mach-oäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦åšä¸€ä¸ªframeworkç„¶åé€šè¿‡è¿™ä¸ªåº“ï¼ŒåµŒå…¥åˆ°appçš„Mach-oäºŒè¿›åˆ¶æ–‡ä»¶é‡Œ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;okï¼Œå·¥å…·éƒ½å…¨ä¹äº†ï¼Œæ¥ä¸‹æ¥çš„æ—¶é—´ï¼Œå°±æ˜¯éœ€è¦æˆ‘ä»¬åšä¸€ä¸ªframeworkï¼Œè¿™ä¸ªframeworkæ˜¯ç”¨ä¸“é—¨hookçš„åŠ¨æ€åº“ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶hookï¼ŒObjective-Cé‡Œå°±æ˜¯runtimeé‡Œçš„Swizzing Methodæå®šï¼Œè¿™ä¸ªiOS å¼€å‘åº”è¯¥éƒ½ç”¨è¿‡ä¸å°‘ï¼ˆå¸¸è§„æŠ€æœ¯ï¼‰&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å…·ä½“å®è·µ&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;new project - framework&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Library:Application%20Support:typora-user-images:image-20220829140442928.png&quot; alt=&quot;image-20220829140442928&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;æˆ‘ä»¬æ–°å»ºä¸€ä¸ªframeworkï¼Œç”¨æ¥åšåŠ¨æ€åº“&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;æŸ¥çœ‹class-dumpçš„ç±»ï¼Œhook æ‰¾åˆ°çš„ç±»åšåŠŸèƒ½&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Library:Application%20Support:typora-user-images:image-20220829140836995.png&quot; alt=&quot;image-20220829140836995&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;cd åˆ° /Applications/Typora.app/Contents/MacOS/&lt;/p&gt;

        &lt;p&gt;ä½¿ç”¨class-dump -H /Applications/Typora.app/Contents/MacOS/Typora -o /Users/haoyh02/Desktop/typora.h è¾“å‡ºå¤´æ–‡ä»¶è§£æåˆ°æ¡Œé¢ç›®æ ‡ç›®å½•ï¼Œå¦‚ä¸‹&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Library:Application%20Support:typora-user-images:image-20220829141211348.png&quot; alt=&quot;image-20220829141211348&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;okï¼Œæ¥ä¸‹æ¥æˆ‘å°±éœ€è¦åˆ†æå¤´æ–‡ä»¶ï¼Œæ‰¾å‡ºè‡ªå·±éœ€è¦hookçš„ç±»ï¼Œä»¥åŠæ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ªè¿‡ç¨‹æ‰æ˜¯æœ€æ¼«é•¿çš„ï¼Œè€Œä¸”æ˜¯ä¸æ–­çš„å°è¯•å‡ºæ¥çš„ã€‚å…·ä½“çš„åˆ†ææˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œå°±æ˜¯çœ‹ä»£ç å‘—ã€‚&lt;/p&gt;

        &lt;p&gt;æœ€ç»ˆæˆ‘ä»¬æ‰¾åˆ°äº†LibraryCommands ç±»ï¼Œä»–å¤§æ¦‚å°±æ˜¯ä¸€äº›æ–‡ä»¶å‘½ä»¤å¤„ç†ï¼Œæ¯”å¦‚æ–°å»ºæ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬hookçš„æ˜¯è¿™ä¸ªç±»ï¼Œä½†æ˜¯å…·ä½“æ–‡ä»¶å¤„ç†åˆ™æ˜¯Documentè¿™ä¸ªç±»ï¼Œé›†æˆäºNSDocumentã€‚&lt;/p&gt;

        &lt;p&gt;å…·ä½“çœ‹ä»£ç &lt;/p&gt;

        &lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//  TyporaAutoRejectHook.m&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//  TyporaAutoReject&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//  Created by éƒç‰é¸¿ on 2022/8/26.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//&lt;/span&gt;
      
&lt;span class=&quot;cp&quot;&gt;#import &amp;lt;Foundation/Foundation.h&amp;gt;
#import &amp;lt;AppKit/AppKit.h&amp;gt;
#import &quot;TyporaAutoReject.h&quot;
#import &amp;lt;objc/runtime.h&amp;gt;
&lt;/span&gt;      
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ty_hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;originClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;originSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;originalMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_getInstanceMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;originClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;originSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzledMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_getInstanceMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;swizzClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;originalMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzledMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;method_exchangeImplementations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;originalMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;swizzledMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Document&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NSDocument&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LibraryCommands&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NSObject&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@property&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;retain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Document&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NSObject&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Typora&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hookThunder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ty_hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_getClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LibraryCommands&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;@selector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;@selector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hook_newDocument&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;hook_newDocument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hook_newDocument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
          
    &lt;span class=&quot;n&quot;&gt;dispatch_after&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dispatch_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DISPATCH_TIME_NOW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int64_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSEC_PER_SEC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dispatch_get_main_queue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;LibraryCommands&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;commans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LibraryCommands&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Document&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;commans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;injectString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;@&quot;---&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;title: &amp;lt;xxxx&amp;gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;tags: [iOS] [MAC] [Plugin]&amp;gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;key: xxx &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;# article_header:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;# type: cover &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;# image:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; # src: https://user-images.githubusercontent.com/8369671/80915045-153ff780-8d82-11ea-9acf-6ccbf2b05d9d.png &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;---&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;injectString&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forKeyPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
              
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;writeToURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileURL&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ofType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileType&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;performSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSSelectorFromString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;syncToClient&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;performSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSSelectorFromString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;syncToSelf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
      
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__attribute__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSObject&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hookThunder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;

        &lt;p&gt;å¾ˆç®€å•ï¼Œæ€è·¯å°±æ˜¯hookåˆ°æ–°å»ºæ–‡ä»¶çš„æ–¹æ³•ï¼Œç„¶å2sä¹‹åï¼Œæ–‡ä»¶å†…æ’å…¥ä¸€æ®µé¢„ç½®æ–‡å­—ã€‚ç„¶ååŒæ­¥ç•Œé¢ã€‚&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;copy frameworkçš„äº§å‡ºï¼ˆç¼–è¯‘ï¼Œproducts/xxx.frameworkï¼‰åˆ°mac app ä¸‹çš„contents/MacOS&lt;/p&gt;

        &lt;p&gt;OKï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦buildå·¥ç¨‹ï¼Œå¾—åˆ°products/xxx.framework äº§ç‰©ã€‚xcode13 éšè—äº†productsï¼Œæˆ‘ä»¬åªéœ€è¦æ‰“å¼€pbxprojæ–‡ä»¶, ä¿®æ”¹mainGroup å’Œ productRefGroup ä¸€æ ·ï¼ˆæœ¬èº«ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦copyå†æ¬¡ä¿å­˜å°±å¥½äº†ï¼‰ï¼Œä¿å­˜å°±å¯ä»¥å‡ºç°ï¼Œä¹Ÿå¯ä»¥åˆ°DerivedDataé‡Œå»æ‰¾&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Library:Application%20Support:typora-user-images:image-20220829141839812.png&quot; alt=&quot;image-20220829141839812&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Library:Application%20Support:typora-user-images:image-20220829141945528.png&quot; alt=&quot;image-20220829141945528&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;ç„¶åcopy frameworkï¼Œåˆ°/Applications/Typora.app/Contents/ ä¸‹å³å¯ã€‚&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;æ‰§è¡Œinsert_dylib å‘½ä»¤&lt;/p&gt;

        &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; ./insert_dylib &lt;span class=&quot;nt&quot;&gt;--all-yes&lt;/span&gt; /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework/TyporaAutoReject Typora_backup Typora 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;

        &lt;p&gt;æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œå³å¯åµŒå…¥framework&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;é‡æ–°æ‰“å¼€åº”ç”¨&lt;/p&gt;

        &lt;p&gt;ä¸€å®šè¦é‡æ–°æ‰“å¼€åº”ç”¨ï¼Œå¦åˆ™ä¸ç”Ÿæ•ˆï¼ˆè¿™ä¸ªå…¶å®ä¸ç”¨æƒ³ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯ç¼–è¯‘å‹ç¨‹åºï¼‰&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;okï¼Œå½“ç„¶è¿™ä¸ªæ­¥éª¤å¾ˆéº»çƒ¦ï¼Œä¸ºäº†æˆ‘ä»¬èƒ½æ›´å¥½çš„é‡å¤éªŒè¯ï¼Œæˆ‘å†™äº†è„šæœ¬æ‰§è¡Œï¼Œè¿™äº›å‘½ä»¤&lt;/p&gt;

        &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      
&lt;span class=&quot;nb&quot;&gt;sudo rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework
&lt;span class=&quot;nb&quot;&gt;sudo mv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /Users/haoyh02/Library/Developer/Xcode/DerivedData/TyporaAutoReject-duhvxgpyrtuykugkepbmpmhciiyh/Build/Products/Debug/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; /Applications/Typora.app/Contents/MacOS/
./insert_dylib &lt;span class=&quot;nt&quot;&gt;--all-yes&lt;/span&gt; /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework/TyporaAutoReject Typora_backup Typora
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;â€‹&lt;/p&gt;

&lt;p&gt;â€‹	è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸ºTyporaåšçš„å°æ’ä»¶ï¼Œå®Œå…¨ç”Ÿæ•ˆäº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/HaoXianSen/HaoXianSen.github.io@master/screenshots/:Users:haoyh02:Desktop:result.png&quot; alt=&quot;result&quot; /&gt;&lt;/p&gt;

&lt;p&gt;â€‹&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/1e3fe0a8c048&quot;&gt;å®‰è£…class-dump&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://lemonlie.com/develop-plug-in-for-mac-app/&quot;&gt;å¦‚ä½•ä¸ºmacOSåº”ç”¨å¼€å‘æ’ä»¶&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/Tyilo/insert_dylib&quot;&gt;insert_dylib&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/nygard/class-dump&quot;&gt;class-dump&lt;/a&gt;&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="iOS" /><category term="MAC" /><category term="Plugin" /><summary type="html">å‰æ ä¸ºäº†æ›´å¥½çš„ç»´æŒæˆ‘çš„åšå®¢ç³»ç»Ÿï¼Œæƒ³ç€ä¹‹åçš„åšå®¢éƒ½å‘å¸ƒäºgithub.ioï¼Œ é‚£ä¹ˆå¦‚æœä½ æœ‰æ­å»ºè¿‡github.io é‚£ä¹ˆç›¸æ¯”éƒ½çŸ¥é“YAML, é€šè¿‡MARK down ä¸­æ’å…¥YAML FORMAT è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åšå®¢çš„æ ‡é¢˜ã€è¯„è®ºç­‰ç­‰ã€‚ã€‚é‚£ä¹ˆç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä¸æƒ³ç”¨Typoraæ¯æ¬¡å»ºç«‹ä¸€ä¸ªæ–°blogï¼Œéƒ½éœ€è¦ç¹ççš„æ’å…¥é‚£ä¸€å †YAMLï¼Œæ¯”å¦‚ title: positionã€anchorPointã€frameç†è§£ tags: iOS key: 107 # article_header: # type: cover # image: # src: https://user-images.githubusercontent.com/8369671/80915045-153ff780-8d82-11ea-9acf-6ccbf2b05d9d.png OKï¼Œæ‰€ä»¥é¦–å…ˆå‘¢æˆ‘æŠŠTyporaçš„æ‰€æœ‰æ–‡æ¡£çœ‹äº†ä¸€éï¼Œæ²¡æœ‰å…¥å£å¯é…ç½®ã€‚é‚£å’‹åŠï¼Ÿ æƒ³æ³•ä¹Ÿå°±ä»è¿™è¯ç”Ÿäº†ï¼Œæˆ‘èƒ½ä¸èƒ½å†™ä¸ªæ’ä»¶ï¼Œåœ¨Typora æ–°å»ºæ–‡ä»¶çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ’å…¥é¢„ç½®æ–‡å­—ï¼Œæ¥ä¸‹æ¥è®°å½•æ’ä»¶å¼€å‘è¿‡ç¨‹ï¼ŒæˆåŠŸä¸æˆåŠŸæœ€åè§åˆ†æ™“ï¼ ç€æ‰‹å¹²ï¼ˆæŸ¥èµ„æ–™ï¼‰ é€šè¿‡æŸ¥çœ‹èµ„æ–™ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸œè¥¿è¾…åŠ©ï¼Œ1.class-dump) 2. insert_dylib Â åŸºæœ¬åŸç†å°±æ˜¯ï¼š Mach-O äºŒè¿›åˆ¶æ–‡ä»¶Load Commandsä¸­çš„ LC_LOAD_DYLIB æ ‡å¤´å‘Šè¯‰ macOSåœ¨æ‰§è¡ŒæœŸé—´è¦åŠ è½½å“ªäº›åŠ¨æ€åº“ (dylib)ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡LC_LOAD_DYLIBå°±å¯ä»¥ã€‚è€Œinsert_dylibå·¥å…·å·²ç»ä¸ºæˆ‘ä»¬å®ç°äº†æ·»åŠ çš„åŠŸèƒ½ æ¥ä¸‹æ¥ä¸€ä¸ªä¸€ä¸ªè§£é‡Šï¼š class-dump é€šè¿‡åå­—æˆ‘ä»¬å¤§æ¦‚èƒ½çŒœåˆ°è¿™æ˜¯ä¸€ä¸ªä»€ä¹ˆå·¥å…·ï¼Œç±»ä¼¼ä¸€ä¸ªè§£é‡Šç±»çš„å·¥å…·ï¼Œç¡®å®ä»–ä¹Ÿæ˜¯å¹²è¿™ä¸ªçš„ï¼Œæ­£ç¡®å®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡class-dump [option] Mach-oæ–‡ä»¶ï¼Œè¾“å‡ºmac appçš„æš´éœ²ç±»çš„ç›¸å…³å±æ€§ï¼ŒOKï¼Œæˆ‘ä»¬ç”¨çš„å°±æ˜¯class-dump -H Mach-oæ–‡ä»¶ è¾“å‡ºå¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šè¿‡å¤´æ–‡ä»¶æŸ¥çœ‹mac appæºå¤´æ–‡ä»¶ï¼Œç„¶åæ‰¾åˆ°éœ€è¦hookçš„ç±»è¿›è¡Œhookï¼ˆå…·ä½“çš„å®‰è£…å¯ä»¥ç‚¹å‡»è¶…é“¾æ¥æŸ¥çœ‹ï¼‰ insert_dylib è¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ’å…¥ä¸€ä¸ªdylib åˆ°Mach-oäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦åšä¸€ä¸ªframeworkç„¶åé€šè¿‡è¿™ä¸ªåº“ï¼ŒåµŒå…¥åˆ°appçš„Mach-oäºŒè¿›åˆ¶æ–‡ä»¶é‡Œ okï¼Œå·¥å…·éƒ½å…¨ä¹äº†ï¼Œæ¥ä¸‹æ¥çš„æ—¶é—´ï¼Œå°±æ˜¯éœ€è¦æˆ‘ä»¬åšä¸€ä¸ªframeworkï¼Œè¿™ä¸ªframeworkæ˜¯ç”¨ä¸“é—¨hookçš„åŠ¨æ€åº“ã€‚ å½“ç„¶hookï¼ŒObjective-Cé‡Œå°±æ˜¯runtimeé‡Œçš„Swizzing Methodæå®šï¼Œè¿™ä¸ªiOS å¼€å‘åº”è¯¥éƒ½ç”¨è¿‡ä¸å°‘ï¼ˆå¸¸è§„æŠ€æœ¯ï¼‰ å…·ä½“å®è·µ new project - framework æˆ‘ä»¬æ–°å»ºä¸€ä¸ªframeworkï¼Œç”¨æ¥åšåŠ¨æ€åº“ æŸ¥çœ‹class-dumpçš„ç±»ï¼Œhook æ‰¾åˆ°çš„ç±»åšåŠŸèƒ½ cd åˆ° /Applications/Typora.app/Contents/MacOS/ ä½¿ç”¨class-dump -H /Applications/Typora.app/Contents/MacOS/Typora -o /Users/haoyh02/Desktop/typora.h è¾“å‡ºå¤´æ–‡ä»¶è§£æåˆ°æ¡Œé¢ç›®æ ‡ç›®å½•ï¼Œå¦‚ä¸‹ okï¼Œæ¥ä¸‹æ¥æˆ‘å°±éœ€è¦åˆ†æå¤´æ–‡ä»¶ï¼Œæ‰¾å‡ºè‡ªå·±éœ€è¦hookçš„ç±»ï¼Œä»¥åŠæ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ªè¿‡ç¨‹æ‰æ˜¯æœ€æ¼«é•¿çš„ï¼Œè€Œä¸”æ˜¯ä¸æ–­çš„å°è¯•å‡ºæ¥çš„ã€‚å…·ä½“çš„åˆ†ææˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œå°±æ˜¯çœ‹ä»£ç å‘—ã€‚ æœ€ç»ˆæˆ‘ä»¬æ‰¾åˆ°äº†LibraryCommands ç±»ï¼Œä»–å¤§æ¦‚å°±æ˜¯ä¸€äº›æ–‡ä»¶å‘½ä»¤å¤„ç†ï¼Œæ¯”å¦‚æ–°å»ºæ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬hookçš„æ˜¯è¿™ä¸ªç±»ï¼Œä½†æ˜¯å…·ä½“æ–‡ä»¶å¤„ç†åˆ™æ˜¯Documentè¿™ä¸ªç±»ï¼Œé›†æˆäºNSDocumentã€‚ å…·ä½“çœ‹ä»£ç  // // TyporaAutoRejectHook.m // TyporaAutoReject // // Created by éƒç‰é¸¿ on 2022/8/26. // #import &amp;lt;Foundation/Foundation.h&amp;gt; #import &amp;lt;AppKit/AppKit.h&amp;gt; #import &quot;TyporaAutoReject.h&quot; #import &amp;lt;objc/runtime.h&amp;gt; void ty_hook(Class originClass, SEL originSelector, Class swizzClass, SEL swizzSelector) { Method originalMethod = class_getInstanceMethod(originClass, originSelector); Method swizzledMethod = class_getInstanceMethod(swizzClass, swizzSelector); if(originalMethod &amp;amp;&amp;amp; swizzledMethod) { method_exchangeImplementations(originalMethod, swizzledMethod); } } @interface Document : NSDocument @end @interface LibraryCommands: NSObject @property(retain) Document *document; @end @implementation NSObject (Typora) + (void)hookThunder{ ty_hook(objc_getClass(&quot;LibraryCommands&quot;), @selector(createFile:), [self class], @selector(hook_newDocument:)); } - (void)hook_newDocument:(id)args { [self hook_newDocument:args]; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{ LibraryCommands *commans = (LibraryCommands *)self; Document *document = commans.document; NSString *injectString = @&quot;---\ntitle: &amp;lt;xxxx&amp;gt; \ntags: [iOS] [MAC] [Plugin]&amp;gt; \nkey: xxx \n# article_header:\n# type: cover \n# image:\n # src: https://user-images.githubusercontent.com/8369671/80915045-153ff780-8d82-11ea-9acf-6ccbf2b05d9d.png \n---&quot;; [document setValue:injectString forKeyPath:@&quot;content&quot;]; [document writeToURL:document.fileURL ofType:document.fileType error:nil]; [document performSelector:NSSelectorFromString(@&quot;syncToClient&quot;)]; [document performSelector:NSSelectorFromString(@&quot;syncToSelf&quot;)]; }); } @end static void __attribute__((constructor)) initialize(void) { [NSObject hookThunder]; } å¾ˆç®€å•ï¼Œæ€è·¯å°±æ˜¯hookåˆ°æ–°å»ºæ–‡ä»¶çš„æ–¹æ³•ï¼Œç„¶å2sä¹‹åï¼Œæ–‡ä»¶å†…æ’å…¥ä¸€æ®µé¢„ç½®æ–‡å­—ã€‚ç„¶ååŒæ­¥ç•Œé¢ã€‚ copy frameworkçš„äº§å‡ºï¼ˆç¼–è¯‘ï¼Œproducts/xxx.frameworkï¼‰åˆ°mac app ä¸‹çš„contents/MacOS OKï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦buildå·¥ç¨‹ï¼Œå¾—åˆ°products/xxx.framework äº§ç‰©ã€‚xcode13 éšè—äº†productsï¼Œæˆ‘ä»¬åªéœ€è¦æ‰“å¼€pbxprojæ–‡ä»¶, ä¿®æ”¹mainGroup å’Œ productRefGroup ä¸€æ ·ï¼ˆæœ¬èº«ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦copyå†æ¬¡ä¿å­˜å°±å¥½äº†ï¼‰ï¼Œä¿å­˜å°±å¯ä»¥å‡ºç°ï¼Œä¹Ÿå¯ä»¥åˆ°DerivedDataé‡Œå»æ‰¾ ç„¶åcopy frameworkï¼Œåˆ°/Applications/Typora.app/Contents/ ä¸‹å³å¯ã€‚ æ‰§è¡Œinsert_dylib å‘½ä»¤ ./insert_dylib --all-yes /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework/TyporaAutoReject Typora_backup Typora æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œå³å¯åµŒå…¥framework é‡æ–°æ‰“å¼€åº”ç”¨ ä¸€å®šè¦é‡æ–°æ‰“å¼€åº”ç”¨ï¼Œå¦åˆ™ä¸ç”Ÿæ•ˆï¼ˆè¿™ä¸ªå…¶å®ä¸ç”¨æƒ³ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯ç¼–è¯‘å‹ç¨‹åºï¼‰ okï¼Œå½“ç„¶è¿™ä¸ªæ­¥éª¤å¾ˆéº»çƒ¦ï¼Œä¸ºäº†æˆ‘ä»¬èƒ½æ›´å¥½çš„é‡å¤éªŒè¯ï¼Œæˆ‘å†™äº†è„šæœ¬æ‰§è¡Œï¼Œè¿™äº›å‘½ä»¤ sudo rm -d -r /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework sudo mv -f /Users/haoyh02/Library/Developer/Xcode/DerivedData/TyporaAutoReject-duhvxgpyrtuykugkepbmpmhciiyh/Build/Products/Debug/* /Applications/Typora.app/Contents/MacOS/ ./insert_dylib --all-yes /Applications/Typora.app/Contents/MacOS/TyporaAutoReject.framework/TyporaAutoReject Typora_backup Typora â€‹ â€‹ è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸ºTyporaåšçš„å°æ’ä»¶ï¼Œå®Œå…¨ç”Ÿæ•ˆäº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼š â€‹ å‚è€ƒ å®‰è£…class-dump å¦‚ä½•ä¸ºmacOSåº”ç”¨å¼€å‘æ’ä»¶ insert_dylib class-dump</summary></entry><entry><title type="html">positionã€anchorPointã€frameç†è§£</title><link href="http://localhost:4000/2022/05/01/00_position_anchorPoint_frame.html" rel="alternate" type="text/html" title="positionã€anchorPointã€frameç†è§£" /><published>2022-05-01T00:00:00+08:00</published><updated>2022-05-01T00:00:00+08:00</updated><id>http://localhost:4000/2022/05/01/00_position_anchorPoint_frame</id><content type="html" xml:base="http://localhost:4000/2022/05/01/00_position_anchorPoint_frame.html">&lt;h4 id=&quot;å‰æƒ…æè¦&quot;&gt;å‰æƒ…æè¦&lt;/h4&gt;

&lt;p&gt;â€‹	     æœ€è¿‘åœ¨å­¦2dæ¸¸æˆæ¡†æ¶SpriteKitï¼Œå…¶ä¸­ä½¿ç”¨å¤§é‡çš„AnchorPoint/position æ¥ç¡®å®šNodeçš„ä½ç½®ï¼Œé‚£æœ¬èº«æ¥è¯´å¯¹äºanchorPointã€positionçš„æ¦‚å¿µã€ä»¥åŠä»–ä»¬ä¹‹é—´äº’ç›¸èµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Œå¯¹äºviewåˆä¼šé€ æˆä»€ä¹ˆå½±å“ï¼Œéƒ½æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„ï¼Œæ‰€ä»¥å†å®šä½Nodeå¸ƒå±€æ¥è¯´ï¼Œå°±æ˜¯ä¸€é¡¿è¿·ç³Šï¼Œæ­£å¥½å·¥ä½œè¿™ä¹ˆå¤šå¹´äº†ï¼Œè¿˜æ˜¯å¯¹äºè¿™äº›åŸºç¡€çš„è¿˜æ˜¯æ¨¡ç³Šï¼Œæ˜¯æœ‰ç‚¹è¯´ä¸è¿‡å»äº†ï¼Œæ‰€ä»¥æˆ‘å†³å®šè®¤çœŸåˆ†æä¸€ä¸‹Frameã€boundsã€positionã€anchorPointä¹‹é—´çš„å…³ç³»ï¼Œä»¥åŠä»–ä»¬å¯¹æ˜¾ç¤ºçš„å½±å“ã€‚&lt;/p&gt;

&lt;h4 id=&quot;è¿›å…¥æ­£æ–‡&quot;&gt;è¿›å…¥æ­£æ–‡&lt;/h4&gt;

&lt;p&gt;frameï¼š è¡¨ç¤ºäº†ä¸€ä¸ªview åœ¨å…¶superViewåæ ‡ç³»å…·ä½“ä½ç½®ï¼Œé‚£ä¹ˆä»–çš„å‚ç…§ç‰©æ˜¯å…¶çˆ¶view&lt;/p&gt;

&lt;p&gt;boundsï¼šè¡¨ç¤ºäº†ä¸€ä¸ªviewçš„æœ¬åœ°åæ ‡ç³»ä¸‹ï¼Œå‚ç…§ç‰©æ˜¯è‡ªèº«ï¼Œä»–çš„ä¿®æ”¹ä¸ä¼šæ”¹å˜frameï¼Œä½†æ˜¯ä¼šæ”¹å˜å…¶çš„å­viewçš„ä½ç½®ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿç¨åæˆ‘ä¼šç”»å›¾è§£é‡Š&lt;/p&gt;

&lt;p&gt;positionï¼šè¿™æ˜¯CALayerçš„å±æ€§ï¼Œæˆ‘çš„ç†è§£æ˜¯ä»–çš„ç‰©ç†ä¸­å¿ƒç‚¹ï¼Œä»–å’ŒanchorPointæœ‰ç€å¯†åˆ‡çš„å…³ç³»&lt;/p&gt;

&lt;p&gt;anchorPointï¼šä¹Ÿæ˜¯CALayerçš„å±æ€§ï¼Œç¿»è¯‘è¿‡æ¥å«åšé”šç‚¹ï¼Œä¹Ÿå°±æ˜¯å›ºå®šçš„ç‚¹ï¼Œä»–çš„åæ ‡ç³»æ˜¯ä»¥unit åæ ‡ç³»å®šä¹‰ï¼Œå·¦ä¸Šè§’ä¸º(0,0)ï¼Œ å³ä¸Šè§’(1, 0), å·¦ä¸‹è§’(0,1), å³ä¸‹è§’(1,1)&lt;/p&gt;

&lt;p&gt;å¥½ï¼æ¦‚å¿µéƒ½è¯´å®Œäº†ï¼Œä½†æ˜¯è¿™ä¸ªæ¦‚å¿µåªèƒ½è®©æˆ‘ä»¬ç†è§£ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸èƒ½çœŸå®çš„ç†è§£åˆ°ä»–ä»¬çš„å…·ä½“ä½œç”¨ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨å›¾çš„æ¦‚å¿µå»ä¸€ç‚¹ç‚¹ç†è§£&lt;/p&gt;

&lt;h4 id=&quot;æ·±å…¥&quot;&gt;æ·±å…¥&lt;/h4&gt;

&lt;p&gt;frame æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œæˆ‘ä»¬ä»¥å‰frameå¸ƒå±€ï¼Œç”¨çš„å†ç†Ÿç»ƒä¸è¿‡äº†ï¼Œä»–å°±æ˜¯viewåœ¨å…¶çˆ¶viewä¸­ä½ç½®&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†frameï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥å½±å“åˆ°ä»–çš„ä½ç½®å’Œå¤§å°ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºbounds æ¥è¯´ï¼Œä»–æ˜¯è‡ªèº«çš„åæ ‡ç³»ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†ä»–çš„originï¼Œé‚£ä¹ˆä»–çš„å­viewå°±ä¼šä»¥è¿™ä¸ªç‚¹ä¸ºä¸ºåŸç‚¹æ¥è®¡ç®—ä½ç½®ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªçº¢è‰²çš„viewï¼Œæˆ‘ä»¬è®¾ç½®äº†ä»–çš„bounds.originä¸ºï¼ˆ-20ï¼Œ 20ï¼‰ï¼Œé‚£ä¹ˆä»–å°±ä¼šæ”¹å˜è‡ªå·±çš„æœ¬åœ°åæ ‡ç³»çš„åŸç‚¹ä¸º-20ï¼Œ-20ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªè“è‰²çš„å­viewframeçš„originä¸ºï¼ˆ0ï¼Œ0ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå­viewå°±ä¼šå‘å³ä¸‹åç§»20ï¼Œå› ä¸ºå½“å‰å·¦ä¸Šè§’çš„åŸç‚¹ä¸º-20ï¼Œ-20ï¼Œï¼ˆ0ï¼Œ0ï¼‰ç‚¹çš„ä½ç½®åœ¨å³ä¸‹è§’åç§»20çš„ä½ç½®ï¼Œæ‰€ä»¥æœ€åçœ‹åˆ°è“è‰²viewå¹¶ä¸æ˜¯é ç€å·¦ä¸Šè§’ã€‚æ–‡å­—æè¿°æœ‰ç‚¹ã€‚ã€‚ã€‚è´¹åŠ²ï¼Œè¿˜æ˜¯æƒ³åŠæ³•ç”»å›¾å§ã€‚ã€‚ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/image-20210929181748669.png&quot; alt=&quot;image-20210929181748669&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥bounds.originçš„ä¿®æ”¹ä¼šå¯¼è‡´å­viewçš„ä½ç½®æ”¹å˜ï¼Œé‚£ä¹ˆä¿®æ”¹boundsçš„sizeå‘¢ï¼Ÿ æ”¹å˜è‡ªå·±boundsçš„sizeä¼šä½¿è‡ªèº«çš„å¤§å°å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå½±å“frameï¼Œä¸ä¼šå½±å“çˆ¶view&lt;/p&gt;

&lt;p&gt;é‚£ä¹ˆå¯¹äºposition å’ŒanchorPointï¼Œæˆ‘å—ä¸€ç‰‡ä»–äººçš„æ–‡ç« å½±å“ï¼Œæœ‰ä¸€ä¸ªå¾ˆæ°å½“çš„æ¯”å–»ï¼š&lt;/p&gt;

&lt;p&gt;ä¸€å¹…ç”»ï¼ŒanchorPointå°±ç›¸å½“äºåœ¨è¿™ä¸ªç”»çš„å››ä¸ªè§’æˆ–è€…ä¸­é—´æ²¾ä¸€å—èƒ¶ï¼ˆæˆ–è€…ä½ æœ‰é«˜æ¡£çš„ä»€ä¹ˆå›ºå®šçš„éƒ½è¡Œã€‚ã€‚ï¼‰ï¼Œè€Œpositionå°±ç›¸å½“äºè¿™å—èƒ¶è¦æ²¾åœ¨å“ªä¸ªä½ç½®ï¼Œè¿™ä¹ˆæ¥è¯´çš„è¯ä»–åº”è¯¥æ˜¯å’Œanchoré‡åˆçš„ï¼Œæ¯”å¦‚è¯´positionä¸ºå¢™å£çš„æŸä¸ªç‚¹ï¼ŒanchorPointä¸ºç”»çš„ä¸­é—´ï¼ˆ0.5ï¼Œ0.5ï¼‰ï¼Œé‚£ä¹ˆç”»å°±ä¼šæ²¾åˆ°positionçš„ä½ç½®ï¼Œæˆ‘ä»¬viewé»˜è®¤çš„positionå°±æ˜¯viewçš„ä¸­å¿ƒç‚¹ç›¸å¯¹äºçˆ¶viewçš„ç‚¹ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æ”¹å˜anchorçš„è¯å°±ç±»æ¯”åˆšæ‰å›¾ç‰‡çš„é—®é¢˜ï¼Œæ˜¯é‚£ä¸ªè§’æˆ–è€…ä¸­ç‚¹å›ºå®šåˆ°è¿™ä¸ªpositionç‚¹è€Œå·²ã€‚&lt;/p&gt;

&lt;p&gt;ä¹Ÿç”»ä¸ªå›¾å§ã€‚ã€‚ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/image-20210929183736725.png&quot; alt=&quot;image-20210929183736725&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åŸºæœ¬ä¸Šé€šè¿‡ä¸Šè¾¹çš„ä»‹ç»ï¼Œæˆ‘æƒ³ä½ å’Œæˆ‘éƒ½æŒæ¡è¿™å‡ ä¸ªå±æ€§çš„çœŸæ­£å«ä¹‰ã€‚&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="iOS" /><summary type="html">å‰æƒ…æè¦ â€‹ æœ€è¿‘åœ¨å­¦2dæ¸¸æˆæ¡†æ¶SpriteKitï¼Œå…¶ä¸­ä½¿ç”¨å¤§é‡çš„AnchorPoint/position æ¥ç¡®å®šNodeçš„ä½ç½®ï¼Œé‚£æœ¬èº«æ¥è¯´å¯¹äºanchorPointã€positionçš„æ¦‚å¿µã€ä»¥åŠä»–ä»¬ä¹‹é—´äº’ç›¸èµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Œå¯¹äºviewåˆä¼šé€ æˆä»€ä¹ˆå½±å“ï¼Œéƒ½æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„ï¼Œæ‰€ä»¥å†å®šä½Nodeå¸ƒå±€æ¥è¯´ï¼Œå°±æ˜¯ä¸€é¡¿è¿·ç³Šï¼Œæ­£å¥½å·¥ä½œè¿™ä¹ˆå¤šå¹´äº†ï¼Œè¿˜æ˜¯å¯¹äºè¿™äº›åŸºç¡€çš„è¿˜æ˜¯æ¨¡ç³Šï¼Œæ˜¯æœ‰ç‚¹è¯´ä¸è¿‡å»äº†ï¼Œæ‰€ä»¥æˆ‘å†³å®šè®¤çœŸåˆ†æä¸€ä¸‹Frameã€boundsã€positionã€anchorPointä¹‹é—´çš„å…³ç³»ï¼Œä»¥åŠä»–ä»¬å¯¹æ˜¾ç¤ºçš„å½±å“ã€‚ è¿›å…¥æ­£æ–‡ frameï¼š è¡¨ç¤ºäº†ä¸€ä¸ªview åœ¨å…¶superViewåæ ‡ç³»å…·ä½“ä½ç½®ï¼Œé‚£ä¹ˆä»–çš„å‚ç…§ç‰©æ˜¯å…¶çˆ¶view boundsï¼šè¡¨ç¤ºäº†ä¸€ä¸ªviewçš„æœ¬åœ°åæ ‡ç³»ä¸‹ï¼Œå‚ç…§ç‰©æ˜¯è‡ªèº«ï¼Œä»–çš„ä¿®æ”¹ä¸ä¼šæ”¹å˜frameï¼Œä½†æ˜¯ä¼šæ”¹å˜å…¶çš„å­viewçš„ä½ç½®ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿç¨åæˆ‘ä¼šç”»å›¾è§£é‡Š positionï¼šè¿™æ˜¯CALayerçš„å±æ€§ï¼Œæˆ‘çš„ç†è§£æ˜¯ä»–çš„ç‰©ç†ä¸­å¿ƒç‚¹ï¼Œä»–å’ŒanchorPointæœ‰ç€å¯†åˆ‡çš„å…³ç³» anchorPointï¼šä¹Ÿæ˜¯CALayerçš„å±æ€§ï¼Œç¿»è¯‘è¿‡æ¥å«åšé”šç‚¹ï¼Œä¹Ÿå°±æ˜¯å›ºå®šçš„ç‚¹ï¼Œä»–çš„åæ ‡ç³»æ˜¯ä»¥unit åæ ‡ç³»å®šä¹‰ï¼Œå·¦ä¸Šè§’ä¸º(0,0)ï¼Œ å³ä¸Šè§’(1, 0), å·¦ä¸‹è§’(0,1), å³ä¸‹è§’(1,1) å¥½ï¼æ¦‚å¿µéƒ½è¯´å®Œäº†ï¼Œä½†æ˜¯è¿™ä¸ªæ¦‚å¿µåªèƒ½è®©æˆ‘ä»¬ç†è§£ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸èƒ½çœŸå®çš„ç†è§£åˆ°ä»–ä»¬çš„å…·ä½“ä½œç”¨ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨å›¾çš„æ¦‚å¿µå»ä¸€ç‚¹ç‚¹ç†è§£ æ·±å…¥ frame æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œæˆ‘ä»¬ä»¥å‰frameå¸ƒå±€ï¼Œç”¨çš„å†ç†Ÿç»ƒä¸è¿‡äº†ï¼Œä»–å°±æ˜¯viewåœ¨å…¶çˆ¶viewä¸­ä½ç½® å¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†frameï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥å½±å“åˆ°ä»–çš„ä½ç½®å’Œå¤§å°ã€‚ å¯¹äºbounds æ¥è¯´ï¼Œä»–æ˜¯è‡ªèº«çš„åæ ‡ç³»ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†ä»–çš„originï¼Œé‚£ä¹ˆä»–çš„å­viewå°±ä¼šä»¥è¿™ä¸ªç‚¹ä¸ºä¸ºåŸç‚¹æ¥è®¡ç®—ä½ç½®ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªçº¢è‰²çš„viewï¼Œæˆ‘ä»¬è®¾ç½®äº†ä»–çš„bounds.originä¸ºï¼ˆ-20ï¼Œ 20ï¼‰ï¼Œé‚£ä¹ˆä»–å°±ä¼šæ”¹å˜è‡ªå·±çš„æœ¬åœ°åæ ‡ç³»çš„åŸç‚¹ä¸º-20ï¼Œ-20ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªè“è‰²çš„å­viewframeçš„originä¸ºï¼ˆ0ï¼Œ0ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå­viewå°±ä¼šå‘å³ä¸‹åç§»20ï¼Œå› ä¸ºå½“å‰å·¦ä¸Šè§’çš„åŸç‚¹ä¸º-20ï¼Œ-20ï¼Œï¼ˆ0ï¼Œ0ï¼‰ç‚¹çš„ä½ç½®åœ¨å³ä¸‹è§’åç§»20çš„ä½ç½®ï¼Œæ‰€ä»¥æœ€åçœ‹åˆ°è“è‰²viewå¹¶ä¸æ˜¯é ç€å·¦ä¸Šè§’ã€‚æ–‡å­—æè¿°æœ‰ç‚¹ã€‚ã€‚ã€‚è´¹åŠ²ï¼Œè¿˜æ˜¯æƒ³åŠæ³•ç”»å›¾å§ã€‚ã€‚ã€‚ å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥bounds.originçš„ä¿®æ”¹ä¼šå¯¼è‡´å­viewçš„ä½ç½®æ”¹å˜ï¼Œé‚£ä¹ˆä¿®æ”¹boundsçš„sizeå‘¢ï¼Ÿ æ”¹å˜è‡ªå·±boundsçš„sizeä¼šä½¿è‡ªèº«çš„å¤§å°å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå½±å“frameï¼Œä¸ä¼šå½±å“çˆ¶view é‚£ä¹ˆå¯¹äºposition å’ŒanchorPointï¼Œæˆ‘å—ä¸€ç‰‡ä»–äººçš„æ–‡ç« å½±å“ï¼Œæœ‰ä¸€ä¸ªå¾ˆæ°å½“çš„æ¯”å–»ï¼š ä¸€å¹…ç”»ï¼ŒanchorPointå°±ç›¸å½“äºåœ¨è¿™ä¸ªç”»çš„å››ä¸ªè§’æˆ–è€…ä¸­é—´æ²¾ä¸€å—èƒ¶ï¼ˆæˆ–è€…ä½ æœ‰é«˜æ¡£çš„ä»€ä¹ˆå›ºå®šçš„éƒ½è¡Œã€‚ã€‚ï¼‰ï¼Œè€Œpositionå°±ç›¸å½“äºè¿™å—èƒ¶è¦æ²¾åœ¨å“ªä¸ªä½ç½®ï¼Œè¿™ä¹ˆæ¥è¯´çš„è¯ä»–åº”è¯¥æ˜¯å’Œanchoré‡åˆçš„ï¼Œæ¯”å¦‚è¯´positionä¸ºå¢™å£çš„æŸä¸ªç‚¹ï¼ŒanchorPointä¸ºç”»çš„ä¸­é—´ï¼ˆ0.5ï¼Œ0.5ï¼‰ï¼Œé‚£ä¹ˆç”»å°±ä¼šæ²¾åˆ°positionçš„ä½ç½®ï¼Œæˆ‘ä»¬viewé»˜è®¤çš„positionå°±æ˜¯viewçš„ä¸­å¿ƒç‚¹ç›¸å¯¹äºçˆ¶viewçš„ç‚¹ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æ”¹å˜anchorçš„è¯å°±ç±»æ¯”åˆšæ‰å›¾ç‰‡çš„é—®é¢˜ï¼Œæ˜¯é‚£ä¸ªè§’æˆ–è€…ä¸­ç‚¹å›ºå®šåˆ°è¿™ä¸ªpositionç‚¹è€Œå·²ã€‚ ä¹Ÿç”»ä¸ªå›¾å§ã€‚ã€‚ã€‚ åŸºæœ¬ä¸Šé€šè¿‡ä¸Šè¾¹çš„ä»‹ç»ï¼Œæˆ‘æƒ³ä½ å’Œæˆ‘éƒ½æŒæ¡è¿™å‡ ä¸ªå±æ€§çš„çœŸæ­£å«ä¹‰ã€‚</summary></entry><entry><title type="html">è§£å†³åŸç”Ÿæ¨ªæ»‘scrollViewå’ŒFlutter çºµæ»‘CustomScrollçš„å†²çª</title><link href="http://localhost:4000/2020/06/08/01_flutter_and_ios_matter.html" rel="alternate" type="text/html" title="è§£å†³åŸç”Ÿæ¨ªæ»‘scrollViewå’ŒFlutter çºµæ»‘CustomScrollçš„å†²çª" /><published>2020-06-08T00:00:00+08:00</published><updated>2020-06-08T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/08/01_flutter_and_ios_matter</id><content type="html" xml:base="http://localhost:4000/2020/06/08/01_flutter_and_ios_matter.html">&lt;h4 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;æœ€è¿‘é¡¹ç›®ä¸­åœ¨æ¨ªå‘æ»‘åŠ¨çš„PageViewControllerï¼ˆWMPageControllerï¼‰é‡ŒåµŒå…¥äº†Flutter çš„ CustomScrollViewï¼ŒåŸæœ¬ä¼šè§‰å¾—ä¸€åˆ‡okï¼Œå´å‡ºç°äº†ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼šå®‰å“åµŒå…¥ä¹‹åæ»‘åŠ¨æµç¨‹ç¨³å®šï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼ŒiOS åµŒå…¥ä¹‹åå‡ºç°Flutter é¡µé¢æ»‘åŠ¨å¡é¡¿ã€ä¸æµç•…ï¼Œä½“ç°åœ¨è§¦å‘flutter åˆ—è¡¨æ»‘åŠ¨çš„åŒæ—¶ï¼Œä¼šè§¦å‘åŸç”Ÿæ¨ªæ»‘ï¼Œä¸”å¿…é¡»å‚ç›´æ»‘åŠ¨ï¼ˆæ— ä¸€ç‚¹å·¦å³çš„æ»‘åŠ¨åç§»ï¼‰æ‰ä¼šç¨³å®šè§¦å‘Flutter åˆ—è¡¨çš„æ»‘åŠ¨ï¼Œå¦åˆ™å®¹æ˜“è§¦å‘å·¦å³æ¨ªæ»‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹ æƒ¯äº†å•æ‰‹ç”¨æ‰‹æœºçš„äººï¼Œæ ¹æœ¬æ— æ³•é¡ºç•…æ»‘åŠ¨ã€‚å¦‚ä¸‹é¢çš„gifï¼ˆå…¶å®æˆ‘å·²ç»å¾ˆåŠªåŠ›çš„åœ¨ä¸Šä¸‹æ»‘äº†ï¼Œå¾ˆæ˜æ˜¾ä¸Šä¸‹æ»‘åŠ¨çš„è·ç¦»å¤§äºæ°´å¹³æ»‘åŠ¨çš„è·ç¦»ï¼Œç”¨æˆ·çš„ç”¨æ„ä¹Ÿåº”è¯¥æ˜¯è¦ä¸Šä¸‹æ»‘åŠ¨ï¼Œä½†æ˜¯å´è§¦å‘äº†æ¨ªæ»‘ï¼‰ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/1789706-053b62962bcf93b3.png?imageMogr2/auto-orient/strip&quot; alt=&quot;1&quot; style=&quot;zoom:80%;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;è§£å†³æ–¹å¼&quot;&gt;è§£å†³æ–¹å¼&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;é¦–å…ˆè§¦æ‘¸flutterçš„é¡µé¢ï¼ŒåŸç”Ÿçš„UIScrollViewçš„panGestureä¹Ÿä¼šæ”¶åˆ°è§¦æ‘¸äº‹ä»¶ï¼Œå¯¼è‡´UIScrollViewçš„æ‰‹åŠ¿ç”Ÿæ•ˆï¼Œå¼€å§‹æˆ‘æƒ³ç€å¦‚æœèƒ½å†UIScrollViewçš„æ‰‹åŠ¿ä»£ç†æ–¹æ³•ä¸­åŒºåˆ†å‡ºFlutter CustomScrollViewçš„æ‰‹åŠ¿ï¼Œç„¶åå†åšè°ƒæ•´ã€‚ä½†æ˜¯è¿™æ¡è·¯æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºFlutterçš„æ»‘åŠ¨æ‰‹åŠ¿å¹¶ä¸æ˜¯é‡‡ç”¨ç³»ç»Ÿæä¾›çš„æ‰‹åŠ¿ï¼Œåœ¨æ–­ç‚¹æ—¶å‘ç°ï¼Œè§¦å‘ä¹‹åï¼Œå¹¶æ²¡æœ‰ç›¸å…³flutter ä¸Šçš„ ç³»ç»Ÿæ‰‹åŠ¿ç±»ã€‚æ‰€ä»¥æˆ‘æ”¹å˜äº†æ€è·¯ç”¨ä»¥ä¸‹å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¦‚æœå½“å‰è§¦æ‘¸åœ¨FlutterViewä¸Šï¼Œæˆ‘ä»¬çš„å­ç±»UIScrollView æ‰‹åŠ¿å°±ä¸æ¥æ”¶touchäº‹ä»¶ï¼Œæ§åˆ¶å…¶æ‰‹åŠ¿ä¸ä¼šç”Ÿæ•ˆï¼›&lt;/li&gt;
  &lt;li&gt;ç»§æ‰¿FLBFlutterViewContainerçˆ¶ç±»ï¼Œé‡å†™touchesç›¸å…³æ–¹æ³•ï¼Œæ‰‹åŠ¨è°ƒæ•´UIScrollView çš„contentOffsetï¼ˆæ³¨æ„: æˆ‘ä»¬æ··åˆæ ˆä½¿ç”¨çš„æ˜¯é—²é±¼çš„FlutterBoostï¼Œ FLBFlutterViewContainerç»§æ‰¿è‡ªFlutterViewControllerï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¸Šä»£ç ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;è‡ªå®šä¹‰ç»§æ‰¿è‡ªUIScrollViewçš„å­ç±»ï¼Œå¹¶ä¸”å®ç°æ‰‹åŠ¿ä»£ç†æ–¹æ³•ï¼Œæ§åˆ¶Touchçš„ä¼ é€’ã€‚å¦‚æœtouchçš„Viewæ˜¯FlutterView æˆ‘ä»¬çš„ScrollViewå°±ä¸æ¥æ”¶è¿™ä¸ªtouchäº‹ä»¶ã€‚&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-objective-c&quot;&gt;@interface WMScrollView()
   
@end
   
@implementation WMScrollView
   
#pragma mark - &amp;lt;UIGestureRecognizerDelegate&amp;gt;
   
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    if ([NSStringFromClass(touch.view.class) isEqualToString:@&quot;FlutterView&quot;]) {
        return NO;
    }
    return YES;
}
   
@end
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è‡ªå®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ªFLBFlutterViewContainerçš„å­ç±»ï¼Œé‡å†™Touchesæ–¹æ³•ï¼Œåœ¨touchBeganæ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©è‡ªå®šçš„ScrollViewæ‰‹åŠ¿ä¸ç”Ÿæ•ˆï¼›åœ¨touchMovedçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹²é¢„è®¡ç®—è§¦æ‘¸æ–¹å‘çš„è¯†åˆ«ï¼Œå¦‚æœ&lt;del&gt;åœ¨çºµæ»‘&amp;lt;5 &amp;amp;&amp;amp; æ¨ªæ»‘å¤§äº2çš„æ—¶å€™æˆ‘ä»¬é»˜è®¤ç”¨æˆ·æƒ³è¦æ¨ªæ»‘&lt;/del&gt; æ¨ªæ»‘è·ç¦»å¤§äºçºµæ»‘çš„è·ç¦»æˆ‘ä»¬è®¤ä¸ºç”¨æˆ·æƒ³è¦æ¨ªæ»‘(åˆ¤æ–­æ¨ªæ»‘è·ç¦»å¤§äºçºµæ»‘è·ç¦»å¦‚ä¸‹ä»£ç )ï¼Œæ•…æ‰‹åŠ¨æ”¹å˜ScrollViewçš„contentOffsetï¼Œå¦åˆ™çš„è¯æ‰‹åŠ¿ç»§ç»­ä¸ç”Ÿæ•ˆï¼Œ flutterView ç”Ÿæ•ˆï¼›åœ¨touchEndå’ŒtouchCancelçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ¤æ–­å½“å‰çš„contentOffsetï¼Œå¦‚æœè·ç¦»å¤§äºå½“å‰é¡µè·ç¦»çš„1/3, è·³è½¬åˆ°ä¸‹ä¸€é¡µï¼Œå¦‚æœè·ç¦»å°äºä¸Šä¸€é¡µè·ç¦»çš„2/3, è·³è½¬åˆ°å‰ä¸€é¡µï¼›è´Ÿè´£è°ƒæ•´offsetå›åˆ°å½“å‰é¡µé¢çš„èµ·å§‹ä½ç½®ã€‚&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-objective-c&quot;&gt;@implementation DDScrollFlutterViewContainer
    
- (void)viewDidLoad {
    [super viewDidLoad];
 }
    
#pragma mark - UITouches
- (void)touchesBegan:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event {
    [super touchesBegan:touches withEvent:event];
    [self touchesBegan:touches];
}
    
- (void)touchesMoved:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event {
    [self touchMoveWithTouch:touches event:event];
}
    
- (void)touchesEnded:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event {
    [self touchEnd:touches event:event isCanceled:NO];
}
    
- (void)touchesCancelled:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event {
    [self touchEnd:touches event:event isCanceled:YES];
}
    
- (void)touchesBegan:(NSSet *)touches {
    UIScrollView *superView = (UIScrollView *)self.view.superview.superview;
    superView.panGestureRecognizer.enabled = NO;
    self.hasOffset = NO;
    self.lastLocation = [touches.anyObject locationInView:self.view];
}
    
- (void)touchMoveWithTouch:(NSSet *)touches event:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint previoursLocation = self.lastLocation;
    CGPoint location = [touch locationInView:self.view];
    CGFloat deltax = fabs(location.x - previoursLocation.x);
    CGFloat deltay = fabs(location.y - previoursLocation.y);
    UIScrollView *superView = (UIScrollView *)self.view.superview.superview;
    if (deltax &amp;gt; deltay) {
        CGPoint offset = superView.contentOffset;
        [superView.delegate scrollViewWillBeginDragging:superView];
        CGPoint previours = [touch previousLocationInView:self.view];
        [superView setContentOffset:CGPointMake(offset.x - (location.x - previours.x), offset.y)];
        self.hasOffset = YES;
    } else {
        if (!self.hasOffset) {
            [super touchesMoved:touches withEvent:event];
        }
    }
}
    
- (void)touchEnd:(NSSet *)touches event:(UIEvent *)event isCanceled:(BOOL)isCanceled {
    UIScrollView *superView = (UIScrollView *)self.view.superview.superview;
    if (self.hasOffset) {
        CGPoint offset = superView.contentOffset;
        CGFloat offsetX = offset.x;
        if (offsetX &amp;gt; (1 * self.view.width+ self.view.width * 1 / 3)) {
            [superView setContentOffset:CGPointMake(2*self.view.width, offset.y) animated:YES];
        } else if (offsetX &amp;lt;=  self.view.width * 2 / 3) {
            [superView setContentOffset:CGPointMake(0, offset.y) animated:YES];
        } else {
            [superView setContentOffset:CGPointMake(self.view.width, offset.y) animated:YES];
        }
        [superView.delegate scrollViewDidEndDecelerating:superView];
        [self.nextResponder touchesEnded:touches withEvent:event];
    }
isCanceled ? [super touchesCancelled:touches withEvent:event] : [super touchesEnded:touches withEvent:event];
    superView.panGestureRecognizer.enabled = YES;
}
    
    
@end
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¤„ç†ä¹‹åçš„æ•ˆæœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/1789706-ad3c670a61f4c292.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;2&quot; style=&quot;zoom:40%;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯å›°æ‰°äº†è®¸ä¹…ï¼Œå› ä¸ºåœ¨å®‰å“ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè€Œåœ¨iphoneä¸Šè¡¨ç°æå…¶çš„ä¸èˆ’é€‚ï¼Œæ‰€ä»¥æœ€åˆè€ƒè™‘åˆ°è¿™ä¹Ÿæ˜¯Flutterå›¢é˜Ÿå¯¹äºCustomScrollView åŸç”Ÿæ¸²æŸ“é€‚é…çš„é—®é¢˜ï¼Œä½†æ˜¯æ—¢ç„¶ä»–ä»¬é€‚é…ä¸å¥½ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨çš„å»é€‚é…ã€‚ä½†æ˜¯ä»è§£å†³åŠæ³•çš„æ¢ç´¢ä¸­ï¼Œæˆ‘ä»¬å‘ç°Flutterçš„æ‰‹åŠ¿å¹¶ä¸æ˜¯é€šè¿‡iOSåŸç”Ÿçš„æ‰‹åŠ¿å®ç°çš„ï¼Œè€Œæ˜¯è‡ªå·±çš„ä¸€å¥—æ‰‹åŠ¿è¯†åˆ«ã€‚è€Œä¸”FlutterViewController çš„touchesäº‹ä»¶æ˜¯è¢«é‡å†™äº†ï¼Œå› ä¸ºå‡å¦‚ä½ é‡å†™äº†touchesçš„æ–¹æ³•ï¼Œæ²¡æœ‰è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šå‘ç°flutter ä¸èƒ½æ»‘åŠ¨ï¼Œæ‰€ä»¥åˆ¤æ–­flutterçš„æ»‘åŠ¨äº‹ä»¶Touchesæ–¹æ³•ä¹Ÿæ˜¯å‚ä¸å…¶ä¸­ï¼Œæ‰€ä»¥è®°å¾—è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚è€Œæˆ‘ä»¬é‡å†™äº†Touchesçš„äº‹ä»¶ä¹Ÿæ˜¯åŒºåˆ†äº†ä¸€ä¸‹ç”¨æˆ·æ„å›¾è¦æ»‘åŠ¨çš„æ–¹å‘ï¼Œç›¸å½“äºåšäº†ä¸ªæ‰‹åŠ¿çš„æ–¹å‘çš„è¯†åˆ«ã€‚&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="Flutter" /><category term="iOS" /><summary type="html">å‰è¨€ æœ€è¿‘é¡¹ç›®ä¸­åœ¨æ¨ªå‘æ»‘åŠ¨çš„PageViewControllerï¼ˆWMPageControllerï¼‰é‡ŒåµŒå…¥äº†Flutter çš„ CustomScrollViewï¼ŒåŸæœ¬ä¼šè§‰å¾—ä¸€åˆ‡okï¼Œå´å‡ºç°äº†ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼šå®‰å“åµŒå…¥ä¹‹åæ»‘åŠ¨æµç¨‹ç¨³å®šï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼ŒiOS åµŒå…¥ä¹‹åå‡ºç°Flutter é¡µé¢æ»‘åŠ¨å¡é¡¿ã€ä¸æµç•…ï¼Œä½“ç°åœ¨è§¦å‘flutter åˆ—è¡¨æ»‘åŠ¨çš„åŒæ—¶ï¼Œä¼šè§¦å‘åŸç”Ÿæ¨ªæ»‘ï¼Œä¸”å¿…é¡»å‚ç›´æ»‘åŠ¨ï¼ˆæ— ä¸€ç‚¹å·¦å³çš„æ»‘åŠ¨åç§»ï¼‰æ‰ä¼šç¨³å®šè§¦å‘Flutter åˆ—è¡¨çš„æ»‘åŠ¨ï¼Œå¦åˆ™å®¹æ˜“è§¦å‘å·¦å³æ¨ªæ»‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹ æƒ¯äº†å•æ‰‹ç”¨æ‰‹æœºçš„äººï¼Œæ ¹æœ¬æ— æ³•é¡ºç•…æ»‘åŠ¨ã€‚å¦‚ä¸‹é¢çš„gifï¼ˆå…¶å®æˆ‘å·²ç»å¾ˆåŠªåŠ›çš„åœ¨ä¸Šä¸‹æ»‘äº†ï¼Œå¾ˆæ˜æ˜¾ä¸Šä¸‹æ»‘åŠ¨çš„è·ç¦»å¤§äºæ°´å¹³æ»‘åŠ¨çš„è·ç¦»ï¼Œç”¨æˆ·çš„ç”¨æ„ä¹Ÿåº”è¯¥æ˜¯è¦ä¸Šä¸‹æ»‘åŠ¨ï¼Œä½†æ˜¯å´è§¦å‘äº†æ¨ªæ»‘ï¼‰ï¼š è§£å†³æ–¹å¼ é¦–å…ˆè§¦æ‘¸flutterçš„é¡µé¢ï¼ŒåŸç”Ÿçš„UIScrollViewçš„panGestureä¹Ÿä¼šæ”¶åˆ°è§¦æ‘¸äº‹ä»¶ï¼Œå¯¼è‡´UIScrollViewçš„æ‰‹åŠ¿ç”Ÿæ•ˆï¼Œå¼€å§‹æˆ‘æƒ³ç€å¦‚æœèƒ½å†UIScrollViewçš„æ‰‹åŠ¿ä»£ç†æ–¹æ³•ä¸­åŒºåˆ†å‡ºFlutter CustomScrollViewçš„æ‰‹åŠ¿ï¼Œç„¶åå†åšè°ƒæ•´ã€‚ä½†æ˜¯è¿™æ¡è·¯æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºFlutterçš„æ»‘åŠ¨æ‰‹åŠ¿å¹¶ä¸æ˜¯é‡‡ç”¨ç³»ç»Ÿæä¾›çš„æ‰‹åŠ¿ï¼Œåœ¨æ–­ç‚¹æ—¶å‘ç°ï¼Œè§¦å‘ä¹‹åï¼Œå¹¶æ²¡æœ‰ç›¸å…³flutter ä¸Šçš„ ç³»ç»Ÿæ‰‹åŠ¿ç±»ã€‚æ‰€ä»¥æˆ‘æ”¹å˜äº†æ€è·¯ç”¨ä»¥ä¸‹å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼š å¦‚æœå½“å‰è§¦æ‘¸åœ¨FlutterViewä¸Šï¼Œæˆ‘ä»¬çš„å­ç±»UIScrollView æ‰‹åŠ¿å°±ä¸æ¥æ”¶touchäº‹ä»¶ï¼Œæ§åˆ¶å…¶æ‰‹åŠ¿ä¸ä¼šç”Ÿæ•ˆï¼› ç»§æ‰¿FLBFlutterViewContainerçˆ¶ç±»ï¼Œé‡å†™touchesç›¸å…³æ–¹æ³•ï¼Œæ‰‹åŠ¨è°ƒæ•´UIScrollView çš„contentOffsetï¼ˆæ³¨æ„: æˆ‘ä»¬æ··åˆæ ˆä½¿ç”¨çš„æ˜¯é—²é±¼çš„FlutterBoostï¼Œ FLBFlutterViewContainerç»§æ‰¿è‡ªFlutterViewControllerï¼‰ ä¸Šä»£ç ï¼š è‡ªå®šä¹‰ç»§æ‰¿è‡ªUIScrollViewçš„å­ç±»ï¼Œå¹¶ä¸”å®ç°æ‰‹åŠ¿ä»£ç†æ–¹æ³•ï¼Œæ§åˆ¶Touchçš„ä¼ é€’ã€‚å¦‚æœtouchçš„Viewæ˜¯FlutterView æˆ‘ä»¬çš„ScrollViewå°±ä¸æ¥æ”¶è¿™ä¸ªtouchäº‹ä»¶ã€‚ @interface WMScrollView() @end @implementation WMScrollView #pragma mark - &amp;lt;UIGestureRecognizerDelegate&amp;gt; - (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch { if ([NSStringFromClass(touch.view.class) isEqualToString:@&quot;FlutterView&quot;]) { return NO; } return YES; } @end è‡ªå®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ªFLBFlutterViewContainerçš„å­ç±»ï¼Œé‡å†™Touchesæ–¹æ³•ï¼Œåœ¨touchBeganæ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©è‡ªå®šçš„ScrollViewæ‰‹åŠ¿ä¸ç”Ÿæ•ˆï¼›åœ¨touchMovedçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹²é¢„è®¡ç®—è§¦æ‘¸æ–¹å‘çš„è¯†åˆ«ï¼Œå¦‚æœåœ¨çºµæ»‘&amp;lt;5 &amp;amp;&amp;amp; æ¨ªæ»‘å¤§äº2çš„æ—¶å€™æˆ‘ä»¬é»˜è®¤ç”¨æˆ·æƒ³è¦æ¨ªæ»‘ æ¨ªæ»‘è·ç¦»å¤§äºçºµæ»‘çš„è·ç¦»æˆ‘ä»¬è®¤ä¸ºç”¨æˆ·æƒ³è¦æ¨ªæ»‘(åˆ¤æ–­æ¨ªæ»‘è·ç¦»å¤§äºçºµæ»‘è·ç¦»å¦‚ä¸‹ä»£ç )ï¼Œæ•…æ‰‹åŠ¨æ”¹å˜ScrollViewçš„contentOffsetï¼Œå¦åˆ™çš„è¯æ‰‹åŠ¿ç»§ç»­ä¸ç”Ÿæ•ˆï¼Œ flutterView ç”Ÿæ•ˆï¼›åœ¨touchEndå’ŒtouchCancelçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ¤æ–­å½“å‰çš„contentOffsetï¼Œå¦‚æœè·ç¦»å¤§äºå½“å‰é¡µè·ç¦»çš„1/3, è·³è½¬åˆ°ä¸‹ä¸€é¡µï¼Œå¦‚æœè·ç¦»å°äºä¸Šä¸€é¡µè·ç¦»çš„2/3, è·³è½¬åˆ°å‰ä¸€é¡µï¼›è´Ÿè´£è°ƒæ•´offsetå›åˆ°å½“å‰é¡µé¢çš„èµ·å§‹ä½ç½®ã€‚ @implementation DDScrollFlutterViewContainer - (void)viewDidLoad { [super viewDidLoad]; } #pragma mark - UITouches - (void)touchesBegan:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event { [super touchesBegan:touches withEvent:event]; [self touchesBegan:touches]; } - (void)touchesMoved:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event { [self touchMoveWithTouch:touches event:event]; } - (void)touchesEnded:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event { [self touchEnd:touches event:event isCanceled:NO]; } - (void)touchesCancelled:(NSSet&amp;lt;UITouch *&amp;gt; *)touches withEvent:(UIEvent *)event { [self touchEnd:touches event:event isCanceled:YES]; } - (void)touchesBegan:(NSSet *)touches { UIScrollView *superView = (UIScrollView *)self.view.superview.superview; superView.panGestureRecognizer.enabled = NO; self.hasOffset = NO; self.lastLocation = [touches.anyObject locationInView:self.view]; } - (void)touchMoveWithTouch:(NSSet *)touches event:(UIEvent *)event{ UITouch *touch = [touches anyObject]; CGPoint previoursLocation = self.lastLocation; CGPoint location = [touch locationInView:self.view]; CGFloat deltax = fabs(location.x - previoursLocation.x); CGFloat deltay = fabs(location.y - previoursLocation.y); UIScrollView *superView = (UIScrollView *)self.view.superview.superview; if (deltax &amp;gt; deltay) { CGPoint offset = superView.contentOffset; [superView.delegate scrollViewWillBeginDragging:superView]; CGPoint previours = [touch previousLocationInView:self.view]; [superView setContentOffset:CGPointMake(offset.x - (location.x - previours.x), offset.y)]; self.hasOffset = YES; } else { if (!self.hasOffset) { [super touchesMoved:touches withEvent:event]; } } } - (void)touchEnd:(NSSet *)touches event:(UIEvent *)event isCanceled:(BOOL)isCanceled { UIScrollView *superView = (UIScrollView *)self.view.superview.superview; if (self.hasOffset) { CGPoint offset = superView.contentOffset; CGFloat offsetX = offset.x; if (offsetX &amp;gt; (1 * self.view.width+ self.view.width * 1 / 3)) { [superView setContentOffset:CGPointMake(2*self.view.width, offset.y) animated:YES]; } else if (offsetX &amp;lt;= self.view.width * 2 / 3) { [superView setContentOffset:CGPointMake(0, offset.y) animated:YES]; } else { [superView setContentOffset:CGPointMake(self.view.width, offset.y) animated:YES]; } [superView.delegate scrollViewDidEndDecelerating:superView]; [self.nextResponder touchesEnded:touches withEvent:event]; } isCanceled ? [super touchesCancelled:touches withEvent:event] : [super touchesEnded:touches withEvent:event]; superView.panGestureRecognizer.enabled = YES; } @end å¤„ç†ä¹‹åçš„æ•ˆæœï¼š æ€»ç»“ è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯å›°æ‰°äº†è®¸ä¹…ï¼Œå› ä¸ºåœ¨å®‰å“ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè€Œåœ¨iphoneä¸Šè¡¨ç°æå…¶çš„ä¸èˆ’é€‚ï¼Œæ‰€ä»¥æœ€åˆè€ƒè™‘åˆ°è¿™ä¹Ÿæ˜¯Flutterå›¢é˜Ÿå¯¹äºCustomScrollView åŸç”Ÿæ¸²æŸ“é€‚é…çš„é—®é¢˜ï¼Œä½†æ˜¯æ—¢ç„¶ä»–ä»¬é€‚é…ä¸å¥½ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨çš„å»é€‚é…ã€‚ä½†æ˜¯ä»è§£å†³åŠæ³•çš„æ¢ç´¢ä¸­ï¼Œæˆ‘ä»¬å‘ç°Flutterçš„æ‰‹åŠ¿å¹¶ä¸æ˜¯é€šè¿‡iOSåŸç”Ÿçš„æ‰‹åŠ¿å®ç°çš„ï¼Œè€Œæ˜¯è‡ªå·±çš„ä¸€å¥—æ‰‹åŠ¿è¯†åˆ«ã€‚è€Œä¸”FlutterViewController çš„touchesäº‹ä»¶æ˜¯è¢«é‡å†™äº†ï¼Œå› ä¸ºå‡å¦‚ä½ é‡å†™äº†touchesçš„æ–¹æ³•ï¼Œæ²¡æœ‰è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šå‘ç°flutter ä¸èƒ½æ»‘åŠ¨ï¼Œæ‰€ä»¥åˆ¤æ–­flutterçš„æ»‘åŠ¨äº‹ä»¶Touchesæ–¹æ³•ä¹Ÿæ˜¯å‚ä¸å…¶ä¸­ï¼Œæ‰€ä»¥è®°å¾—è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚è€Œæˆ‘ä»¬é‡å†™äº†Touchesçš„äº‹ä»¶ä¹Ÿæ˜¯åŒºåˆ†äº†ä¸€ä¸‹ç”¨æˆ·æ„å›¾è¦æ»‘åŠ¨çš„æ–¹å‘ï¼Œç›¸å½“äºåšäº†ä¸ªæ‰‹åŠ¿çš„æ–¹å‘çš„è¯†åˆ«ã€‚</summary></entry><entry><title type="html">çƒ­é‡è½½åŸç†ç ”ç©¶å’Œæ¢ç´¢</title><link href="http://localhost:4000/2020/06/07/00_flutter-hot-reload.html" rel="alternate" type="text/html" title="çƒ­é‡è½½åŸç†ç ”ç©¶å’Œæ¢ç´¢" /><published>2020-06-07T00:00:00+08:00</published><updated>2020-06-07T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/07/00_flutter-hot-reload</id><content type="html" xml:base="http://localhost:4000/2020/06/07/00_flutter-hot-reload.html">&lt;h2 id=&quot;çƒ­é‡è½½åŸç†ç ”ç©¶å’Œæ¢ç´¢&quot;&gt;çƒ­é‡è½½åŸç†ç ”ç©¶å’Œæ¢ç´¢&lt;/h2&gt;

&lt;h4 id=&quot;1-å‰è¨€&quot;&gt;1. å‰è¨€&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;Flutter äºšç§’çº§åˆ«çš„çƒ­é‡è½½æ˜¯å¼€å‘è€…çš„ç¥å…µåˆ©å™¨ï¼Œå®ƒèƒ½å¤Ÿæä¾›æˆ‘ä»¬å¿«é€Ÿä¿®æ”¹UIã€å¢åŠ åŠŸèƒ½ã€ä¿®å¤bugï¼Œä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå°±å¯ä»¥çœ‹åˆ°æ”¹åŠ¨æ•ˆæœã€‚é‚£ä¹ˆFlutteræ˜¯å¦‚ä½•åšåˆ°è¿™æ ·çš„åŠŸèƒ½çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¢ç©¶ä¸€ä¸‹å…¶ä¸­çš„åŸç†ã€‚&lt;/p&gt;

&lt;h4 id=&quot;2-é¦–å…ˆéœ€è¦çŸ¥é“jit-å’Œaot&quot;&gt;2. é¦–å…ˆéœ€è¦çŸ¥é“JIT å’ŒAOT&lt;/h4&gt;

&lt;hr /&gt;

&lt;h5 id=&quot;jit&quot;&gt;JIT&lt;/h5&gt;

&lt;p&gt;JITï¼ˆJust In Timeï¼‰ï¼ŒæŒ‡çš„æ˜¯è¿è¡Œæ—¶ç¼–è¯‘ï¼ŒFlutter åœ¨debugæ¨¡å¼ä¸‹é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€ä¸‹å‘å’Œæ‰§è¡Œä»£ç ï¼Œå¯åŠ¨é€Ÿåº¦å¿«ï¼Œä½†æ˜¯ç”±äºåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œæ€§èƒ½ä¼šå—å½±å“ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://pic2.zhimg.com/80/v2-5ac75ecfd558061556120bad41866ddd_1440w.jpg&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;aot&quot;&gt;AOT&lt;/h5&gt;

&lt;p&gt;AOTï¼ˆAhead Of Timeï¼‰ï¼ŒæŒ‡çš„æ˜¯åœ¨è¿è¡Œä¹‹å‰è¿›è¡Œç¼–è¯‘ï¼ŒFlutter åœ¨Releaseæ¨¡å¼ä¸‹é‡‡ç”¨ï¼Œå¯ä»¥ä¸ºç‰¹å®šçš„å¹³å°ç”Ÿæˆç¨³å®šçš„äºŒè¿›åˆ¶ä»£ç ã€æ‰§è¡Œæ€§èƒ½å¥½ã€è¿è¡Œé€Ÿåº¦å¿«ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦é‡æ–°è¿è¡Œç¼–è¯‘ï¼Œå¼€å‘æ•ˆç‡ä½ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://pic4.zhimg.com/80/v2-494be33d7893b43cc45146974b49f0c7_1440w.jpg&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼ŒFlutteræä¾›çš„ä¸¤ç§ç¼–è¯‘æ¨¡å¼ä¸­ï¼ŒAOT æ˜¯é™æ€ç¼–è¯‘ï¼Œç¼–è¯‘æˆè®¾å¤‡ç›´æ¥å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç ï¼›è€ŒJIT åˆ™æ˜¯å…ˆç”Ÿæˆä¸­é—´ä»£ç ï¼ˆScript snapshotï¼‰ï¼Œç„¶åé€šè¿‡dart Vm è§£é‡Šæ‰§è¡Œã€‚&lt;/p&gt;

&lt;h4 id=&quot;3-hot-reload-åŸç†&quot;&gt;3. Hot Reload åŸç†&lt;/h4&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;æ‰«æä¿®æ”¹çš„æ–‡ä»¶ï¼›&lt;/li&gt;
  &lt;li&gt;ç”Ÿæˆkernal fileï¼ˆapp.dill.incremental.dillï¼‰ï¼›&lt;/li&gt;
  &lt;li&gt;å°†æ–‡ä»¶é€šè¿‡Httpåè®®ä¸‹å‘åˆ°dartVMï¼›&lt;/li&gt;
  &lt;li&gt;VMæœåŠ¡é€šè¿‡RPC è°ƒç”¨_reloadSourcesï¼Œè¿›è¡Œèµ„æºé‡è½½ï¼›&lt;/li&gt;
  &lt;li&gt;VM èµ„æºåŠ è½½æˆåŠŸï¼Œå°†FlutterDevice UIçº¿ç¨‹é‡ç½®ï¼ˆuiIsolateï¼‰ï¼Œé€šè¿‡RPCè°ƒç”¨ï¼Œè§¦å‘Flutteræ ‘çš„é‡å»ºã€é‡ç»˜ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚ä¸‹å›¾å½¢è±¡è¯´æ˜ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.yuque.com/api/filetransfer/images?url=http%3A%2F%2Fgw.alicdn.com%2Fmt%2FTB1Qe3hisfpK1RjSZFOXXa6nFXa-895-477.png&amp;amp;sign=e8bfac5a86b2ca4bce992c9cdd10c865d27516def919ce6fb7afee3f7cb41bd4&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;4-æºç åˆ†æ&quot;&gt;4. æºç åˆ†æ&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;â€‹	é€šè¿‡å‘½ä»¤è¡Œè¾“å…¥ræˆ–è€…è§¦å‘é—ªç”µæŒ‰é’®ï¼Œå…¶å®ä¼šè§¦å‘flutter_toolsçš„run_hotæ–‡ä»¶çš„HotRunnerçš„restart() æ–¹æ³•ï¼ˆä½äºflutter/pakages/flutter_tools/ï¼‰ï¼›&lt;/p&gt;

&lt;p&gt;â€‹	flutter_tools è°ƒè¯•æ­¥éª¤ï¼š&lt;/p&gt;

&lt;p&gt;â€‹	1ï¼‰ç”¨ASæ‰“å¼€Flutter_toolsï¼Œæ‰“å¼€ Run/Debug Configurations;	&lt;img src=&quot;/Users/ddreader/Library/Application Support/typora-user-images/image-20200706151828238.png&quot; alt=&quot;image-20200706151828238&quot; /&gt;&lt;/p&gt;

&lt;p&gt;â€‹	2) æ·»åŠ Dart Command Line Appï¼Œ Name è®¾ç½®ä¸ºFlutter Tools Debuggerï¼Œ Dart file è®¾ç½®ä¸ºflutter_toolsçš„æ–‡ä»¶ç›®å½•ï¼ŒWorking directory è®¾ç½®ä¸ºä¸€ä¸ªæµ‹è¯•é¡¹ç›®è·¯å¾„&lt;/p&gt;

&lt;p&gt;â€‹	3) è¿è¡ŒDebugï¼Œè¿è¡Œå®Œæˆåï¼Œæ–­ç‚¹æ‰“åœ¨HotRunner çš„restartï¼ˆï¼‰æ–¹æ³•å¤„ã€‚&lt;/p&gt;

&lt;p&gt;â€‹	4ï¼‰éšä¾¿ä¿®æ”¹æµ‹è¯•é¡¹ç›®çš„Widgetï¼Œåœ¨flutter_tools å·¥ç¨‹çš„Consoleè¾“å…¥rå›è½¦ï¼›å‘ç°æ–­ç‚¹æ–­åœ¨äº†restartæ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬ä»restartï¼ˆï¼‰æ–¹æ³•å¼€å§‹é€æ­¥åˆ†æï¼Œçƒ­é‡è½½çš„åŸç†ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;restartï¼ˆï¼‰æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-dart highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@override&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;restart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fullRestart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseAfterRestart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;benchmarkMode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// åˆ¤æ–­å½“å‰çš„è®¾å¤‡ï¼Œå¹¶ä¸”è·å–å½“å‰è®¾å¤‡çš„targetPlatformã€sdkNameã€emulator&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Device&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNameForTargetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sdkNameAndVersion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isLocalEmulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'multiple'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'multiple'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'unknown'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'unknown'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()..&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fullRestart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    	&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;å®Œå…¨é‡æ–°å¯åŠ¨ã€éçƒ­é‡è½½éƒ¨åˆ†çœç•¥&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_hotReloadHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;pauseAfterRestart:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseAfterRestart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elapsed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getElapsedAsMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${result.message}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$elapsed&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;â€‹	è°ƒç”¨åˆ°restartæ–¹æ³•ä¹‹åï¼Œä¼šè·å–å½“å‰è®¾å¤‡çš„ä¸€äº›ä¿¡æ¯ï¼Œç„¶åæ ¹æ®æ˜¯å¦æ˜¯fullRestartæ‰§è¡Œä¸åŒæµç¨‹ï¼Œæˆ‘ä»¬ç ”ç©¶çš„æ˜¯Hot reloadä¸æ˜¯fullRestartæ‰€ä»¥æˆ‘ä»¬èµ°çš„æ˜¯ä¸‹è¾¹çš„æµç¨‹ï¼Œæ‰§è¡Œ_hotReloadHelperï¼ˆï¼‰ï¼›&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;_hotReloadHelper&lt;/p&gt;

    &lt;div class=&quot;language-dart highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_hotReloadHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseAfterRestart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadOnTopOfSnapshot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_runningFromSnapshot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progressPrefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadOnTopOfSnapshot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Initializing'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Performing'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Status&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;startProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$progressPrefix&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; hot reload...'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;timeout:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeoutConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fastOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;progressId:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'hot.reload'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_reloadSources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;pause:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseAfterRestart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;onSlow:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;cancel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;startProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;timeout:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeoutConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;slowOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;progressId:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'hot.reload'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rpc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RpcException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;HotEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'exception'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;fullRestart:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'hot reload failed to complete'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;fatal:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;cancel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;è¿™ä¸ªæ–¹æ³•å‘¢ï¼Œå…¶å®ä¹Ÿæ˜¯å¯¹äºæ ¸å¿ƒé€»è¾‘æ–¹æ³•_reloadSourcesï¼ˆï¼‰æ–¹æ³•çš„å°è£…ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;_reloadSources()&lt;/p&gt;

    &lt;div class=&quot;language-dart highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_reloadSources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pause&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onSlow&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// éå†æ‰€æœ‰Deviceçš„FlutterView, å¹¶ä¸”uiIsolate ä¸å­˜åœ¨çš„è¯ï¼Œæ‰§è¡Œå¤±è´¥&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Application isolate not found'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;fatal:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shouldReportReloadTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_runningFromSnapshot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// å¼€å¯è®¡æ—¶å™¨&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()..&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// åˆ¤æ–­FlutterViewçš„uiIsolateæ˜¯å¦ä¸ºnullæˆ–è€…å¤„äºæš‚åœçŠ¶æ€ï¼Œå¦‚æœæ˜¯åˆ·æ–°æ‰€æœ‰view&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_isPaused&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Refreshing active FlutterViews before reloading.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// è§¦å‘æ‰€æœ‰è®¾å¤‡çš„vmService RPC å‘é€_flutter.listViewsæ¶ˆæ¯&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;refreshViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devFSTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()..&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
   	&lt;span class=&quot;c1&quot;&gt;// åŒæ­¥ä¿®æ”¹çš„æ–‡ä»¶&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UpdateFSReport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;updatedDevFS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_updateDevFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Record time it took to synchronize to DevFS.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_addBenchmarkData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hotReloadDevFSSyncMilliseconds'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devFSTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;inMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;updatedDevFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'DevFS synchronization failed'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vmReloadTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()..&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entryPath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;getReloadPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;fullRestart:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;from:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;projectRootPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allReportsFutures&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;[];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_runningFromSnapshot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// Asset directory has to be set only once when we switch from&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// running from snapshot to running from uploaded files.&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;resetAssetDirectory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;completer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;allReportsFutures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// è§¦å‘RPC è°ƒç”¨_reloadSources é‡æ–°åŠ è½½èµ„æº&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportFutures&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;reloadSources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;entryPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;pause:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pause&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// å¤„ç†RPC è°ƒç”¨_reloadSources è¿”å›ç»“æœ&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;unawaited&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reportFutures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// TODO(aam): Investigate why we are validating only first reload report,&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// which seems to be current behavior&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReport&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// Don't print errors because they will be printed further down when&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// `validateReloadReport` is called again.&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;updateReloadStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;validateReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;firstReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;printErrors:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allReportsFutures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceReloadReport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;report&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadReport&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;report&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;reports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validateReloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// Reload failed.&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;HotEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'reload-reject'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;fullRestart:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Reload rejected'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Collect stats only from the first device. If/when run -d all is&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// refactored, we'll probably need to send one hot reload/restart event&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// per device to analytics.&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'details'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loadedLibraryCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'details'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'loadedLibraryCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;finalLibraryCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'details'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'finalLibraryCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'reloaded &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$loadedLibraryCount&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; of &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$finalLibraryCount&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; libraries'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reloadMessage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Reloaded &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$loadedLibraryCount&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; of &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$finalLibraryCount&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; libraries'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Hot reload failed: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$error&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$stackTrace&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errorCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'code'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errorMessage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'message'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errorCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Isolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kIsolateReloadBarred&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;errorMessage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Unable to hot reload application due to an unrecoverable error in '&lt;/span&gt;
                       &lt;span class=&quot;s&quot;&gt;'the source code. Please address the error and then use &quot;R&quot; to '&lt;/span&gt;
                       &lt;span class=&quot;s&quot;&gt;'restart the app.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
                       &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$errorMessage&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; (error code: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$errorCode&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;)'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;HotEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'reload-barred'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nl&quot;&gt;fullRestart:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errorCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errorMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errorCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$errorMessage&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; (error code: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$errorCode&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;)'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Hot reload failed: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$error&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$stackTrace&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$error&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Record time it took for the VM to reload the sources.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_addBenchmarkData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hotReloadVMReloadMilliseconds'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vmReloadTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;inMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stopwatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()..&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Reload the isolate.&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allDevices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;[];&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// è§¦å‘æ‰€æœ‰çš„FlutterView çš„uiIsolate åˆ·æ–°&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Sending reload events to &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${device.device.name}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServiceObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;futuresViews&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServiceObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;[];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Sending reload event to &quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${view.uiIsolate.name}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;futuresViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceCompleter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Completer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;unawaited&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;futuresViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;whenComplete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;deviceCompleter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;refreshViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}));&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;allDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deviceCompleter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// We are now running from source.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_runningFromSnapshot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Check if any isolates are paused.&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;[];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
   	&lt;span class=&quot;c1&quot;&gt;// æ·»åŠ  ressembleViews&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flutterDevices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Check if the isolate is paused, and if so, don't reassemble. Ignore the&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// PostPauseEvent event - the client requesting the pause will resume the app.&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ServiceEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isPauseEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ServiceEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kPausePostRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;pausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// many kinds&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;onSlow&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;onSlow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${_describePausedIsolates(pausedIsolatesFound, serviceEventKind)}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;; interface might not update.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Skipping reassemble because all isolates are paused.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ok&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;//åˆ é™¤dirty èµ„æº&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Evicting dirty assets'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_evictDirtyAssets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isNotEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Reassembling application'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failedReassemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;[];&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// rpcè§¦å‘æ‰€æœ‰çš„FlutterView uiIsolate ressemble&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;flutterReassemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;failedReassemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;printError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Reassembling &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${view.uiIsolate.name}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; failed: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$error&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleFuture&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleFuture&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Duration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;seconds:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;onTimeout:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;shouldReportReloadTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// probably no point waiting, they're probably deadlocked and we've already warned.&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Check if any isolate is newly paused.&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'This is taking a long time; will now check for paused isolates.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postReloadPausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FlutterView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
          &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ServiceEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uiIsolate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isPauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;postReloadPausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pauseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;serviceEventKind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// many kinds&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Found &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$postReloadPausedIsolatesFound&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; newly paused isolate(s).'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;postReloadPausedIsolatesFound&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleFuture&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// must just be taking a long time... keep waiting!&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;shouldReportReloadTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;onSlow&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;onSlow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${_describePausedIsolates(postReloadPausedIsolatesFound, serviceEventKind)}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Record time it took for Flutter to reassemble the application.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_addBenchmarkData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hotReloadFlutterReassembleMilliseconds'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reassembleTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;inMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;reloadTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Duration&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadInMs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;inMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// Collect stats that help understand scale of update for this hot reload request.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// For example, [syncedLibraryCount]/[finalLibraryCount] indicates how&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// many libraries were affected by the hot reload request.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Relation of [invalidatedSourcesCount] to [syncedLibraryCount] should help&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// understand sync/transfer &quot;overhead&quot; of updating this number of source files.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HotEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'reload'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;targetPlatform:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetPlatform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;sdkName:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sdkName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;emulator:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emulator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;fullRestart:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;reason:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;overallTimeInMs:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadInMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;finalLibraryCount:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'finalLibraryCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;syncedLibraryCount:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'receivedLibraryCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;syncedClassesCount:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'receivedClassesCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;syncedProceduresCount:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstReloadDetails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'receivedProceduresCount'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;syncedBytes:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;updatedDevFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;syncedBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;invalidatedSourcesCount:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;updatedDevFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;invalidatedSourcesCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nl&quot;&gt;transferTimeInMs:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devFSTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elapsed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;inMilliseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shouldReportReloadTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Hot reload performed in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${getElapsedAsMilliseconds(reloadDuration)}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// Record complete time it took for the reload.&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_addBenchmarkData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hotReloadMillisecondsToFrame'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadInMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Only report timings if we reloaded a single view without any errors.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reassembleViews&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;failedReassemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shouldReportReloadTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;flutterUsage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendTiming&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hot'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'reload'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reloadDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;failedReassemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OperationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ok&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;reloadMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;â€‹	è¿™ä¸ªæ–¹æ³•ä¸»è¦å¹²äº† 5ä»¶äº‹æƒ…&lt;/p&gt;

&lt;p&gt;â€‹	1. æ‰«æä¿®æ”¹çš„æ–‡ä»¶ï¼Œç”Ÿæˆdillæ–‡ä»¶ï¼Œå¹¶ä¸”é€šè¿‡HttpæœåŠ¡ä¸‹å‘åˆ°è®¾å¤‡èµ„æºæ–‡ä»¶ï¼›&lt;/p&gt;

 	2. RPC è°ƒç”¨_reloadSources è§¦å‘VMé‡æ–°åŠ è½½ä¿®æ”¹åçš„æ–‡ä»¶
 	3. RPC è°ƒç”¨ flutter Viewçš„uiIsolate refreshView
 	4. åˆ é™¤dirtyæ–‡ä»¶
 	5. rpcè§¦å‘æ‰€æœ‰çš„FlutterView uiIsolate ressemble

&lt;h4 id=&quot;5-ä¸ä¼šå‘ç”Ÿhot-reloadçš„åœºæ™¯&quot;&gt;5. ä¸ä¼šå‘ç”ŸHot Reloadçš„åœºæ™¯&lt;/h4&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;åº”ç”¨è¢«æ€æ­»&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¼–è¯‘é”™è¯¯&lt;/p&gt;

    &lt;p&gt;å½“ä»£ç æ›´æ”¹å¯¼è‡´ç¼–è¯‘é”™è¯¯æ—¶ï¼Œçƒ­é‡è½½ä¼šç”Ÿæˆç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„é”™è¯¯æ¶ˆæ¯ï¼š&lt;/p&gt;

    &lt;div class=&quot;language-dart highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Hot&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reload&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;was&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;rejected:&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;warning:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unbalanced&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'{'&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opens&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;here&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Widget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BuildContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                                     &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;error:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unbalanced&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;')'&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€æ›´æ­£ä¸Šè¿°ä»£ç çš„é”™è¯¯ï¼Œå³å¯ä»¥ç»§ç»­ä½¿ç”¨çƒ­é‡è½½&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;CupertinoTabViewâ€™s builder&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;åœ¨ä¿®æ”¹äº†CupertinoTableView çš„builderå†…å®¹æ—¶ï¼ŒHot reload ä¸ä¼šç”Ÿæ•ˆ&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;æšä¸¾ç±»å‹æ”¹å˜æˆclass ç±»å‹&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;å½“ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæ”¹æˆä¸€ä¸ªç±»æ—¶ï¼ŒHot reload ä¸ä¼šç”Ÿæ•ˆ&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;å­—ä½“ä¿®æ”¹&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;æ³›å‹ä¿®æ”¹&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;ä¿®æ”¹å‰&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class A&amp;lt;T&amp;gt; {
  T i;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ä¿®æ”¹å&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class A&amp;lt;T, V&amp;gt; {
  T i;
  V v;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;Native code&lt;/p&gt;

        &lt;p&gt;æ›´æ”¹åŸç”Ÿä»£ç ï¼Œ hot reload ä¸ä¼šç”Ÿæ•ˆ&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;statelessWidget å’Œ statefulWidget çš„äº’æ”¹&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;é™æ€å˜é‡å’Œå…¨å±€å˜é‡çš„æ”¹å˜&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://flutter.cn/docs/development/tools/hot-reload&quot;&gt; Flutter Hot Reload doc &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzU4MDUxOTI5NA==&amp;amp;mid=2247483816&amp;amp;idx=1&amp;amp;sn=deedc011bc902511d0712de959bb8b06&amp;amp;scene=19#wechat_redirect&quot;&gt;æ·±å…¥ç†è§£flutterçš„ç¼–è¯‘åŸç†ä¸ä¼˜åŒ–&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.yuque.com/xytech/flutter/uhw8vw#tx8udt&quot;&gt;æ­ç§˜Flutter Hot Reloadï¼ˆåŸç†ç¯‡)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://xiaozhuanlan.com/topic/0845671932&quot;&gt;åº•å±‚åŸç† - Flutter Hot Reload è¯¦è§£&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tech.meituan.com/2018/08/09/waimai-flutter-practice.html&quot;&gt;ç¾å›¢-FlutteråŸç†ä¸å®è·µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://gityuan.com/2019/06/23/dart-vm/&quot;&gt;å¤´æ¡å¼€å‘æ”»åŸç‹®-æ·±å…¥ç†è§£Dartè™šæ‹Ÿæœºå¯åŠ¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://annatarhe.github.io/2019/01/31/introduction-to-dart-vm.html&quot;&gt;Dart VM ç®€ä»‹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ketao1989.github.io/2016/12/10/rpc-theory-in-action/&quot;&gt;æ·±å…¥æµ…å‡ºRPCåŸç†&lt;/a&gt;&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="Flutter" /><summary type="html">çƒ­é‡è½½åŸç†ç ”ç©¶å’Œæ¢ç´¢ 1. å‰è¨€ Flutter äºšç§’çº§åˆ«çš„çƒ­é‡è½½æ˜¯å¼€å‘è€…çš„ç¥å…µåˆ©å™¨ï¼Œå®ƒèƒ½å¤Ÿæä¾›æˆ‘ä»¬å¿«é€Ÿä¿®æ”¹UIã€å¢åŠ åŠŸèƒ½ã€ä¿®å¤bugï¼Œä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå°±å¯ä»¥çœ‹åˆ°æ”¹åŠ¨æ•ˆæœã€‚é‚£ä¹ˆFlutteræ˜¯å¦‚ä½•åšåˆ°è¿™æ ·çš„åŠŸèƒ½çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¢ç©¶ä¸€ä¸‹å…¶ä¸­çš„åŸç†ã€‚ 2. é¦–å…ˆéœ€è¦çŸ¥é“JIT å’ŒAOT JIT JITï¼ˆJust In Timeï¼‰ï¼ŒæŒ‡çš„æ˜¯è¿è¡Œæ—¶ç¼–è¯‘ï¼ŒFlutter åœ¨debugæ¨¡å¼ä¸‹é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€ä¸‹å‘å’Œæ‰§è¡Œä»£ç ï¼Œå¯åŠ¨é€Ÿåº¦å¿«ï¼Œä½†æ˜¯ç”±äºåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œæ€§èƒ½ä¼šå—å½±å“ã€‚ AOT AOTï¼ˆAhead Of Timeï¼‰ï¼ŒæŒ‡çš„æ˜¯åœ¨è¿è¡Œä¹‹å‰è¿›è¡Œç¼–è¯‘ï¼ŒFlutter åœ¨Releaseæ¨¡å¼ä¸‹é‡‡ç”¨ï¼Œå¯ä»¥ä¸ºç‰¹å®šçš„å¹³å°ç”Ÿæˆç¨³å®šçš„äºŒè¿›åˆ¶ä»£ç ã€æ‰§è¡Œæ€§èƒ½å¥½ã€è¿è¡Œé€Ÿåº¦å¿«ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦é‡æ–°è¿è¡Œç¼–è¯‘ï¼Œå¼€å‘æ•ˆç‡ä½ã€‚ æ‰€ä»¥ï¼ŒFlutteræä¾›çš„ä¸¤ç§ç¼–è¯‘æ¨¡å¼ä¸­ï¼ŒAOT æ˜¯é™æ€ç¼–è¯‘ï¼Œç¼–è¯‘æˆè®¾å¤‡ç›´æ¥å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç ï¼›è€ŒJIT åˆ™æ˜¯å…ˆç”Ÿæˆä¸­é—´ä»£ç ï¼ˆScript snapshotï¼‰ï¼Œç„¶åé€šè¿‡dart Vm è§£é‡Šæ‰§è¡Œã€‚ 3. Hot Reload åŸç† æ‰«æä¿®æ”¹çš„æ–‡ä»¶ï¼› ç”Ÿæˆkernal fileï¼ˆapp.dill.incremental.dillï¼‰ï¼› å°†æ–‡ä»¶é€šè¿‡Httpåè®®ä¸‹å‘åˆ°dartVMï¼› VMæœåŠ¡é€šè¿‡RPC è°ƒç”¨_reloadSourcesï¼Œè¿›è¡Œèµ„æºé‡è½½ï¼› VM èµ„æºåŠ è½½æˆåŠŸï¼Œå°†FlutterDevice UIçº¿ç¨‹é‡ç½®ï¼ˆuiIsolateï¼‰ï¼Œé€šè¿‡RPCè°ƒç”¨ï¼Œè§¦å‘Flutteræ ‘çš„é‡å»ºã€é‡ç»˜ã€‚ å¦‚ä¸‹å›¾å½¢è±¡è¯´æ˜ï¼š 4. æºç åˆ†æ â€‹ é€šè¿‡å‘½ä»¤è¡Œè¾“å…¥ræˆ–è€…è§¦å‘é—ªç”µæŒ‰é’®ï¼Œå…¶å®ä¼šè§¦å‘flutter_toolsçš„run_hotæ–‡ä»¶çš„HotRunnerçš„restart() æ–¹æ³•ï¼ˆä½äºflutter/pakages/flutter_tools/ï¼‰ï¼› â€‹ flutter_tools è°ƒè¯•æ­¥éª¤ï¼š â€‹ 1ï¼‰ç”¨ASæ‰“å¼€Flutter_toolsï¼Œæ‰“å¼€ Run/Debug Configurations; â€‹ 2) æ·»åŠ Dart Command Line Appï¼Œ Name è®¾ç½®ä¸ºFlutter Tools Debuggerï¼Œ Dart file è®¾ç½®ä¸ºflutter_toolsçš„æ–‡ä»¶ç›®å½•ï¼ŒWorking directory è®¾ç½®ä¸ºä¸€ä¸ªæµ‹è¯•é¡¹ç›®è·¯å¾„ â€‹ 3) è¿è¡ŒDebugï¼Œè¿è¡Œå®Œæˆåï¼Œæ–­ç‚¹æ‰“åœ¨HotRunner çš„restartï¼ˆï¼‰æ–¹æ³•å¤„ã€‚ â€‹ 4ï¼‰éšä¾¿ä¿®æ”¹æµ‹è¯•é¡¹ç›®çš„Widgetï¼Œåœ¨flutter_tools å·¥ç¨‹çš„Consoleè¾“å…¥rå›è½¦ï¼›å‘ç°æ–­ç‚¹æ–­åœ¨äº†restartæ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬ä»restartï¼ˆï¼‰æ–¹æ³•å¼€å§‹é€æ­¥åˆ†æï¼Œçƒ­é‡è½½çš„åŸç†ã€‚ restartï¼ˆï¼‰æ–¹æ³• @override Future&amp;lt;OperationResult&amp;gt; restart({ bool fullRestart = false, bool pauseAfterRestart = false, String reason, bool benchmarkMode = false }) async { String targetPlatform; String sdkName; bool emulator; // åˆ¤æ–­å½“å‰çš„è®¾å¤‡ï¼Œå¹¶ä¸”è·å–å½“å‰è®¾å¤‡çš„targetPlatformã€sdkNameã€emulator if (flutterDevices.length == 1) { final Device device = flutterDevices.first.device; targetPlatform = getNameForTargetPlatform(await device.targetPlatform); sdkName = await device.sdkNameAndVersion; emulator = await device.isLocalEmulator; } else if (flutterDevices.length &amp;gt; 1) { targetPlatform = 'multiple'; sdkName = 'multiple'; emulator = false; } else { targetPlatform = 'unknown'; sdkName = 'unknown'; emulator = false; } final Stopwatch timer = Stopwatch()..start(); if (fullRestart) { ... å®Œå…¨é‡æ–°å¯åŠ¨ã€éçƒ­é‡è½½éƒ¨åˆ†çœç•¥ return; } final OperationResult result = await _hotReloadHelper( targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, reason: reason, pauseAfterRestart: pauseAfterRestart, ); if (result.isOk) { final String elapsed = getElapsedAsMilliseconds(timer.elapsed); printStatus('${result.message} in $elapsed.'); } return result; } â€‹ è°ƒç”¨åˆ°restartæ–¹æ³•ä¹‹åï¼Œä¼šè·å–å½“å‰è®¾å¤‡çš„ä¸€äº›ä¿¡æ¯ï¼Œç„¶åæ ¹æ®æ˜¯å¦æ˜¯fullRestartæ‰§è¡Œä¸åŒæµç¨‹ï¼Œæˆ‘ä»¬ç ”ç©¶çš„æ˜¯Hot reloadä¸æ˜¯fullRestartæ‰€ä»¥æˆ‘ä»¬èµ°çš„æ˜¯ä¸‹è¾¹çš„æµç¨‹ï¼Œæ‰§è¡Œ_hotReloadHelperï¼ˆï¼‰ï¼› _hotReloadHelper Future&amp;lt;OperationResult&amp;gt; _hotReloadHelper({ String targetPlatform, String sdkName, bool emulator, String reason, bool pauseAfterRestart = false, }) async { final bool reloadOnTopOfSnapshot = _runningFromSnapshot; final String progressPrefix = reloadOnTopOfSnapshot ? 'Initializing' : 'Performing'; Status status = logger.startProgress( '$progressPrefix hot reload...', timeout: timeoutConfiguration.fastOperation, progressId: 'hot.reload', ); OperationResult result; try { result = await _reloadSources( targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, pause: pauseAfterRestart, reason: reason, onSlow: (String message) { status?.cancel(); status = logger.startProgress( message, timeout: timeoutConfiguration.slowOperation, progressId: 'hot.reload', ); }, ); } on rpc.RpcException { HotEvent('exception', targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, fullRestart: false, reason: reason).send(); return OperationResult(1, 'hot reload failed to complete', fatal: true); } finally { status.cancel(); } return result; } è¿™ä¸ªæ–¹æ³•å‘¢ï¼Œå…¶å®ä¹Ÿæ˜¯å¯¹äºæ ¸å¿ƒé€»è¾‘æ–¹æ³•_reloadSourcesï¼ˆï¼‰æ–¹æ³•çš„å°è£…ã€‚ _reloadSources() Future&amp;lt;OperationResult&amp;gt; _reloadSources({ String targetPlatform, String sdkName, bool emulator, bool pause = false, String reason, void Function(String message) onSlow }) async { // éå†æ‰€æœ‰Deviceçš„FlutterView, å¹¶ä¸”uiIsolate ä¸å­˜åœ¨çš„è¯ï¼Œæ‰§è¡Œå¤±è´¥ for (FlutterDevice device in flutterDevices) { for (FlutterView view in device.views) { if (view.uiIsolate == null) { return OperationResult(2, 'Application isolate not found', fatal: true); } } } bool shouldReportReloadTime = !_runningFromSnapshot; // å¼€å¯è®¡æ—¶å™¨ final Stopwatch reloadTimer = Stopwatch()..start(); // åˆ¤æ–­FlutterViewçš„uiIsolateæ˜¯å¦ä¸ºnullæˆ–è€…å¤„äºæš‚åœçŠ¶æ€ï¼Œå¦‚æœæ˜¯åˆ·æ–°æ‰€æœ‰view if (!_isPaused()) { printTrace('Refreshing active FlutterViews before reloading.'); // è§¦å‘æ‰€æœ‰è®¾å¤‡çš„vmService RPC å‘é€_flutter.listViewsæ¶ˆæ¯ await refreshViews(); } final Stopwatch devFSTimer = Stopwatch()..start(); // åŒæ­¥ä¿®æ”¹çš„æ–‡ä»¶ final UpdateFSReport updatedDevFS = await _updateDevFS(); // Record time it took to synchronize to DevFS. _addBenchmarkData('hotReloadDevFSSyncMilliseconds', devFSTimer.elapsed.inMilliseconds); if (!updatedDevFS.success) { return OperationResult(1, 'DevFS synchronization failed'); } String reloadMessage; final Stopwatch vmReloadTimer = Stopwatch()..start(); Map&amp;lt;String, dynamic&amp;gt; firstReloadDetails; try { final String entryPath = fs.path.relative( getReloadPath(fullRestart: false), from: projectRootPath, ); final List&amp;lt;Future&amp;lt;DeviceReloadReport&amp;gt;&amp;gt; allReportsFutures = &amp;lt;Future&amp;lt;DeviceReloadReport&amp;gt;&amp;gt;[]; for (FlutterDevice device in flutterDevices) { if (_runningFromSnapshot) { // Asset directory has to be set only once when we switch from // running from snapshot to running from uploaded files. await device.resetAssetDirectory(); } final Completer&amp;lt;DeviceReloadReport&amp;gt; completer = Completer&amp;lt;DeviceReloadReport&amp;gt;(); allReportsFutures.add(completer.future); // è§¦å‘RPC è°ƒç”¨_reloadSources é‡æ–°åŠ è½½èµ„æº final List&amp;lt;Future&amp;lt;Map&amp;lt;String, dynamic&amp;gt;&amp;gt;&amp;gt; reportFutures = device.reloadSources( entryPath, pause: pause, ); // å¤„ç†RPC è°ƒç”¨_reloadSources è¿”å›ç»“æœ unawaited(Future.wait(reportFutures).then( (List&amp;lt;Map&amp;lt;String, dynamic&amp;gt;&amp;gt; reports) async { // TODO(aam): Investigate why we are validating only first reload report, // which seems to be current behavior final Map&amp;lt;String, dynamic&amp;gt; firstReport = reports.first; // Don't print errors because they will be printed further down when // `validateReloadReport` is called again. await device.updateReloadStatus( validateReloadReport(firstReport, printErrors: false), ); completer.complete(DeviceReloadReport(device, reports)); }, )); } final List&amp;lt;DeviceReloadReport&amp;gt; reports = await Future.wait(allReportsFutures); for (DeviceReloadReport report in reports) { final Map&amp;lt;String, dynamic&amp;gt; reloadReport = report.reports[0]; if (!validateReloadReport(reloadReport)) { // Reload failed. HotEvent('reload-reject', targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, fullRestart: false, reason: reason, ).send(); return OperationResult(1, 'Reload rejected'); } // Collect stats only from the first device. If/when run -d all is // refactored, we'll probably need to send one hot reload/restart event // per device to analytics. firstReloadDetails ??= reloadReport['details']; final int loadedLibraryCount = reloadReport['details']['loadedLibraryCount']; final int finalLibraryCount = reloadReport['details']['finalLibraryCount']; printTrace('reloaded $loadedLibraryCount of $finalLibraryCount libraries'); reloadMessage = 'Reloaded $loadedLibraryCount of $finalLibraryCount libraries'; } } on Map&amp;lt;String, dynamic&amp;gt; catch (error, stackTrace) { printTrace('Hot reload failed: $error\n$stackTrace'); final int errorCode = error['code']; String errorMessage = error['message']; if (errorCode == Isolate.kIsolateReloadBarred) { errorMessage = 'Unable to hot reload application due to an unrecoverable error in ' 'the source code. Please address the error and then use &quot;R&quot; to ' 'restart the app.\n' '$errorMessage (error code: $errorCode)'; HotEvent('reload-barred', targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, fullRestart: false, reason: reason, ).send(); return OperationResult(errorCode, errorMessage); } return OperationResult(errorCode, '$errorMessage (error code: $errorCode)'); } catch (error, stackTrace) { printTrace('Hot reload failed: $error\n$stackTrace'); return OperationResult(1, '$error'); } // Record time it took for the VM to reload the sources. _addBenchmarkData('hotReloadVMReloadMilliseconds', vmReloadTimer.elapsed.inMilliseconds); final Stopwatch reassembleTimer = Stopwatch()..start(); // Reload the isolate. final List&amp;lt;Future&amp;lt;void&amp;gt;&amp;gt; allDevices = &amp;lt;Future&amp;lt;void&amp;gt;&amp;gt;[]; // è§¦å‘æ‰€æœ‰çš„FlutterView çš„uiIsolate åˆ·æ–° for (FlutterDevice device in flutterDevices) { printTrace('Sending reload events to ${device.device.name}'); final List&amp;lt;Future&amp;lt;ServiceObject&amp;gt;&amp;gt; futuresViews = &amp;lt;Future&amp;lt;ServiceObject&amp;gt;&amp;gt;[]; for (FlutterView view in device.views) { printTrace('Sending reload event to &quot;${view.uiIsolate.name}&quot;'); futuresViews.add(view.uiIsolate.reload()); } final Completer&amp;lt;void&amp;gt; deviceCompleter = Completer&amp;lt;void&amp;gt;(); unawaited(Future.wait(futuresViews).whenComplete(() { deviceCompleter.complete(device.refreshViews()); })); allDevices.add(deviceCompleter.future); } await Future.wait(allDevices); // We are now running from source. _runningFromSnapshot = false; // Check if any isolates are paused. final List&amp;lt;FlutterView&amp;gt; reassembleViews = &amp;lt;FlutterView&amp;gt;[]; String serviceEventKind; int pausedIsolatesFound = 0; // æ·»åŠ  ressembleViews for (FlutterDevice device in flutterDevices) { for (FlutterView view in device.views) { // Check if the isolate is paused, and if so, don't reassemble. Ignore the // PostPauseEvent event - the client requesting the pause will resume the app. final ServiceEvent pauseEvent = view.uiIsolate.pauseEvent; if (pauseEvent != null &amp;amp;&amp;amp; pauseEvent.isPauseEvent &amp;amp;&amp;amp; pauseEvent.kind != ServiceEvent.kPausePostRequest) { pausedIsolatesFound += 1; if (serviceEventKind == null) { serviceEventKind = pauseEvent.kind; } else if (serviceEventKind != pauseEvent.kind) { serviceEventKind = ''; // many kinds } } else { reassembleViews.add(view); } } } if (pausedIsolatesFound &amp;gt; 0) { if (onSlow != null) onSlow('${_describePausedIsolates(pausedIsolatesFound, serviceEventKind)}; interface might not update.'); if (reassembleViews.isEmpty) { printTrace('Skipping reassemble because all isolates are paused.'); return OperationResult(OperationResult.ok.code, reloadMessage); } } //åˆ é™¤dirty èµ„æº printTrace('Evicting dirty assets'); await _evictDirtyAssets(); assert(reassembleViews.isNotEmpty); printTrace('Reassembling application'); bool failedReassemble = false; final List&amp;lt;Future&amp;lt;void&amp;gt;&amp;gt; futures = &amp;lt;Future&amp;lt;void&amp;gt;&amp;gt;[]; // rpcè§¦å‘æ‰€æœ‰çš„FlutterView uiIsolate ressemble for (FlutterView view in reassembleViews) { futures.add(() async { try { await view.uiIsolate.flutterReassemble(); } catch (error) { failedReassemble = true; printError('Reassembling ${view.uiIsolate.name} failed: $error'); return; } }()); } final Future&amp;lt;void&amp;gt; reassembleFuture = Future.wait&amp;lt;void&amp;gt;(futures).then&amp;lt;void&amp;gt;((List&amp;lt;void&amp;gt; values) { }); await reassembleFuture.timeout( const Duration(seconds: 2), onTimeout: () async { if (pausedIsolatesFound &amp;gt; 0) { shouldReportReloadTime = false; return; // probably no point waiting, they're probably deadlocked and we've already warned. } // Check if any isolate is newly paused. printTrace('This is taking a long time; will now check for paused isolates.'); int postReloadPausedIsolatesFound = 0; String serviceEventKind; for (FlutterView view in reassembleViews) { await view.uiIsolate.reload(); final ServiceEvent pauseEvent = view.uiIsolate.pauseEvent; if (pauseEvent != null &amp;amp;&amp;amp; pauseEvent.isPauseEvent) { postReloadPausedIsolatesFound += 1; if (serviceEventKind == null) { serviceEventKind = pauseEvent.kind; } else if (serviceEventKind != pauseEvent.kind) { serviceEventKind = ''; // many kinds } } } printTrace('Found $postReloadPausedIsolatesFound newly paused isolate(s).'); if (postReloadPausedIsolatesFound == 0) { await reassembleFuture; // must just be taking a long time... keep waiting! return; } shouldReportReloadTime = false; if (onSlow != null) onSlow('${_describePausedIsolates(postReloadPausedIsolatesFound, serviceEventKind)}.'); }, ); // Record time it took for Flutter to reassemble the application. _addBenchmarkData('hotReloadFlutterReassembleMilliseconds', reassembleTimer.elapsed.inMilliseconds); reloadTimer.stop(); final Duration reloadDuration = reloadTimer.elapsed; final int reloadInMs = reloadDuration.inMilliseconds; // Collect stats that help understand scale of update for this hot reload request. // For example, [syncedLibraryCount]/[finalLibraryCount] indicates how // many libraries were affected by the hot reload request. // Relation of [invalidatedSourcesCount] to [syncedLibraryCount] should help // understand sync/transfer &quot;overhead&quot; of updating this number of source files. HotEvent('reload', targetPlatform: targetPlatform, sdkName: sdkName, emulator: emulator, fullRestart: false, reason: reason, overallTimeInMs: reloadInMs, finalLibraryCount: firstReloadDetails['finalLibraryCount'], syncedLibraryCount: firstReloadDetails['receivedLibraryCount'], syncedClassesCount: firstReloadDetails['receivedClassesCount'], syncedProceduresCount: firstReloadDetails['receivedProceduresCount'], syncedBytes: updatedDevFS.syncedBytes, invalidatedSourcesCount: updatedDevFS.invalidatedSourcesCount, transferTimeInMs: devFSTimer.elapsed.inMilliseconds, ).send(); if (shouldReportReloadTime) { printTrace('Hot reload performed in ${getElapsedAsMilliseconds(reloadDuration)}.'); // Record complete time it took for the reload. _addBenchmarkData('hotReloadMillisecondsToFrame', reloadInMs); } // Only report timings if we reloaded a single view without any errors. if ((reassembleViews.length == 1) &amp;amp;&amp;amp; !failedReassemble &amp;amp;&amp;amp; shouldReportReloadTime) flutterUsage.sendTiming('hot', 'reload', reloadDuration); return OperationResult( failedReassemble ? 1 : OperationResult.ok.code, reloadMessage, ); } â€‹ è¿™ä¸ªæ–¹æ³•ä¸»è¦å¹²äº† 5ä»¶äº‹æƒ… â€‹ 1. æ‰«æä¿®æ”¹çš„æ–‡ä»¶ï¼Œç”Ÿæˆdillæ–‡ä»¶ï¼Œå¹¶ä¸”é€šè¿‡HttpæœåŠ¡ä¸‹å‘åˆ°è®¾å¤‡èµ„æºæ–‡ä»¶ï¼› 2. RPC è°ƒç”¨_reloadSources è§¦å‘VMé‡æ–°åŠ è½½ä¿®æ”¹åçš„æ–‡ä»¶ 3. RPC è°ƒç”¨ flutter Viewçš„uiIsolate refreshView 4. åˆ é™¤dirtyæ–‡ä»¶ 5. rpcè§¦å‘æ‰€æœ‰çš„FlutterView uiIsolate ressemble 5. ä¸ä¼šå‘ç”ŸHot Reloadçš„åœºæ™¯ åº”ç”¨è¢«æ€æ­» ç¼–è¯‘é”™è¯¯ å½“ä»£ç æ›´æ”¹å¯¼è‡´ç¼–è¯‘é”™è¯¯æ—¶ï¼Œçƒ­é‡è½½ä¼šç”Ÿæˆç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„é”™è¯¯æ¶ˆæ¯ï¼š Hot reload was rejected: '/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart': warning: line 16 pos 38: unbalanced '{' opens here Widget build(BuildContext context) { ^ '/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart': error: line 33 pos 5: unbalanced ')' ); åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€æ›´æ­£ä¸Šè¿°ä»£ç çš„é”™è¯¯ï¼Œå³å¯ä»¥ç»§ç»­ä½¿ç”¨çƒ­é‡è½½ CupertinoTabViewâ€™s builder åœ¨ä¿®æ”¹äº†CupertinoTableView çš„builderå†…å®¹æ—¶ï¼ŒHot reload ä¸ä¼šç”Ÿæ•ˆ æšä¸¾ç±»å‹æ”¹å˜æˆclass ç±»å‹ å½“ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæ”¹æˆä¸€ä¸ªç±»æ—¶ï¼ŒHot reload ä¸ä¼šç”Ÿæ•ˆ å­—ä½“ä¿®æ”¹ æ³›å‹ä¿®æ”¹ ä¿®æ”¹å‰ class A&amp;lt;T&amp;gt; { T i; } ä¿®æ”¹å class A&amp;lt;T, V&amp;gt; { T i; V v; } Native code æ›´æ”¹åŸç”Ÿä»£ç ï¼Œ hot reload ä¸ä¼šç”Ÿæ•ˆ statelessWidget å’Œ statefulWidget çš„äº’æ”¹ é™æ€å˜é‡å’Œå…¨å±€å˜é‡çš„æ”¹å˜ å‚è€ƒ Flutter Hot Reload doc æ·±å…¥ç†è§£flutterçš„ç¼–è¯‘åŸç†ä¸ä¼˜åŒ– æ­ç§˜Flutter Hot Reloadï¼ˆåŸç†ç¯‡) åº•å±‚åŸç† - Flutter Hot Reload è¯¦è§£ ç¾å›¢-FlutteråŸç†ä¸å®è·µ å¤´æ¡å¼€å‘æ”»åŸç‹®-æ·±å…¥ç†è§£Dartè™šæ‹Ÿæœºå¯åŠ¨ Dart VM ç®€ä»‹ æ·±å…¥æµ…å‡ºRPCåŸç†</summary></entry><entry><title type="html">Flutter Text æ–‡å­—ä¸‹æœ‰é»„è‰²ä¸‹åˆ’çº¿</title><link href="http://localhost:4000/2020/05/01/02_flutter_text_has_underline.html" rel="alternate" type="text/html" title="Flutter Text æ–‡å­—ä¸‹æœ‰é»„è‰²ä¸‹åˆ’çº¿" /><published>2020-05-01T00:00:00+08:00</published><updated>2020-05-01T00:00:00+08:00</updated><id>http://localhost:4000/2020/05/01/02_flutter_text_has_underline</id><content type="html" xml:base="http://localhost:4000/2020/05/01/02_flutter_text_has_underline.html">&lt;h3 id=&quot;å¯¼è‡´åŸå› &quot;&gt;å¯¼è‡´åŸå› &lt;/h3&gt;

&lt;p&gt;å¯¼è‡´è¿™ç§æƒ…å†µå‘ç”Ÿçš„åŸå› æ˜¯å› ä¸ºï¼ŒText widget éš¶å±äºMaterial é£æ ¼ä¸‹çš„ç»„ä»¶ï¼Œå¦‚æœæ ¹èŠ‚ç‚¹ä¸æ˜¯Material ç›¸å…³ç»„ä»¶ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤å¸¦é»„è‰²ä¸‹åˆ’çº¿çš„æ ¼å¼ã€‚å¦‚æœæ ¹èŠ‚ç‚¹æ˜¯Material å®¹å™¨ç»„ä»¶ï¼Œåˆ™ä¼šé‡‡ç”¨å…¶Materialé£æ ¼çš„æ ·å¼ï¼ˆå³ä¸å¸¦æœ‰ä¸‹æ¢çº¿ï¼‰ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è§£å†³æ–¹å¼&quot;&gt;è§£å†³æ–¹å¼&lt;/h3&gt;

&lt;h4 id=&quot;1-é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºè„šæ‰‹æ¶scaffoldç»„ä»¶&quot;&gt;1. é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºè„šæ‰‹æ¶Scaffoldç»„ä»¶&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Scaffold(body: content,);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;2--é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºmaterial-ç»„ä»¶&quot;&gt;2.  é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºMaterial ç»„ä»¶&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Material(child: content);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;3-é€ä¸ªä¿®æ”¹text-ç»„ä»¶çš„style-ä¸‹çš„decorationä¸ºtextdecorationnone&quot;&gt;3. é€ä¸ªä¿®æ”¹Text ç»„ä»¶çš„style ä¸‹çš„decorationä¸ºTextDecoration.none&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;child: Text(
                      &quot;ä¸“æ çš„æ–‡ç« &quot;,
                      overflow: TextOverflow.ellipsis,
                      style: TextStyle(
                        decoration: TextDecoration.none,
                        color: Color(0xFF888888),
                        fontSize: 14,
                        fontWeight: FontWeight.bold,
                        fontFamily: defaultFontFamily,
                      ),
                    )
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ç»“è¯­&quot;&gt;ç»“è¯­&lt;/h3&gt;

&lt;p&gt;è®°å½•å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œæ–¹ä¾¿å†æ¬¡é‡åˆ°å¿«é€Ÿè§£å†³ã€‚&lt;/p&gt;</content><author><name>harry</name><email>harry_c2016@163.com</email></author><category term="Flutter" /><summary type="html">å¯¼è‡´åŸå›  å¯¼è‡´è¿™ç§æƒ…å†µå‘ç”Ÿçš„åŸå› æ˜¯å› ä¸ºï¼ŒText widget éš¶å±äºMaterial é£æ ¼ä¸‹çš„ç»„ä»¶ï¼Œå¦‚æœæ ¹èŠ‚ç‚¹ä¸æ˜¯Material ç›¸å…³ç»„ä»¶ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤å¸¦é»„è‰²ä¸‹åˆ’çº¿çš„æ ¼å¼ã€‚å¦‚æœæ ¹èŠ‚ç‚¹æ˜¯Material å®¹å™¨ç»„ä»¶ï¼Œåˆ™ä¼šé‡‡ç”¨å…¶Materialé£æ ¼çš„æ ·å¼ï¼ˆå³ä¸å¸¦æœ‰ä¸‹æ¢çº¿ï¼‰ã€‚ è§£å†³æ–¹å¼ 1. é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºè„šæ‰‹æ¶Scaffoldç»„ä»¶ Scaffold(body: content,); 2. é‡‡ç”¨æ ¹èŠ‚ç‚¹ä¸ºMaterial ç»„ä»¶ Material(child: content); 3. é€ä¸ªä¿®æ”¹Text ç»„ä»¶çš„style ä¸‹çš„decorationä¸ºTextDecoration.none child: Text( &quot;ä¸“æ çš„æ–‡ç« &quot;, overflow: TextOverflow.ellipsis, style: TextStyle( decoration: TextDecoration.none, color: Color(0xFF888888), fontSize: 14, fontWeight: FontWeight.bold, fontFamily: defaultFontFamily, ), ) ç»“è¯­ è®°å½•å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œæ–¹ä¾¿å†æ¬¡é‡åˆ°å¿«é€Ÿè§£å†³ã€‚</summary></entry></feed>